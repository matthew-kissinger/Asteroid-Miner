{"version":3,"file":"stargateInterface-oDq5uNE_.js","sources":["../../js/modules/ui/components/stargate/terminal/display/screen.ts","../../js/modules/ui/components/stargate/terminal/display/effects.ts","../../js/modules/ui/components/stargate/terminal/commands/parser.ts","../../js/modules/ui/components/stargate/terminal/commands/handlers.ts","../../js/modules/ui/components/stargate/terminal/content/messages.ts","../../js/modules/ui/components/stargate/terminal/input/keyboard.ts","../../js/modules/ui/components/stargate/terminalView.ts","../../js/modules/ui/components/stargate/systemsView.ts","../../js/modules/ui/components/stargate/tradingView.ts","../../js/modules/ui/components/stargate/upgrades.ts","../../js/modules/ui/components/stargate/missions.ts","../../js/modules/ui/components/stargate/eventHandlers.ts","../../js/modules/ui/components/stargate/helpers.ts","../../js/modules/ui/stargateInterface.ts"],"sourcesContent":["// screen.ts - Terminal display rendering and DOM management\n\nexport class TerminalScreen {\n    private isMobile: boolean;\n\n    constructor() {\n        this.isMobile = false;\n    }\n    \n    setMobile(isMobile: boolean): void {\n        this.isMobile = isMobile;\n    }\n    \n    createDockingPrompt(): HTMLElement {\n        const dockingPrompt = document.createElement('div');\n        dockingPrompt.id = 'docking-prompt';\n        dockingPrompt.style.position = 'absolute';\n        dockingPrompt.style.top = '50%';\n        dockingPrompt.style.left = '50%';\n        dockingPrompt.style.transform = 'translate(-50%, -50%)';\n        dockingPrompt.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';\n        dockingPrompt.style.color = '#33aaff';\n        dockingPrompt.style.padding = '20px';\n        dockingPrompt.style.borderRadius = '10px';\n        dockingPrompt.style.border = '2px solid #33aaff';\n        dockingPrompt.style.boxShadow = '0 0 20px #33aaff';\n        dockingPrompt.style.fontFamily = 'Courier New, monospace';\n        dockingPrompt.style.fontSize = '18px';\n        dockingPrompt.style.textAlign = 'center';\n        dockingPrompt.style.zIndex = '1000';\n        dockingPrompt.style.display = 'none';\n        \n        if (this.isMobile) {\n            dockingPrompt.style.display = 'none';\n            dockingPrompt.dataset.alwaysHide = 'true';\n        } else {\n            dockingPrompt.textContent = 'Press Q to dock with Stargate';\n        }\n        \n        document.body.appendChild(dockingPrompt);\n        return dockingPrompt;\n    }\n    \n    createMainUI(): HTMLElement {\n        const stargateUI = document.createElement('div');\n        stargateUI.id = 'stargate-ui';\n        \n        if (this.isMobile) {\n            stargateUI.style.width = '95%';\n            stargateUI.style.maxWidth = '95vw';\n            (stargateUI.style as any).webkitOverflowScrolling = 'touch';\n            stargateUI.style.touchAction = 'pan-y';\n            stargateUI.style.overscrollBehavior = 'contain';\n        }\n        \n        return stargateUI;\n    }\n    \n    showDockingPrompt(): void {\n        const dockingPrompt = document.getElementById('docking-prompt');\n        if (dockingPrompt && dockingPrompt.dataset.alwaysHide !== 'true') {\n            dockingPrompt.style.display = 'block';\n        }\n    }\n    \n    hideDockingPrompt(): void {\n        const dockingPrompt = document.getElementById('docking-prompt');\n        if (dockingPrompt) {\n            dockingPrompt.style.display = 'none';\n        }\n    }\n    \n    updateResourceDisplay(resource: string, value: string | number): void {\n        const element = document.getElementById(`ms-${resource}`);\n        if (element) {\n            element.textContent = String(value);\n        }\n    }\n    \n    updateStatusBar(barId: string, percentage: number): void {\n        const bar = document.getElementById(barId);\n        if (bar) {\n            bar.style.width = `${percentage}%`;\n        }\n    }\n    \n    updateCredits(credits: number): void {\n        const element = document.getElementById('ms-credits');\n        if (element) {\n            element.textContent = `${credits} CR`;\n        }\n    }\n    \n    updateOrbCount(rarity: string, count: number): void {\n        const element = document.getElementById(`orb-${rarity}-count`);\n        if (element) {\n            element.textContent = `${count} in inventory`;\n        }\n    }\n    \n    updateUpgradeLevel(upgradeType: string, level: number): void {\n        const element = document.getElementById(`current-${upgradeType}-level`);\n        if (element) {\n            element.textContent = String(level);\n        }\n    }\n    \n    updateUpgradeProgress(upgradeType: string, percentage: number): void {\n        const progressBar = document.getElementById(`${upgradeType}-upgrade-progress`);\n        if (progressBar) {\n            progressBar.style.width = `${percentage}%`;\n        }\n    }\n    \n    updateUpgradeCost(upgradeType: string, cost: number): void {\n        const element = document.getElementById(`${upgradeType}-upgrade-cost`);\n        if (element) {\n            element.textContent = String(cost);\n        }\n    }\n    \n    showUI(): void {\n        const ui = document.getElementById('stargate-ui');\n        if (ui) {\n            ui.style.display = 'block';\n        }\n    }\n    \n    hideUI(): void {\n        const ui = document.getElementById('stargate-ui');\n        if (ui) {\n            ui.style.display = 'none';\n        }\n    }\n}\n","// effects.ts - CRT effects, glitch animations, and visual styling\n\nexport class TerminalEffects {\n    private stylesInjected: boolean;\n\n    constructor() {\n        this.stylesInjected = false;\n    }\n    \n    createStyles(): void {\n        if (this.stylesInjected) return;\n        \n        const style = document.createElement('style');\n        style.textContent = `\n            @keyframes pulse-warning {\n                0% { box-shadow: 0 0 15px rgba(255, 48, 48, 0.5); }\n                50% { box-shadow: 0 0 25px rgba(255, 48, 48, 0.8); }\n                100% { box-shadow: 0 0 15px rgba(255, 48, 48, 0.5); }\n            }\n            \n            @keyframes pulse-glow {\n                0%, 100% { opacity: 0.5; }\n                50% { opacity: 1; }\n            }\n            \n            /* Stargate Terminal Base Styles */\n            #stargate-ui {\n                --primary-bg: rgba(20, 30, 50, 0.9);\n                --primary-border: #33aaff;\n                --section-bg: rgba(10, 20, 35, 0.8);\n                --accent-blue: #33aaff;\n                --accent-green: #00cc33;\n                --accent-orange: #ff9900;\n                --accent-red: #ff3030;\n                --accent-purple: #9933cc;\n                --accent-cyan: #30cfd0;\n                \n                position: absolute;\n                top: 50%;\n                left: 50%;\n                transform: translate(-50%, -50%);\n                width: 80%;\n                max-width: 1000px;\n                max-height: 90vh;\n                background-color: var(--primary-bg);\n                color: #fff;\n                border-radius: 15px;\n                border: 2px solid var(--primary-border);\n                box-shadow: 0 0 30px var(--primary-border);\n                font-family: 'Courier New', monospace;\n                z-index: 1000;\n                display: none;\n                overflow-y: auto;\n                overflow-x: hidden;\n                padding: 0;\n            }\n            \n            /* Layout and Structure Styles */\n            #stargate-header {\n                background-color: rgba(30, 40, 60, 0.9);\n                padding: 15px 20px;\n                border-bottom: 1px solid var(--primary-border);\n                position: sticky;\n                top: 0;\n                z-index: 10;\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n            }\n            \n            #stargate-content {\n                display: grid;\n                grid-template-columns: 1fr 1fr 1fr;\n                gap: 20px;\n                padding: 20px;\n            }\n            \n            .stargate-section {\n                background-color: var(--section-bg);\n                border-radius: 10px;\n                padding: 15px;\n                border: 1px solid rgba(51, 170, 255, 0.3);\n            }\n            \n            .stargate-section h3 {\n                color: var(--accent-blue);\n                margin-top: 0;\n                margin-bottom: 15px;\n                padding-bottom: 8px;\n                border-bottom: 1px solid rgba(51, 170, 255, 0.3);\n                font-size: 1.2em;\n            }\n            \n            ${this.getComponentStyles()}\n            \n            /* Resource Border Effects */\n            .iron-border { \n                border: 1px solid #cc6633; \n                box-shadow: 0 0 10px rgba(204, 102, 51, 0.3); \n            }\n            .gold-border { \n                border: 1px solid #ffcc33; \n                box-shadow: 0 0 10px rgba(255, 204, 51, 0.3); \n            }\n            .platinum-border { \n                border: 1px solid #33ccff; \n                box-shadow: 0 0 10px rgba(51, 204, 255, 0.3); \n            }\n            .common-border { \n                border: 1px solid #00ff66; \n                box-shadow: 0 0 10px rgba(0, 255, 102, 0.3); \n            }\n            .uncommon-border { \n                border: 1px solid #0066ff; \n                box-shadow: 0 0 10px rgba(0, 102, 255, 0.3); \n            }\n            .rare-border { \n                border: 1px solid #9900ff; \n                box-shadow: 0 0 10px rgba(153, 0, 255, 0.3); \n            }\n            .epic-border { \n                border: 1px solid #ff6600; \n                box-shadow: 0 0 10px rgba(255, 102, 0, 0.3); \n            }\n            .legendary-border { \n                border: 1px solid #ff0000; \n                box-shadow: 0 0 10px rgba(255, 0, 0, 0.3); \n            }\n            \n            /* Undock Button Glow Effects */\n            .btn-undock {\n                background: linear-gradient(135deg, #00a8ff 0%, #0066cc 100%);\n                font-size: 1.4em;\n                font-weight: bold;\n                letter-spacing: 3px;\n                padding: 16px 40px;\n                width: auto;\n                min-width: 200px;\n                margin-bottom: 15px;\n                border: 2px solid #00d4ff;\n                box-shadow: 0 0 20px rgba(0, 212, 255, 0.5), inset 0 0 20px rgba(0, 168, 255, 0.2);\n                text-transform: uppercase;\n                position: relative;\n                overflow: hidden;\n                transition: all 0.3s ease;\n            }\n            \n            .btn-undock:hover {\n                background: linear-gradient(135deg, #00d4ff 0%, #0088ff 100%);\n                box-shadow: 0 0 30px rgba(0, 212, 255, 0.8), inset 0 0 20px rgba(0, 212, 255, 0.3);\n                transform: translateY(-2px);\n            }\n            \n            .btn-undock:active {\n                transform: translateY(0);\n            }\n            \n            .btn-undock::before {\n                content: '';\n                position: absolute;\n                top: -2px;\n                left: -2px;\n                right: -2px;\n                bottom: -2px;\n                background: linear-gradient(45deg, transparent, #00d4ff, transparent);\n                z-index: -1;\n                opacity: 0;\n                transition: opacity 0.3s;\n                animation: pulse-glow 2s infinite;\n            }\n            \n            .btn-undock:hover::before {\n                opacity: 1;\n            }\n            \n            /* Horde Button Warning Effects */\n            .btn-horde { \n                background: linear-gradient(135deg, #990000 0%, var(--accent-red) 100%);\n                color: #fff;\n                border: 2px solid var(--accent-red);\n                box-shadow: 0 0 15px rgba(255, 48, 48, 0.5);\n                animation: pulse-warning 2s infinite;\n            }\n        `;\n        document.head.appendChild(style);\n        this.stylesInjected = true;\n    }\n    \n    applyGlowEffect(element: HTMLElement | null, color = '#33aaff', intensity = 0.5): void {\n        if (!element) return;\n        \n        element.style.boxShadow = `0 0 20px rgba(${this.hexToRgb(color)}, ${intensity})`;\n    }\n    \n    removeGlowEffect(element: HTMLElement | null): void {\n        if (!element) return;\n        \n        element.style.boxShadow = '';\n    }\n    \n    hexToRgb(hex: string): string {\n        const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        return result ? \n            `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` : \n            '255, 255, 255';\n    }\n    \n    addPulseAnimation(element: HTMLElement | null, color = '#ff3030'): void {\n        if (!element) return;\n        \n        element.style.animation = 'pulse-warning 2s infinite';\n        element.style.boxShadow = `0 0 15px rgba(${this.hexToRgb(color)}, 0.5)`;\n    }\n    \n    removePulseAnimation(element: HTMLElement | null): void {\n        if (!element) return;\n        \n        element.style.animation = '';\n        element.style.boxShadow = '';\n    }\n    \n    addBorderGlow(element: HTMLElement | null, type: string): void {\n        if (!element) return;\n        \n        const glowClasses = [\n            'iron-border', 'gold-border', 'platinum-border',\n            'common-border', 'uncommon-border', 'rare-border',\n            'epic-border', 'legendary-border'\n        ];\n        \n        // Remove existing glow classes\n        element.classList.remove(...glowClasses);\n        \n        // Add new glow class\n        if (type && glowClasses.includes(`${type}-border`)) {\n            element.classList.add(`${type}-border`);\n        }\n    }\n    \n    getComponentStyles(): string {\n        return `\n            /* Ship Status Section */\n            #ship-status-section {\n                grid-column: 1;\n                display: flex;\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .resources-container {\n                display: flex;\n                gap: 5px;\n                margin-bottom: 10px;\n            }\n            \n            .resource-display {\n                flex: 1;\n                padding: 8px;\n                background-color: rgba(15, 40, 55, 0.8);\n                border-radius: 5px;\n                text-align: center;\n            }\n            \n            .status-bar-container {\n                width: 100%;\n                height: 15px;\n                background-color: #222;\n                border-radius: 10px;\n                overflow: hidden;\n                margin-bottom: 5px;\n            }\n            \n            .status-bar {\n                height: 100%;\n                border-radius: 10px;\n            }\n            \n            .status-label {\n                display: flex;\n                justify-content: space-between;\n                margin-bottom: 5px;\n                font-size: 0.9em;\n            }\n            \n            /* Market Section */\n            #market-section {\n                grid-column: 2;\n                grid-row: 1;\n            }\n            \n            .sell-buttons {\n                display: grid;\n                grid-template-columns: 1fr 1fr 1fr;\n                gap: 5px;\n                margin-bottom: 15px;\n            }\n            \n            .sell-btn {\n                padding: 10px;\n                background-color: rgba(15, 40, 55, 0.8);\n                color: #fff;\n                border-radius: 5px;\n                cursor: pointer;\n                text-align: center;\n                transition: all 0.2s;\n                border: none;\n                font-family: 'Courier New', monospace;\n            }\n            \n            .orb-buttons {\n                display: grid;\n                grid-template-columns: 1fr 1fr;\n                gap: 8px;\n            }\n            \n            /* Upgrades Section */\n            #upgrades-section {\n                grid-column: 3;\n                grid-row: 1;\n            }\n            \n            .upgrade-item {\n                margin-bottom: 15px;\n                border: 1px solid rgba(85, 85, 85, 0.5);\n                border-radius: 8px;\n                padding: 12px;\n                background-color: rgba(0, 0, 0, 0.3);\n            }\n            \n            .upgrade-header {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                margin-bottom: 10px;\n            }\n            \n            .upgrade-progress {\n                position: relative;\n                height: 8px;\n                background-color: #333;\n                border-radius: 4px;\n                margin-bottom: 12px;\n            }\n            \n            .upgrade-progress-bar {\n                position: absolute;\n                top: 0;\n                left: 0;\n                height: 100%;\n                width: 20%;\n                border-radius: 4px;\n            }\n            \n            .upgrade-footer {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n            }\n            \n            .upgrade-description {\n                flex: 2;\n                padding-right: 10px;\n                font-size: 0.85em;\n                opacity: 0.8;\n            }\n            \n            /* Features Section */\n            #features-section {\n                grid-column: 1 / span 2;\n                grid-row: 2;\n            }\n            \n            .feature-buttons {\n                display: grid;\n                grid-template-columns: 1fr 1fr;\n                gap: 15px;\n            }\n            \n            .feature-btn {\n                padding: 15px;\n                border: none;\n                border-radius: 5px;\n                cursor: pointer;\n                font-family: 'Courier New', monospace;\n                font-weight: bold;\n                font-size: 16px;\n                color: #fff;\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                justify-content: center;\n                min-height: 80px;\n            }\n            \n            .feature-btn small {\n                font-size: 0.8em;\n                opacity: 0.8;\n                margin-top: 5px;\n            }\n            \n            /* Challenge Section */\n            #challenge-section {\n                border-color: rgba(255, 48, 48, 0.5);\n            }\n            \n            #challenge-section h3 {\n                color: var(--accent-red);\n                border-color: rgba(255, 48, 48, 0.3);\n            }\n            \n            /* Common Button Styles */\n            .action-btn {\n                width: 100%;\n                padding: 10px;\n                border: none;\n                border-radius: 5px;\n                cursor: pointer;\n                font-family: 'Courier New', monospace;\n                font-weight: bold;\n                color: #000;\n                margin-top: 5px;\n            }\n            \n            /* Button color variations */\n            .btn-fuel { background-color: var(--accent-green); }\n            .btn-shield { background-color: var(--accent-blue); }\n            .btn-hull { background-color: var(--accent-orange); }\n            .btn-starmap { background-color: var(--accent-cyan); }\n            .btn-blackjack { background-color: var(--accent-purple); }\n            .btn-settings { background-color: var(--accent-blue); }\n            \n            /* Mobile Responsiveness */\n            @media (max-width: 900px) {\n                #stargate-ui {\n                    width: 95%;\n                    max-width: 95vw;\n                    max-height: 85vh;\n                    border-radius: 10px;\n                }\n                \n                #stargate-content {\n                    grid-template-columns: 1fr;\n                    gap: 15px;\n                    padding: 15px;\n                }\n                \n                #ship-status-section,\n                #market-section,\n                #upgrades-section,\n                #features-section {\n                    grid-column: 1;\n                }\n                \n                .feature-buttons {\n                    grid-template-columns: 1fr;\n                }\n                \n                .sell-buttons {\n                    grid-template-columns: 1fr 1fr;\n                }\n                \n                .action-btn {\n                    padding: 12px;\n                    min-height: 44px;\n                }\n            }\n        `;\n    }\n}\n","// parser.ts - Command parsing logic for terminal interface\n\ninterface ParsedCommand {\n    command: string;\n    args: string[];\n    original: string;\n    raw: string;\n}\n\nexport class CommandParser {\n    private commandHistory: string[];\n    private historyIndex: number;\n    private aliases: Map<string, string>;\n\n    constructor() {\n        this.commandHistory = [];\n        this.historyIndex = -1;\n        this.aliases = new Map();\n        this.setupAliases();\n    }\n    \n    setupAliases(): void {\n        // Common command aliases\n        this.aliases.set('ls', 'list');\n        this.aliases.set('dir', 'list');\n        this.aliases.set('h', 'help');\n        this.aliases.set('?', 'help');\n        this.aliases.set('q', 'quit');\n        this.aliases.set('exit', 'quit');\n        this.aliases.set('cls', 'clear');\n        this.aliases.set('clr', 'clear');\n        this.aliases.set('buy', 'purchase');\n        this.aliases.set('sell', 'market');\n        this.aliases.set('upgrade', 'enhance');\n        this.aliases.set('status', 'info');\n        this.aliases.set('stat', 'info');\n    }\n    \n    parseCommand(input: string): ParsedCommand {\n        if (!input || typeof input !== 'string') {\n            return { command: '', args: [], original: '', raw: '' };\n        }\n        \n        const trimmed = input.trim();\n        if (!trimmed) {\n            return { command: '', args: [], original: input, raw: '' };\n        }\n        \n        // Add to history if it's a new command\n        if (this.commandHistory[this.commandHistory.length - 1] !== trimmed) {\n            this.commandHistory.push(trimmed);\n            // Limit history to 50 commands\n            if (this.commandHistory.length > 50) {\n                this.commandHistory.shift();\n            }\n        }\n        this.historyIndex = this.commandHistory.length;\n        \n        // Parse command and arguments\n        const parts = this.tokenize(trimmed);\n        const rawCommand = parts[0]?.toLowerCase() || '';\n        const command = this.resolveAlias(rawCommand);\n        const args = parts.slice(1);\n        \n        return {\n            command,\n            args,\n            original: trimmed,\n            raw: rawCommand\n        };\n    }\n    \n    tokenize(input: string): string[] {\n        const tokens: string[] = [];\n        let current = '';\n        let inQuotes = false;\n        let quoteChar = '';\n        \n        for (let i = 0; i < input.length; i++) {\n            const char = input[i];\n            \n            if ((char === '\"' || char === \"'\") && !inQuotes) {\n                inQuotes = true;\n                quoteChar = char;\n            } else if (char === quoteChar && inQuotes) {\n                inQuotes = false;\n                quoteChar = '';\n            } else if (char === ' ' && !inQuotes) {\n                if (current) {\n                    tokens.push(current);\n                    current = '';\n                }\n            } else {\n                current += char;\n            }\n        }\n        \n        if (current) {\n            tokens.push(current);\n        }\n        \n        return tokens;\n    }\n    \n    resolveAlias(command: string): string {\n        return this.aliases.get(command) || command;\n    }\n    \n    getCommandHistory(): string[] {\n        return [...this.commandHistory];\n    }\n    \n    getPreviousCommand(): string | null {\n        if (this.historyIndex > 0) {\n            this.historyIndex--;\n            return this.commandHistory[this.historyIndex];\n        }\n        return null;\n    }\n    \n    getNextCommand(): string | null {\n        if (this.historyIndex < this.commandHistory.length - 1) {\n            this.historyIndex++;\n            return this.commandHistory[this.historyIndex];\n        } else if (this.historyIndex === this.commandHistory.length - 1) {\n            this.historyIndex++;\n            return '';\n        }\n        return null;\n    }\n    \n    validateCommand(command: string): boolean {\n        const validCommands = [\n            'help', 'list', 'clear', 'quit', 'info', 'status',\n            'purchase', 'market', 'enhance', 'upgrade', 'refuel',\n            'repair', 'undock', 'dock', 'scan', 'navigate',\n            'starmap', 'blackjack', 'settings', 'horde'\n        ];\n        \n        return validCommands.includes(command);\n    }\n    \n    getCommandSuggestions(partial: string): string[] {\n        const validCommands = [\n            'help', 'list', 'clear', 'quit', 'info',\n            'purchase', 'market', 'enhance', 'refuel',\n            'repair', 'undock', 'dock', 'scan', 'navigate',\n            'starmap', 'blackjack', 'settings', 'horde'\n        ];\n        \n        return validCommands.filter(cmd => \n            cmd.startsWith(partial.toLowerCase())\n        );\n    }\n}\n","// handlers.ts - Command execution and action handling\n\ninterface ParsedCommand {\n    command: string;\n    args: string[];\n    original: string;\n    raw: string;\n}\n\ninterface CommandResult {\n    success: boolean;\n    message?: string;\n    clearScreen?: boolean;\n    action?: string;\n    target?: string;\n}\n\ninterface TerminalView {\n    hide(): void;\n}\n\nexport class CommandHandlers {\n    private stargate: TerminalView;\n    private lastCommandTime: number;\n    private commandCooldown: number;\n\n    constructor(stargateInterface: TerminalView) {\n        this.stargate = stargateInterface;\n        this.lastCommandTime = 0;\n        this.commandCooldown = 100; // ms between commands\n    }\n    \n    async executeCommand(parsedCommand: ParsedCommand): Promise<CommandResult> {\n        const now = Date.now();\n        if (now - this.lastCommandTime < this.commandCooldown) {\n            return { success: false, message: 'Command rate limit exceeded' };\n        }\n        this.lastCommandTime = now;\n        \n        const { command, args } = parsedCommand;\n        \n        try {\n            switch (command) {\n                case 'help':\n                    return this.handleHelp(args);\n                case 'list':\n                    return this.handleList();\n                case 'clear':\n                    return this.handleClear();\n                case 'quit':\n                case 'undock':\n                    return this.handleUndock();\n                case 'info':\n                    return this.handleInfo(args);\n                case 'purchase':\n                    return this.handlePurchase(args);\n                case 'market':\n                    return this.handleMarket(args);\n                case 'enhance':\n                    return this.handleEnhance(args);\n                case 'refuel':\n                    return this.handleRefuel();\n                case 'repair':\n                    return this.handleRepair(args);\n                case 'scan':\n                    return this.handleScan();\n                case 'starmap':\n                    return this.handleStarmap();\n                case 'blackjack':\n                    return this.handleBlackjack();\n                case 'settings':\n                    return this.handleSettings();\n                case 'horde':\n                    return this.handleHorde();\n                default:\n                    return { \n                        success: false, \n                        message: `Unknown command: ${command}. Type 'help' for available commands.` \n                    };\n            }\n        } catch (error) {\n            console.error('Command execution error:', error);\n            return { \n                success: false, \n                message: 'Command execution failed. Please try again.' \n            };\n        }\n    }\n    \n    handleHelp(args: string[]): CommandResult {\n        const helpTopics: Record<string, string> = {\n            general: `Available Commands:\n• help [topic] - Show this help or specific topic help\n• list - Show available services and features  \n• info [system] - Display ship or system information\n• market [item] - Access trading interface\n• purchase <item> - Buy upgrades or services\n• enhance <system> - Upgrade ship systems\n• refuel - Refill fuel tanks\n• repair [system] - Repair ship systems\n• scan - Perform system scan\n• starmap - Open navigation interface\n• blackjack - Access gaming interface\n• settings - Configure terminal preferences\n• undock - Leave stargate terminal\n• clear - Clear terminal display`,\n            \n            market: `Market Commands:\n• market - Show all available items\n• market resources - Show resource prices\n• market orbs - Show energy orb values\n• purchase fuel - Refuel ship (100 CR)\n• purchase shield - Repair shields (150 CR)\n• purchase hull - Repair hull (200 CR)`,\n            \n            upgrade: `Upgrade Commands:\n• enhance fuel - Upgrade fuel tank capacity\n• enhance engine - Improve ship speed\n• enhance mining - Increase mining efficiency\n• enhance hull - Strengthen ship structure\n• enhance scanner - Extend detection range`\n        };\n        \n        const topic = args[0] || 'general';\n        const helpText = helpTopics[topic] || helpTopics.general;\n        \n        return { success: true, message: helpText };\n    }\n    \n    handleList(): CommandResult {\n        return {\n            success: true,\n            message: `STARGATE SERVICES:\n• Ship Maintenance & Repair\n• Resource Trading Market\n• Ship System Upgrades\n• Navigation & Mapping\n• Entertainment (Stellar Blackjack)\n• System Configuration\n• Challenge Modes\n\nType 'help [service]' for detailed information.`\n        };\n    }\n    \n    handleClear(): CommandResult {\n        return { success: true, message: '', clearScreen: true };\n    }\n    \n    handleUndock(): CommandResult {\n        if (this.stargate && typeof (this.stargate as any).hide === 'function') {\n            this.stargate.hide();\n        }\n        return { \n            success: true, \n            message: 'Undocking from stargate terminal...',\n            action: 'undock'\n        };\n    }\n    \n    handleInfo(args: string[]): CommandResult {\n        const system = args[0] || 'ship';\n        \n        // This would integrate with actual game state\n        return {\n            success: true,\n            message: `${system.toUpperCase()} STATUS:\nSystem information would be displayed here.\nUse the GUI panels for detailed status.`\n        };\n    }\n    \n    handlePurchase(args: string[]): CommandResult {\n        const item = args[0];\n        if (!item) {\n            return { \n                success: false, \n                message: 'Please specify an item to purchase. Use \"market\" to see available items.' \n            };\n        }\n        \n        return {\n            success: true,\n            message: `Attempting to purchase ${item}...`,\n            action: 'purchase',\n            target: item\n        };\n    }\n    \n    handleMarket(args: string[]): CommandResult {\n        const category = args[0] || 'all';\n        \n        return {\n            success: true,\n            message: `MARKET INTERFACE - ${category.toUpperCase()}\nUse the market panel for transactions.\nType 'help market' for command-line trading.`\n        };\n    }\n    \n    handleEnhance(args: string[]): CommandResult {\n        const system = args[0];\n        if (!system) {\n            return { \n                success: false, \n                message: 'Please specify a system to enhance. Use \"info\" to see available systems.' \n            };\n        }\n        \n        return {\n            success: true,\n            message: `Initiating ${system} enhancement...`,\n            action: 'enhance',\n            target: system\n        };\n    }\n    \n    handleRefuel(): CommandResult {\n        return {\n            success: true,\n            message: 'Initiating refueling sequence...',\n            action: 'refuel'\n        };\n    }\n    \n    handleRepair(args: string[]): CommandResult {\n        const system = args[0] || 'all';\n        \n        return {\n            success: true,\n            message: `Initiating ${system} repair sequence...`,\n            action: 'repair',\n            target: system\n        };\n    }\n    \n    handleScan(): CommandResult {\n        return {\n            success: true,\n            message: 'Performing system scan...\\nScan results would appear here.'\n        };\n    }\n    \n    handleStarmap(): CommandResult {\n        return {\n            success: true,\n            message: 'Opening stellar cartography interface...',\n            action: 'starmap'\n        };\n    }\n    \n    handleBlackjack(): CommandResult {\n        return {\n            success: true,\n            message: 'Accessing gaming interface...',\n            action: 'blackjack'\n        };\n    }\n    \n    handleSettings(): CommandResult {\n        return {\n            success: true,\n            message: 'Opening configuration interface...',\n            action: 'settings'\n        };\n    }\n    \n    handleHorde(): CommandResult {\n        return {\n            success: true,\n            message: 'WARNING: Prepare for extreme challenge mode...',\n            action: 'horde'\n        };\n    }\n}\n","// messages.ts - Terminal text content and UI templates\n\nexport class TerminalMessages {\n    private welcomeMessages: string[];\n\n    constructor() {\n        this.welcomeMessages = [\n            'STARGATE TERMINAL ONLINE',\n            'QUANTUM LINK ESTABLISHED',\n            'NEURAL INTERFACE ACTIVE',\n            'SYSTEM READY FOR COMMANDS'\n        ];\n    }\n    \n    getMainUIContent(): string {\n        return `\n            <!-- Header -->\n            <div id=\"stargate-header\">\n                <button id=\"undock-btn\" class=\"action-btn btn-undock\" data-no-touch-overlay=\"true\">\n                    <span class=\"undock-text\">◆ UNDOCK ◆</span>\n                </button>\n                <h2 style=\"text-align: center; color: #33aaff; margin: 0;\">STARGATE TERMINAL</h2>\n            </div>\n            \n            <!-- Main Content Grid -->\n            <div id=\"stargate-content\">\n                <!-- Ship Status Section -->\n                <div id=\"ship-status-section\" class=\"stargate-section\">\n                    <h3>SHIP STATUS</h3>\n                    ${this.getShipStatusContent()}\n                </div>\n                \n                <!-- Market Section -->\n                <div id=\"market-section\" class=\"stargate-section\">\n                    <h3>MARKET</h3>\n                    ${this.getMarketContent()}\n                </div>\n                \n                <!-- Upgrades Section -->\n                <div id=\"upgrades-section\" class=\"stargate-section\">\n                    <h3>SHIP UPGRADES</h3>\n                    ${this.getUpgradesContent()}\n                </div>\n                \n                <!-- Features Section -->\n                <div id=\"features-section\" class=\"stargate-section\">\n                    <h3>SERVICES</h3>\n                    ${this.getFeaturesContent()}\n                </div>\n                \n                <!-- Challenge Section -->\n                <div id=\"challenge-section\" class=\"stargate-section\">\n                    <h3>EXTREME CHALLENGE</h3>\n                    ${this.getChallengeContent()}\n                </div>\n            </div>\n            \n            <!-- Footer -->\n            <div id=\"stargate-footer\">\n                <!-- Footer now empty, undock button moved to header -->\n            </div>\n        `;\n    }\n    \n    getShipStatusContent(): string {\n        return `\n            <!-- Resources section -->\n            <div>\n                <h4 style=\"color: #33aaff; margin-top: 0; margin-bottom: 10px;\">RESOURCES</h4>\n                <div class=\"resources-container\">\n                    <div class=\"resource-display iron-border\">\n                        <div style=\"font-weight: bold; font-size: 14px;\">IRON</div>\n                        <div id=\"ms-iron\" style=\"font-size: 18px; margin-top: 5px;\">0</div>\n                        <div style=\"font-size: 10px; opacity: 0.7;\">UNITS</div>\n                    </div>\n                    <div class=\"resource-display gold-border\">\n                        <div style=\"font-weight: bold; font-size: 14px;\">GOLD</div>\n                        <div id=\"ms-gold\" style=\"font-size: 18px; margin-top: 5px;\">0</div>\n                        <div style=\"font-size: 10px; opacity: 0.7;\">UNITS</div>\n                    </div>\n                    <div class=\"resource-display platinum-border\">\n                        <div style=\"font-weight: bold; font-size: 14px;\">PLATINUM</div>\n                        <div id=\"ms-platinum\" style=\"font-size: 18px; margin-top: 5px;\">0</div>\n                        <div style=\"font-size: 10px; opacity: 0.7;\">UNITS</div>\n                    </div>\n                </div>\n                \n                <div style=\"margin-top: 15px;\">\n                    <h4 style=\"color: #33aaff; margin-top: 0; margin-bottom: 10px;\">CREDITS</h4>\n                    <div id=\"ms-credits\" style=\"font-size: 18px; font-weight: bold; color: #ffcc33; text-shadow: 0 0 5px rgba(255, 204, 51, 0.5);\">0 CR</div>\n                </div>\n            </div>\n            \n            <!-- Fuel section -->\n            <div>\n                <div class=\"status-label\">\n                    <h4 style=\"color: #00cc33; margin: 0;\">FUEL</h4>\n                    <span><span id=\"fuel-level\">100</span>%</span>\n                </div>\n                <div class=\"status-bar-container\" id=\"fuel-gauge-container\">\n                    <div class=\"status-bar\" id=\"fuel-gauge\" style=\"background-color: #00cc33; width: 100%;\"></div>\n                </div>\n                <button id=\"refuel-btn\" class=\"action-btn btn-fuel\">REFUEL (100 CR)</button>\n            </div>\n            \n            <!-- Shield section -->\n            <div>\n                <div class=\"status-label\">\n                    <h4 style=\"color: #3399ff; margin: 0;\">SHIELD</h4>\n                    <span><span id=\"shield-level\">100</span>%</span>\n                </div>\n                <div class=\"status-bar-container\" id=\"shield-gauge-container\">\n                    <div class=\"status-bar\" id=\"shield-gauge\" style=\"background-color: #3399ff; width: 100%;\"></div>\n                </div>\n                <button id=\"repair-shield-btn\" class=\"action-btn btn-shield\">REPAIR SHIELD (150 CR)</button>\n            </div>\n            \n            <!-- Hull section -->\n            <div>\n                <div class=\"status-label\">\n                    <h4 style=\"color: #ff9900; margin: 0;\">HULL INTEGRITY</h4>\n                    <span><span id=\"hull-level\">100</span>%</span>\n                </div>\n                <div class=\"status-bar-container\" id=\"hull-gauge-container\">\n                    <div class=\"status-bar\" id=\"hull-gauge\" style=\"background-color: #ff9900; width: 100%;\"></div>\n                </div>\n                <button id=\"repair-hull-btn\" class=\"action-btn btn-hull\">REPAIR HULL (200 CR)</button>\n            </div>\n        `;\n    }\n    \n    getMarketContent(): string {\n        return `\n            <!-- Resources Market -->\n            <h4 style=\"color: #33aaff; margin-top: 0; margin-bottom: 10px;\">MATERIALS</h4>\n            <div class=\"sell-buttons\">\n                <button id=\"sell-iron\" class=\"sell-btn iron-border\">\n                    <div style=\"font-weight: bold;\">SELL IRON</div>\n                    <div style=\"font-size: 12px; margin-top: 3px;\">(10 CR each)</div>\n                </button>\n                <button id=\"sell-gold\" class=\"sell-btn gold-border\">\n                    <div style=\"font-weight: bold;\">SELL GOLD</div>\n                    <div style=\"font-size: 12px; margin-top: 3px;\">(50 CR each)</div>\n                </button>\n                <button id=\"sell-platinum\" class=\"sell-btn platinum-border\">\n                    <div style=\"font-weight: bold;\">SELL PLATINUM</div>\n                    <div style=\"font-size: 12px; margin-top: 3px;\">(200 CR each)</div>\n                </button>\n            </div>\n            \n            <!-- Energy Orbs Market -->\n            <h4 style=\"color: #33aaff; margin-top: 20px; margin-bottom: 10px;\">ENERGY ORBS</h4>\n            <div style=\"font-size: 14px; color: #aaa; margin-bottom: 10px;\">\n                Valuable artifacts collected from space anomalies. Increasing rarity yields higher value.\n            </div>\n            \n            <div class=\"orb-buttons\">\n                ${this.getOrbButtons()}\n            </div>\n            \n            <!-- Deployable Weapons Section -->\n            <h4 style=\"color: #33aaff; margin-top: 20px; margin-bottom: 10px;\">DEPLOYABLE WEAPONS</h4>\n            <div class=\"upgrade-item\">\n                <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;\">\n                    <div>\n                        <strong style=\"color: #FF3333;\">Laser Turrets:</strong> <span id=\"current-laser-count\">0</span>\n                    </div>\n                </div>\n                <div style=\"display: flex; justify-content: space-between; align-items: center;\">\n                    <div style=\"flex: 2; padding-right: 10px;\">\n                        <p style=\"margin: 0; font-size: 12px;\">Deployable laser turrets automatically target and fire at enemies within 1000m range.</p>\n                    </div>\n                    <button id=\"purchase-laser\" style=\"flex: 1; padding: 10px; background-color: #FF3333; color: #fff; border: none; border-radius: 5px; cursor: pointer; font-family: 'Courier New', monospace; font-weight: bold;\">\n                        PURCHASE (1000 CR)\n                    </button>\n                </div>\n            </div>\n        `;\n    }\n    \n    getOrbButtons(): string {\n        const orbs = [\n            { type: 'common', price: 100 },\n            { type: 'uncommon', price: 500 },\n            { type: 'rare', price: 1500 },\n            { type: 'epic', price: 5000 },\n            { type: 'legendary', price: 15000 }\n        ];\n        \n        return orbs.map(orb => `\n            <button id=\"sell-orb-${orb.type}\" class=\"sell-btn ${orb.type}-border\">\n                <div style=\"font-weight: bold;\">${orb.type.toUpperCase()} ORB</div>\n                <div id=\"orb-${orb.type}-count\" style=\"font-size: 12px;\">0 in inventory</div>\n                <div style=\"font-size: 12px; margin-top: 3px;\">(${orb.price.toLocaleString()} CR each)</div>\n            </button>\n        `).join('');\n    }\n    \n    getUpgradesContent(): string {\n        const upgrades = [\n            { type: 'fuel', name: 'Fuel Tank', color: '#00cc33', description: 'Increases maximum fuel capacity, allowing for longer journeys.' },\n            { type: 'engine', name: 'Engine', color: '#ff9900', description: 'Enhances thruster power, increasing maximum velocity and maneuverability.' },\n            { type: 'mining', name: 'Mining Laser', color: '#ff3030', description: 'Increases mining speed and extraction efficiency, allowing faster resource collection.' },\n            { type: 'hull', name: 'Hull', color: '#30cfd0', description: 'Reinforces ship structure, improving collision resistance and reducing damage.' },\n            { type: 'scanner', name: 'Scanner', color: '#9933cc', description: 'Extends scanner range for detecting asteroids and other objects at greater distances.' }\n        ];\n        \n        return upgrades.map(upgrade => this.getUpgradeItemHTML(upgrade)).join('');\n    }\n    \n    getUpgradeItemHTML(upgrade: { type: string; name: string; color: string; description: string }): string {\n        const buttonColor = upgrade.color === '#ff3030' || upgrade.color === '#9933cc' ? '#fff' : '#000';\n        \n        return `\n            <div class=\"upgrade-item\">\n                <div class=\"upgrade-header\">\n                    <div>\n                        <strong style=\"color: ${upgrade.color};\">${upgrade.name} Level:</strong> <span id=\"current-${upgrade.type}-level\">1</span>\n                    </div>\n                    <div style=\"text-align: right;\">\n                        <strong>Current:</strong> <span id=\"current-${upgrade.type}-capacity\">--</span>\n                        <br>\n                        <small style=\"opacity: 0.8;\">Next: <span id=\"next-${upgrade.type}-capacity\">--</span></small>\n                    </div>\n                </div>\n                <div class=\"upgrade-progress\">\n                    <div id=\"${upgrade.type}-upgrade-progress\" class=\"upgrade-progress-bar\" style=\"background-color: ${upgrade.color}; width: 20%;\"></div>\n                </div>\n                <div class=\"upgrade-footer\">\n                    <div class=\"upgrade-description\">\n                        <p style=\"margin: 0; font-size: 12px;\">${upgrade.description}</p>\n                    </div>\n                    <button id=\"upgrade-${upgrade.type}\" style=\"flex: 1; padding: 10px; background-color: ${upgrade.color}; color: ${buttonColor}; border: none; border-radius: 5px; cursor: pointer; font-family: 'Courier New', monospace; font-weight: bold;\">\n                        UPGRADE (<span id=\"${upgrade.type}-upgrade-cost\">1000</span> CR)\n                    </button>\n                </div>\n            </div>\n        `;\n    }\n    \n    getFeaturesContent(): string {\n        return `\n            <div class=\"feature-buttons\">\n                <button id=\"open-star-map\" class=\"feature-btn\" style=\"background-color: #30cfd0;\">\n                    STAR MAP\n                    <small>Access star systems navigation</small>\n                </button>\n                <button id=\"create-custom-system\" class=\"feature-btn\" style=\"background: linear-gradient(135deg, #2c5a8c 0%, #4a76a8 100%); border: 1px solid #4a9dff; box-shadow: 0 0 10px rgba(74, 157, 255, 0.3);\">\n                    CREATE NEW SYSTEM\n                    <small>Generate custom AI star systems</small>\n                </button>\n                <button id=\"open-blackjack\" class=\"feature-btn\" style=\"background-color: #9933cc;\">\n                    STELLAR BLACKJACK\n                    <small>Wager resources in card games</small>\n                </button>\n                <button id=\"open-settings\" class=\"feature-btn\" style=\"background-color: #33aaff;\">\n                    SETTINGS\n                    <small>Adjust graphics and audio options</small>\n                </button>\n            </div>\n        `;\n    }\n    \n    getChallengeContent(): string {\n        return `\n            <button id=\"unleash-horde\" class=\"action-btn btn-horde\">\n                UNLEASH THE HORDE\n            </button>\n            <p style=\"font-size: 12px; color: #ff9999; margin: 10px 0 0 0;\">WARNING: Activate extreme survival mode with infinitely scaling difficulty</p>\n        `;\n    }\n    \n    getRandomWelcomeMessage(): string {\n        return this.welcomeMessages[Math.floor(Math.random() * this.welcomeMessages.length)];\n    }\n}\n","// keyboard.ts - Keyboard event handling and input management\n\ninterface KeyboardData {\n    input?: string;\n    character?: string;\n    text?: string;\n    functionNumber?: number;\n    key?: string;\n    modifiers: {\n        shift: boolean;\n        ctrl: boolean;\n        alt: boolean;\n    };\n}\n\nexport class TerminalKeyboard {\n    private keyHandlers: Map<string, ((data: KeyboardData) => void)[]>;\n    private inputBuffer: string;\n    private isActive: boolean;\n    private modifiers: {\n        shift: boolean;\n        ctrl: boolean;\n        alt: boolean;\n    };\n\n    constructor() {\n        this.keyHandlers = new Map();\n        this.inputBuffer = '';\n        this.isActive = false;\n        this.modifiers = {\n            shift: false,\n            ctrl: false,\n            alt: false\n        };\n        this.setupEventListeners();\n    }\n    \n    setupEventListeners(): void {\n        document.addEventListener('keydown', this.handleKeyDown.bind(this));\n        document.addEventListener('keyup', this.handleKeyUp.bind(this));\n        document.addEventListener('keypress', this.handleKeyPress.bind(this));\n    }\n    \n    handleKeyDown(event: KeyboardEvent): void {\n        if (!this.isActive) return;\n        \n        this.updateModifiers(event, true);\n        \n        // Handle special keys\n        switch (event.code) {\n            case 'Enter':\n                this.handleEnter(event);\n                break;\n            case 'Escape':\n                this.handleEscape(event);\n                break;\n            case 'Tab':\n                this.handleTab(event);\n                break;\n            case 'ArrowUp':\n                this.handleArrowUp(event);\n                break;\n            case 'ArrowDown':\n                this.handleArrowDown(event);\n                break;\n            case 'Backspace':\n                this.handleBackspace(event);\n                break;\n            case 'Delete':\n                this.handleDelete(event);\n                break;\n            case 'Home':\n                this.handleHome(event);\n                break;\n            case 'End':\n                this.handleEnd(event);\n                break;\n            default:\n                // Handle function keys and other special keys\n                if (event.code.startsWith('F')) {\n                    this.handleFunctionKey(event);\n                }\n                break;\n        }\n        \n        // Handle key combinations\n        if (this.modifiers.ctrl) {\n            this.handleCtrlCombination(event);\n        }\n        \n        if (this.modifiers.alt) {\n            this.handleAltCombination(event);\n        }\n    }\n    \n    handleKeyUp(event: KeyboardEvent): void {\n        this.updateModifiers(event, false);\n    }\n    \n    handleKeyPress(event: KeyboardEvent): void {\n        if (!this.isActive) return;\n        \n        // Handle printable characters\n        if (event.charCode >= 32 && event.charCode <= 126) {\n            this.handleCharacterInput(event.key);\n        }\n    }\n    \n    updateModifiers(event: KeyboardEvent, pressed: boolean): void {\n        if (event.code === 'ShiftLeft' || event.code === 'ShiftRight') {\n            this.modifiers.shift = pressed;\n        }\n        if (event.code === 'ControlLeft' || event.code === 'ControlRight') {\n            this.modifiers.ctrl = pressed;\n        }\n        if (event.code === 'AltLeft' || event.code === 'AltRight') {\n            this.modifiers.alt = pressed;\n        }\n    }\n    \n    handleEnter(event: KeyboardEvent): void {\n        event.preventDefault();\n        this.triggerHandler('enter', {\n            input: this.inputBuffer,\n            modifiers: { ...this.modifiers }\n        });\n        this.inputBuffer = '';\n    }\n    \n    handleEscape(event: KeyboardEvent): void {\n        event.preventDefault();\n        this.triggerHandler('escape', {\n            modifiers: { ...this.modifiers }\n        });\n        this.inputBuffer = '';\n    }\n    \n    handleTab(event: KeyboardEvent): void {\n        event.preventDefault();\n        this.triggerHandler('tab', {\n            input: this.inputBuffer,\n            modifiers: { ...this.modifiers }\n        });\n    }\n    \n    handleArrowUp(event: KeyboardEvent): void {\n        event.preventDefault();\n        this.triggerHandler('arrowUp', {\n            modifiers: { ...this.modifiers }\n        });\n    }\n    \n    handleArrowDown(event: KeyboardEvent): void {\n        event.preventDefault();\n        this.triggerHandler('arrowDown', {\n            modifiers: { ...this.modifiers }\n        });\n    }\n    \n    handleBackspace(event: KeyboardEvent): void {\n        event.preventDefault();\n        if (this.inputBuffer.length > 0) {\n            this.inputBuffer = this.inputBuffer.slice(0, -1);\n            this.triggerHandler('backspace', {\n                input: this.inputBuffer,\n                modifiers: { ...this.modifiers }\n            });\n        }\n    }\n    \n    handleDelete(event: KeyboardEvent): void {\n        event.preventDefault();\n        this.triggerHandler('delete', {\n            input: this.inputBuffer,\n            modifiers: { ...this.modifiers }\n        });\n    }\n    \n    handleHome(event: KeyboardEvent): void {\n        event.preventDefault();\n        this.triggerHandler('home', {\n            modifiers: { ...this.modifiers }\n        });\n    }\n    \n    handleEnd(event: KeyboardEvent): void {\n        event.preventDefault();\n        this.triggerHandler('end', {\n            modifiers: { ...this.modifiers }\n        });\n    }\n    \n    handleFunctionKey(event: KeyboardEvent): void {\n        event.preventDefault();\n        const functionNumber = parseInt(event.code.substring(1));\n        this.triggerHandler('function', {\n            functionNumber,\n            modifiers: { ...this.modifiers }\n        });\n    }\n    \n    handleCtrlCombination(event: KeyboardEvent): void {\n        switch (event.code) {\n            case 'KeyC':\n                event.preventDefault();\n                this.triggerHandler('ctrlC', {\n                    input: this.inputBuffer,\n                    modifiers: { ...this.modifiers }\n                });\n                break;\n            case 'KeyV':\n                event.preventDefault();\n                this.handlePaste();\n                break;\n            case 'KeyA':\n                event.preventDefault();\n                this.triggerHandler('ctrlA', {\n                    input: this.inputBuffer,\n                    modifiers: { ...this.modifiers }\n                });\n                break;\n            case 'KeyL':\n                event.preventDefault();\n                this.triggerHandler('ctrlL', {\n                    modifiers: { ...this.modifiers }\n                });\n                break;\n        }\n    }\n    \n    handleAltCombination(event: KeyboardEvent): void {\n        // Handle Alt+key combinations\n        this.triggerHandler('alt', {\n            key: event.code,\n            modifiers: { ...this.modifiers }\n        });\n    }\n    \n    handleCharacterInput(character: string): void {\n        this.inputBuffer += character;\n        this.triggerHandler('character', {\n            character,\n            input: this.inputBuffer,\n            modifiers: { ...this.modifiers }\n        });\n    }\n    \n    async handlePaste(): Promise<void> {\n        try {\n            const text = await navigator.clipboard.readText();\n            this.inputBuffer += text;\n            this.triggerHandler('paste', {\n                text,\n                input: this.inputBuffer,\n                modifiers: { ...this.modifiers }\n            });\n        } catch (error) {\n            console.warn('Clipboard access failed:', error);\n        }\n    }\n    \n    registerHandler(event: string, callback: (data: KeyboardData) => void): void {\n        if (!this.keyHandlers.has(event)) {\n            this.keyHandlers.set(event, []);\n        }\n        this.keyHandlers.get(event)!.push(callback);\n    }\n    \n    unregisterHandler(event: string, callback: (data: KeyboardData) => void): void {\n        const handlers = this.keyHandlers.get(event);\n        if (handlers) {\n            const index = handlers.indexOf(callback);\n            if (index > -1) {\n                handlers.splice(index, 1);\n            }\n        }\n    }\n    \n    triggerHandler(event: string, data: KeyboardData): void {\n        const handlers = this.keyHandlers.get(event);\n        if (handlers) {\n            handlers.forEach(handler => {\n                try {\n                    handler(data);\n                } catch (error) {\n                    console.error(`Error in ${event} handler:`, error);\n                }\n            });\n        }\n    }\n    \n    activate(): void {\n        this.isActive = true;\n        this.inputBuffer = '';\n    }\n    \n    deactivate(): void {\n        this.isActive = false;\n        this.inputBuffer = '';\n    }\n    \n    clearInput(): void {\n        this.inputBuffer = '';\n    }\n    \n    getInput(): string {\n        return this.inputBuffer;\n    }\n    \n    setInput(text: string): void {\n        this.inputBuffer = text || '';\n    }\n}\n","// terminalView.ts - Main terminal view coordinator\n\n// Import all terminal modules\nimport { TerminalScreen } from './terminal/display/screen.js';\nimport { TerminalEffects } from './terminal/display/effects.js';\nimport { CommandParser } from './terminal/commands/parser.js';\nimport { CommandHandlers } from './terminal/commands/handlers.js';\nimport { TerminalMessages } from './terminal/content/messages.js';\nimport { TerminalKeyboard } from './terminal/input/keyboard.js';\n\nexport class TerminalView {\n    private screen: TerminalScreen;\n    private effects: TerminalEffects;\n    private parser: CommandParser;\n    private handlers: CommandHandlers;\n    private messages: TerminalMessages;\n    private keyboard: TerminalKeyboard;\n    \n    constructor() {\n        // Initialize all modules\n        this.screen = new TerminalScreen();\n        this.effects = new TerminalEffects();\n        this.parser = new CommandParser();\n        this.handlers = new CommandHandlers(this);\n        this.messages = new TerminalMessages();\n        this.keyboard = new TerminalKeyboard();\n\n        this.setupKeyboardHandlers();\n    }\n\n    setMobile(isMobile: boolean): void {\n        this.screen.setMobile(isMobile);\n    }\n    \n    setupKeyboardHandlers(): void {\n        // Register keyboard event handlers for terminal commands\n        this.keyboard.registerHandler('enter', (data) => {\n            if (data.input?.trim()) {\n                this.handleCommand(data.input);\n            }\n        });\n        \n        this.keyboard.registerHandler('escape', () => {\n            this.hide();\n        });\n        \n        this.keyboard.registerHandler('ctrlL', () => {\n            this.clearTerminal();\n        });\n    }\n    \n    async handleCommand(input: string): Promise<void> {\n        const parsed = this.parser.parseCommand(input);\n        const result = await this.handlers.executeCommand(parsed);\n        \n        if (result.clearScreen) {\n            this.clearTerminal();\n        } else if (result.message) {\n            this.displayMessage(result.message);\n        }\n        \n        // Handle specific actions\n        if (result.action) {\n            this.handleAction(result.action, result.target);\n        }\n    }\n    \n    handleAction(action: string, target?: string): void {\n        // This would trigger the appropriate stargate interface actions\n        switch (action) {\n            case 'undock':\n                this.hide();\n                break;\n            case 'refuel':\n                this.triggerRefuel();\n                break;\n            case 'repair':\n                this.triggerRepair(target);\n                break;\n            case 'enhance':\n                this.triggerUpgrade(target);\n                break;\n            case 'purchase':\n                this.triggerPurchase(target);\n                break;\n            // Add more actions as needed\n        }\n    }\n    \n    displayMessage(message: string): void {\n        // This would display the message in a terminal-style interface\n        console.log('Terminal:', message);\n    }\n    \n    clearTerminal(): void {\n        // Clear terminal display\n        console.clear();\n    }\n    \n    // Delegate methods to modules\n    createStyles(): void {\n        this.effects.createStyles();\n    }\n    \n    createDockingPrompt(): HTMLElement {\n        return this.screen.createDockingPrompt();\n    }\n\n    createMainUI(): HTMLElement {\n        return this.screen.createMainUI();\n    }\n    \n    getMainUIContent(): string {\n        return this.messages.getMainUIContent();\n    }\n    \n    getUpgradesContent(): string {\n        return this.messages.getUpgradesContent();\n    }\n    \n    showDockingPrompt(): void {\n        this.screen.showDockingPrompt();\n    }\n    \n    hideDockingPrompt(): void {\n        this.screen.hideDockingPrompt();\n    }\n    \n    show(): void {\n        this.screen.showUI();\n        this.keyboard.activate();\n    }\n    \n    hide(): void {\n        this.screen.hideUI();\n        this.keyboard.deactivate();\n    }\n    \n    // Event trigger methods for stargate interface integration\n    triggerRefuel(): void {\n        // To be implemented by the parent stargate interface\n        console.log('Refuel triggered');\n    }\n    \n    triggerRepair(system?: string): void {\n        // To be implemented by the parent stargate interface\n        console.log('Repair triggered for:', system);\n    }\n    \n    triggerUpgrade(system?: string): void {\n        // To be implemented by the parent stargate interface\n        console.log('Upgrade triggered for:', system);\n    }\n    \n    triggerPurchase(item?: string): void {\n        // To be implemented by the parent stargate interface\n        console.log('Purchase triggered for:', item);\n    }\n}\n","// systemsView.ts - Systems list and navigation UI\n\ninterface StarMap {\n    show(): void;\n}\n\ninterface BlackjackGame {\n    show(): void;\n}\n\ninterface Settings {\n    show(): void;\n}\n\nexport class SystemsView {\n    private starMap: StarMap | null;\n    private blackjackGame: BlackjackGame | null;\n    private settings: Settings | null;\n    \n    constructor() {\n        this.starMap = null;\n        this.blackjackGame = null;\n        this.settings = null;\n    }\n    \n    setStarMap(starMap: StarMap): void {\n        this.starMap = starMap;\n    }\n    \n    setBlackjackGame(blackjackGame: BlackjackGame): void {\n        this.blackjackGame = blackjackGame;\n    }\n    \n    setSettings(settings: Settings): void {\n        this.settings = settings;\n    }\n    \n    setupStarMapButton(): void {\n        const starMapButton = document.getElementById('open-star-map');\n        if (starMapButton && this.starMap) {\n            starMapButton.addEventListener('click', () => {\n                console.log(\"Opening star map\");\n                this.hideStargateUI();\n                this.starMap!.show();\n            });\n        } else if (starMapButton) {\n            // If star map not available, disable the button\n            (starMapButton as HTMLButtonElement).disabled = true;\n            (starMapButton as HTMLElement).style.backgroundColor = '#555';\n            (starMapButton as HTMLElement).style.cursor = 'not-allowed';\n            starMapButton.title = 'Star map not available';\n        }\n    }\n    \n    setupBlackjackButton(): void {\n        const blackjackButton = document.getElementById('open-blackjack');\n        if (blackjackButton && this.blackjackGame) {\n            blackjackButton.addEventListener('click', () => {\n                console.log(\"Opening blackjack game\");\n                this.hideStargateUI();\n                this.blackjackGame!.show();\n            });\n        } else if (blackjackButton) {\n            // If blackjack game not available, disable the button\n            (blackjackButton as HTMLButtonElement).disabled = true;\n            (blackjackButton as HTMLElement).style.backgroundColor = '#555';\n            (blackjackButton as HTMLElement).style.cursor = 'not-allowed';\n            blackjackButton.title = 'Blackjack game not available';\n        }\n    }\n    \n    setupSettingsButton(): void {\n        if (!this.settings) return;\n        \n        const settingsButton = document.getElementById('open-settings');\n        if (settingsButton) {\n            settingsButton.addEventListener('click', () => {\n                console.log(\"Opening settings\");\n                this.hideStargateUI();\n                this.settings!.show();\n            });\n        }\n    }\n    \n    setupCustomSystemButton(): void {\n        const customSystemBtn = document.getElementById('create-custom-system');\n        if (customSystemBtn) {\n            customSystemBtn.addEventListener('click', () => {\n                // Check if custom system creator is available on environment\n                if (window.game && (window.game as any).environment && (window.game as any).environment.customSystemCreator) {\n                    // Close stargate interface\n                    this.hideStargateUI();\n                    \n                    // Show custom system creator\n                    (window.game as any).environment.customSystemCreator.show();\n                } else {\n                    console.error('Custom system creator not available');\n                }\n            });\n        }\n    }\n    \n    hideStargateUI(): void {\n        const stargateUI = document.getElementById('stargate-ui');\n        if (stargateUI) {\n            stargateUI.style.display = 'none';\n        }\n    }\n    \n    setupAllSystemButtons(): void {\n        this.setupStarMapButton();\n        this.setupBlackjackButton();\n        this.setupSettingsButton();\n        this.setupCustomSystemButton();\n    }\n}\n","// tradingView.ts - Trading interface components and logic\n\nimport { mainMessageBus } from '../../../../globals/messageBus.ts';\n\ninterface Resources {\n    iron: number;\n    gold: number;\n    platinum: number;\n    orbs?: {\n        common: number;\n        uncommon: number;\n        rare: number;\n        epic: number;\n        legendary: number;\n    };\n}\n\ninterface Spaceship {\n    credits: number;\n    deployableLaserCount?: number;\n}\n\nexport class TradingView {\n    private spaceship: Spaceship | null;\n    private resources: Resources | null;\n    \n    constructor() {\n        this.spaceship = null;\n        this.resources = null;\n    }\n    \n    setGameReferences(spaceship: Spaceship, resources: Resources): void {\n        this.spaceship = spaceship;\n        this.resources = resources;\n    }\n    \n    // Sell an energy orb of the specified rarity\n    sellEnergyOrb(rarity: string): boolean {\n        // Make sure we have spaceship and resources references\n        if (!this.spaceship || !this.resources) {\n            console.error(\"Required game objects not available\");\n            return false;\n        }\n        \n        // Check if orbs property exists, initialize if needed\n        if (!this.resources.orbs) {\n            this.resources.orbs = {\n                common: 0,\n                uncommon: 0,\n                rare: 0,\n                epic: 0,\n                legendary: 0\n            };\n            return false; // No orbs available yet\n        }\n        \n        // Check if player has any orbs of the specified rarity\n        if (!this.resources.orbs[rarity as keyof typeof this.resources.orbs] || this.resources.orbs[rarity as keyof typeof this.resources.orbs]! <= 0) {\n            console.log(`No ${rarity} orbs available to sell`);\n            return false;\n        }\n        \n        // Calculate value based on rarity\n        let value = 0;\n        switch (rarity) {\n            case 'common':\n                value = 100;\n                break;\n            case 'uncommon':\n                value = 500;\n                break;\n            case 'rare':\n                value = 1500;\n                break;\n            case 'epic':\n                value = 5000;\n                break;\n            case 'legendary':\n                value = 15000;\n                break;\n            default:\n                console.error(`Unknown orb rarity: ${rarity}`);\n                return false;\n        }\n        \n        // Sell the orb - update inventory and credits\n        const orbCount = this.resources.orbs[rarity as keyof typeof this.resources.orbs]!;\n        this.resources.orbs[rarity as keyof typeof this.resources.orbs] = orbCount - 1;\n        this.spaceship.credits += value;\n        \n        // Show message\n        const capitalizedRarity = rarity.charAt(0).toUpperCase() + rarity.slice(1);\n        this.showNotification(`Sold ${capitalizedRarity} Energy Orb for ${value} credits`, 0x33aaff);\n        \n        // Play sound if audio manager is available\n        if (window.game && (window.game as any).audio) {\n            (window.game as any).audio.playSoundEffect('sell', 0.5);\n        }\n        \n        return true;\n    }\n    \n    /**\n     * Purchase a deployable laser turret\n     */\n    purchaseLaserTurret(): void {\n        console.log(\"Attempting to purchase laser turret\");\n        \n        // Check if spaceship is available\n        if (!this.spaceship) {\n            console.error(\"Cannot purchase laser turret: spaceship not found\");\n            return;\n        }\n        \n        // Check if player has enough credits\n        if (this.spaceship.credits < 1000) {\n            console.log(\"Not enough credits to purchase laser turret\");\n            // Show notification to the player\n            if (mainMessageBus) {\n                (mainMessageBus as any).publish('ui.notification', {\n                    message: \"Not enough credits to purchase laser turret\",\n                    type: \"error\",\n                    duration: 2\n                });\n            }\n            return;\n        }\n        \n        // Purchase the laser turret\n        this.spaceship.credits -= 1000;\n        \n        // Initialize deployableLaserCount if it doesn't exist\n        if (typeof this.spaceship.deployableLaserCount === 'undefined') {\n            this.spaceship.deployableLaserCount = 0;\n        }\n        \n        // Add a laser turret to the player's inventory\n        this.spaceship.deployableLaserCount++;\n        \n        // Play purchase sound\n        if (window.game && (window.game as any).audio && (window.game as any).audio.playSound) {\n            (window.game as any).audio.playSound('purchase');\n        }\n        \n        // Show notification to the player\n        if (mainMessageBus) {\n            (mainMessageBus as any).publish('ui.notification', {\n                message: \"Laser turret purchased\",\n                type: \"success\",\n                duration: 2\n            });\n        }\n        \n        console.log(\"Laser turret purchased successfully\");\n    }\n    \n    // Helper method to show notifications\n    showNotification(message: string, color = 0x33aaff): void {\n        // Create notification element\n        const notification = document.createElement('div');\n        notification.style.position = 'fixed';\n        notification.style.top = '35%';\n        notification.style.left = '50%';\n        notification.style.transform = 'translate(-50%, -50%)';\n        notification.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';\n        notification.style.color = '#fff';\n        notification.style.padding = '15px 30px';\n        notification.style.borderRadius = '10px';\n        notification.style.border = `2px solid #${color.toString(16).padStart(6, '0')}`;\n        notification.style.boxShadow = `0 0 15px #${color.toString(16).padStart(6, '0')}`;\n        notification.style.fontFamily = 'Courier New, monospace';\n        notification.style.fontSize = '16px';\n        notification.style.zIndex = '1001'; // Above the stargate UI\n        notification.style.textAlign = 'center';\n        \n        // Set notification text\n        notification.textContent = message;\n        \n        // Add to DOM\n        document.body.appendChild(notification);\n        \n        // Remove after a few seconds\n        setTimeout(() => {\n            notification.style.opacity = '0';\n            notification.style.transition = 'opacity 0.8s';\n            \n            setTimeout(() => {\n                notification.remove();\n            }, 800);\n        }, 2000);\n    }\n    \n    updateOrbCounts(): void {\n        if (!this.resources) return;\n        \n        if (!this.resources.orbs) {\n            this.resources.orbs = {\n                common: 0,\n                uncommon: 0,\n                rare: 0,\n                epic: 0,\n                legendary: 0\n            };\n        }\n        \n        // Update orb counts\n        const commonCount = document.getElementById('orb-common-count');\n        const uncommonCount = document.getElementById('orb-uncommon-count');\n        const rareCount = document.getElementById('orb-rare-count');\n        const epicCount = document.getElementById('orb-epic-count');\n        const legendaryCount = document.getElementById('orb-legendary-count');\n        \n        if (commonCount) {\n            commonCount.textContent = this.resources.orbs.common > 0 ? \n                `${this.resources.orbs.common} in inventory` : \"0 in inventory\";\n        }\n        if (uncommonCount) {\n            uncommonCount.textContent = this.resources.orbs.uncommon > 0 ? \n                `${this.resources.orbs.uncommon} in inventory` : \"0 in inventory\";\n        }\n        if (rareCount) {\n            rareCount.textContent = this.resources.orbs.rare > 0 ? \n                `${this.resources.orbs.rare} in inventory` : \"0 in inventory\";\n        }\n        if (epicCount) {\n            epicCount.textContent = this.resources.orbs.epic > 0 ? \n                `${this.resources.orbs.epic} in inventory` : \"0 in inventory\";\n        }\n        if (legendaryCount) {\n            legendaryCount.textContent = this.resources.orbs.legendary > 0 ? \n                `${this.resources.orbs.legendary} in inventory` : \"0 in inventory\";\n        }\n    }\n    \n    updateOrbSellButtons(): void {\n        if (!this.resources || !this.resources.orbs) return;\n        \n        const updateOrbSellButton = (buttonId: string, orbCount: number, borderColor: string): void => {\n            const button = document.getElementById(buttonId) as HTMLButtonElement;\n            if (!button) return;\n            \n            if (orbCount === 0) {\n                button.disabled = true;\n                button.style.backgroundColor = 'rgba(40, 40, 40, 0.8)';\n                button.style.color = '#777';\n                button.style.cursor = 'not-allowed';\n                button.style.boxShadow = 'none';\n            } else {\n                button.disabled = false;\n                button.style.backgroundColor = 'rgba(15, 40, 55, 0.8)';\n                button.style.color = '#fff';\n                button.style.cursor = 'pointer';\n                button.style.boxShadow = `0 0 10px ${borderColor}`;\n            }\n        };\n        \n        updateOrbSellButton('sell-orb-common', this.resources.orbs.common, 'rgba(0, 255, 102, 0.3)');\n        updateOrbSellButton('sell-orb-uncommon', this.resources.orbs.uncommon, 'rgba(0, 102, 255, 0.3)');\n        updateOrbSellButton('sell-orb-rare', this.resources.orbs.rare, 'rgba(153, 0, 255, 0.3)');\n        updateOrbSellButton('sell-orb-epic', this.resources.orbs.epic, 'rgba(255, 102, 0, 0.3)');\n        updateOrbSellButton('sell-orb-legendary', this.resources.orbs.legendary, 'rgba(255, 0, 0, 0.3)');\n    }\n    \n    updateLaserTurretDisplay(): void {\n        if (!this.spaceship) return;\n        \n        // Update the laser turret count\n        const laserCountElement = document.getElementById('current-laser-count');\n        if (laserCountElement) {\n            laserCountElement.textContent = String(this.spaceship.deployableLaserCount || 0);\n        }\n        \n        // Update the purchase laser button status\n        const purchaseLaserBtn = document.getElementById('purchase-laser') as HTMLButtonElement;\n        if (purchaseLaserBtn) {\n            if (this.spaceship.credits < 1000) {\n                purchaseLaserBtn.disabled = true;\n                purchaseLaserBtn.style.backgroundColor = '#555';\n                purchaseLaserBtn.style.cursor = 'not-allowed';\n            } else {\n                purchaseLaserBtn.disabled = false;\n                purchaseLaserBtn.style.backgroundColor = '#FF3333';\n                purchaseLaserBtn.style.cursor = 'pointer';\n            }\n        }\n    }\n    \n    updateResourceSellButtons(): void {\n        if (!this.resources) return;\n        \n        // Disable sell buttons if no resources\n        const sellIron = document.getElementById('sell-iron') as HTMLButtonElement;\n        const sellGold = document.getElementById('sell-gold') as HTMLButtonElement;\n        const sellPlatinum = document.getElementById('sell-platinum') as HTMLButtonElement;\n        \n        if (sellIron) sellIron.disabled = this.resources.iron === 0;\n        if (sellGold) sellGold.disabled = this.resources.gold === 0;\n        if (sellPlatinum) sellPlatinum.disabled = this.resources.platinum === 0;\n        \n        // Update sell button styles based on resource availability\n        this.updateSellButtonStatus('sell-iron', this.resources.iron, '#cc6633');\n        this.updateSellButtonStatus('sell-gold', this.resources.gold, '#ffcc33');\n        this.updateSellButtonStatus('sell-platinum', this.resources.platinum, '#33ccff');\n        \n        // Update button styles based on disabled state\n        document.querySelectorAll('.sell-btn').forEach(btn => {\n            const button = btn as HTMLButtonElement;\n            if (button.disabled) {\n                button.style.backgroundColor = 'rgba(40, 40, 40, 0.8)';\n                button.style.color = '#777';\n                button.style.cursor = 'not-allowed';\n                button.style.boxShadow = 'none';\n            }\n        });\n    }\n    \n    // Update sell button styles based on available resources\n    updateSellButtonStatus(buttonId: string, resourceAmount: number, borderColor: string): void {\n        const button = document.getElementById(buttonId) as HTMLButtonElement;\n        if (!button) return;\n        \n        if (resourceAmount === 0) {\n            button.disabled = true;\n            button.style.backgroundColor = 'rgba(40, 40, 40, 0.8)';\n            button.style.borderColor = '#555';\n            button.style.color = '#777';\n            button.style.boxShadow = 'none';\n            button.style.cursor = 'not-allowed';\n        } else {\n            button.disabled = false;\n            button.style.backgroundColor = 'rgba(15, 40, 55, 0.8)';\n            button.style.borderColor = borderColor;\n            button.style.color = '#fff';\n            const r = parseInt(borderColor.slice(1, 3), 16);\n            const g = parseInt(borderColor.slice(3, 5), 16);\n            const b = parseInt(borderColor.slice(5, 7), 16);\n            button.style.boxShadow = `0 0 10px rgba(${r}, ${g}, ${b}, 0.3)`;\n            button.style.cursor = 'pointer';\n        }\n    }\n}\n","// upgrades.ts - Ship upgrades UI and logic\n\ninterface Spaceship {\n    fuelTankLevel: number;\n    maxFuel: number;\n    fuelUpgradeCost: number;\n    engineLevel: number;\n    maxVelocity: number;\n    engineUpgradeCost: number;\n    miningLevel: number;\n    miningEfficiency: number;\n    miningUpgradeCost: number;\n    hullLevel: number;\n    collisionResistance: number;\n    hullUpgradeCost: number;\n    scannerLevel: number;\n    scanRange: number;\n    scannerUpgradeCost: number;\n    credits: number;\n}\n\nexport class UpgradesView {\n    private spaceship: Spaceship | null;\n    \n    constructor() {\n        this.spaceship = null;\n    }\n    \n    setSpaceship(spaceship: Spaceship): void {\n        this.spaceship = spaceship;\n    }\n    \n    updateUpgradeDisplays(): void {\n        if (!this.spaceship) return;\n        \n        // Update Fuel Tank upgrade information\n        const currentFuelLevel = document.getElementById('current-fuel-level');\n        const currentFuelCapacity = document.getElementById('current-fuel-capacity');\n        const nextFuelCapacity = document.getElementById('next-fuel-capacity');\n        const fuelUpgradeCost = document.getElementById('fuel-upgrade-cost');\n        const fuelUpgradeProgress = document.getElementById('fuel-upgrade-progress');\n        \n        if (currentFuelLevel) currentFuelLevel.textContent = String(this.spaceship.fuelTankLevel);\n        if (currentFuelCapacity) currentFuelCapacity.textContent = String(this.spaceship.maxFuel);\n        if (nextFuelCapacity) nextFuelCapacity.textContent = String(this.spaceship.maxFuel * 2);\n        if (fuelUpgradeCost) fuelUpgradeCost.textContent = String(this.spaceship.fuelUpgradeCost);\n        if (fuelUpgradeProgress) {\n            fuelUpgradeProgress.style.width = `${Math.min(this.spaceship.fuelTankLevel * 20, 100)}%`;\n        }\n        \n        // Update Engine upgrade information\n        const currentEngineLevel = document.getElementById('current-engine-level');\n        const currentMaxVelocity = document.getElementById('current-max-velocity');\n        const nextMaxVelocity = document.getElementById('next-max-velocity');\n        const engineUpgradeCost = document.getElementById('engine-upgrade-cost');\n        const engineUpgradeProgress = document.getElementById('engine-upgrade-progress');\n        \n        if (currentEngineLevel) currentEngineLevel.textContent = String(this.spaceship.engineLevel);\n        if (currentMaxVelocity) currentMaxVelocity.textContent = this.spaceship.maxVelocity.toFixed(2);\n        if (nextMaxVelocity) nextMaxVelocity.textContent = (this.spaceship.maxVelocity * 1.25).toFixed(2);\n        if (engineUpgradeCost) engineUpgradeCost.textContent = String(this.spaceship.engineUpgradeCost);\n        if (engineUpgradeProgress) {\n            engineUpgradeProgress.style.width = `${Math.min(this.spaceship.engineLevel * 20, 100)}%`;\n        }\n        \n        // Update Mining Laser upgrade information\n        const currentMiningLevel = document.getElementById('current-mining-level');\n        const currentMiningEfficiency = document.getElementById('current-mining-efficiency');\n        const nextMiningEfficiency = document.getElementById('next-mining-efficiency');\n        const miningUpgradeCost = document.getElementById('mining-upgrade-cost');\n        const miningUpgradeProgress = document.getElementById('mining-upgrade-progress');\n        \n        if (currentMiningLevel) currentMiningLevel.textContent = String(this.spaceship.miningLevel);\n        if (currentMiningEfficiency) {\n            currentMiningEfficiency.textContent = String(Math.round(this.spaceship.miningEfficiency * 100));\n        }\n        if (nextMiningEfficiency) {\n            nextMiningEfficiency.textContent = String(Math.round(this.spaceship.miningEfficiency * 130));\n        }\n        if (miningUpgradeCost) miningUpgradeCost.textContent = String(this.spaceship.miningUpgradeCost);\n        if (miningUpgradeProgress) {\n            miningUpgradeProgress.style.width = `${Math.min(this.spaceship.miningLevel * 20, 100)}%`;\n        }\n        \n        // Update Hull upgrade information\n        const currentHullLevel = document.getElementById('current-hull-level');\n        const currentHullResistance = document.getElementById('current-hull-resistance');\n        const nextHullResistance = document.getElementById('next-hull-resistance');\n        const hullUpgradeCost = document.getElementById('hull-upgrade-cost');\n        const hullUpgradeProgress = document.getElementById('hull-upgrade-progress');\n        \n        if (currentHullLevel) currentHullLevel.textContent = String(this.spaceship.hullLevel);\n        if (currentHullResistance) {\n            currentHullResistance.textContent = String(Math.round(this.spaceship.collisionResistance * 100));\n        }\n        if (nextHullResistance) {\n            nextHullResistance.textContent = String(Math.round(this.spaceship.collisionResistance * 125));\n        }\n        if (hullUpgradeCost) hullUpgradeCost.textContent = String(this.spaceship.hullUpgradeCost);\n        if (hullUpgradeProgress) {\n            hullUpgradeProgress.style.width = `${Math.min(this.spaceship.hullLevel * 20, 100)}%`;\n        }\n        \n        // Update Scanner upgrade information\n        const currentScannerLevel = document.getElementById('current-scanner-level');\n        const currentScannerRange = document.getElementById('current-scanner-range');\n        const nextScannerRange = document.getElementById('next-scanner-range');\n        const scannerUpgradeCost = document.getElementById('scanner-upgrade-cost');\n        const scannerUpgradeProgress = document.getElementById('scanner-upgrade-progress');\n        \n        if (currentScannerLevel) currentScannerLevel.textContent = String(this.spaceship.scannerLevel);\n        if (currentScannerRange) {\n            currentScannerRange.textContent = String(Math.round(this.spaceship.scanRange));\n        }\n        if (nextScannerRange) {\n            nextScannerRange.textContent = String(Math.round(this.spaceship.scanRange * 1.2));\n        }\n        if (scannerUpgradeCost) scannerUpgradeCost.textContent = String(this.spaceship.scannerUpgradeCost);\n        if (scannerUpgradeProgress) {\n            scannerUpgradeProgress.style.width = `${Math.min(this.spaceship.scannerLevel * 20, 100)}%`;\n        }\n        \n        // Update upgrade button statuses\n        this.updateUpgradeButtonStatus('upgrade-fuel-tank', this.spaceship.credits, this.spaceship.fuelUpgradeCost, '#00cc33');\n        this.updateUpgradeButtonStatus('upgrade-engine', this.spaceship.credits, this.spaceship.engineUpgradeCost, '#ff9900');\n        this.updateUpgradeButtonStatus('upgrade-mining', this.spaceship.credits, this.spaceship.miningUpgradeCost, '#ff3030');\n        this.updateUpgradeButtonStatus('upgrade-hull', this.spaceship.credits, this.spaceship.hullUpgradeCost, '#30cfd0');\n        this.updateUpgradeButtonStatus('upgrade-scanner', this.spaceship.credits, this.spaceship.scannerUpgradeCost, '#9933cc');\n    }\n    \n    // Helper method to update upgrade button status\n    updateUpgradeButtonStatus(buttonId: string, currentCredits: number, cost: number, activeColor: string): void {\n        const button = document.getElementById(buttonId) as HTMLButtonElement;\n        if (!button) return;\n        \n        if (currentCredits < cost) {\n            button.disabled = true;\n            button.style.backgroundColor = '#555';\n            button.style.color = '#777';\n            button.style.cursor = 'not-allowed';\n        } else {\n            button.disabled = false;\n            button.style.backgroundColor = activeColor;\n            button.style.color = activeColor === '#ff9900' || activeColor === '#30cfd0' ? '#000' : '#fff';\n            button.style.cursor = 'pointer';\n        }\n    }\n}\n","// missions.ts - Mission selection and display (including challenge systems)\n\nexport class MissionsView {\n    private hideStargateUICallback: (() => void) | null;\n    \n    constructor() {\n        this.hideStargateUICallback = null;\n    }\n    \n    setHideCallback(callback: () => void): void {\n        this.hideStargateUICallback = callback;\n    }\n    \n    setupHordeButton(): void {\n        const hordeButton = document.getElementById('unleash-horde');\n        if (hordeButton) {\n            hordeButton.addEventListener('click', () => {\n                // Check if spectral drones have started spawning\n                const dronesHaveSpawned = window.game && \n                                         (window.game as any).ecsWorld && \n                                         (window.game as any).ecsWorld.enemySystem && \n                                         (window.game as any).ecsWorld.enemySystem.initialSpawnComplete;\n                \n                if (dronesHaveSpawned) {\n                    console.log(\"HORDE MODE: Button clicked, showing confirmation\");\n                    this.showHordeConfirmation();\n                } else {\n                    console.log(\"HORDE MODE: Button clicked but spectral drones haven't appeared yet\");\n                    // Show notification that horde mode is not available yet\n                    this.showNotification(\"Horde mode is only available after spectral drones appear in the sector.\", 0xff3030);\n                }\n            });\n        }\n    }\n    \n    /**\n     * Show confirmation dialog for activating horde mode\n     */\n    showHordeConfirmation(): void {\n        // Create modal overlay\n        const modal = document.createElement('div');\n        modal.id = 'horde-confirm-modal';\n        \n        // Create content container\n        const content = document.createElement('div');\n        content.id = 'horde-confirm-content';\n        \n        // Add title\n        const title = document.createElement('div');\n        title.className = 'horde-confirm-title';\n        title.textContent = 'UNLEASH THE HORDE?';\n        content.appendChild(title);\n        \n        // Add warning text\n        const text = document.createElement('div');\n        text.className = 'horde-confirm-text';\n        text.innerHTML = `\n            <p>You are about to activate EXTREME SURVIVAL MODE.</p>\n            <p>Enemies will continuously spawn with increasing:</p>\n            <ul style=\"text-align: left; padding-left: 30px; margin: 15px 0;\">\n                <li>Numbers (starting at 50, scaling upward)</li>\n                <li>Speed (progressively faster movement)</li>\n                <li>Health (gradually becoming tougher)</li>\n                <li>Damage (increasingly lethal hits)</li>\n            </ul>\n            <p>Difficulty will scale <strong>infinitely</strong> until you are overwhelmed.</p>\n            <p style=\"color: #ff9999;\">This is a test of survival. How long can you last?</p>\n        `;\n        content.appendChild(text);\n        \n        // Add buttons container\n        const buttons = document.createElement('div');\n        buttons.className = 'horde-confirm-buttons';\n        \n        // Add YES button\n        const yesBtn = document.createElement('button');\n        yesBtn.className = 'horde-confirm-btn horde-confirm-yes';\n        yesBtn.textContent = 'UNLEASH THEM';\n        yesBtn.addEventListener('click', () => {\n            // Remove the confirmation dialog\n            document.body.removeChild(modal);\n            \n            // Hide the stargate UI\n            if (this.hideStargateUICallback) {\n                this.hideStargateUICallback();\n            }\n            \n            // Activate horde mode in the game\n            if (window.game && typeof (window.game as any).activateHordeMode === 'function') {\n                (window.game as any).activateHordeMode();\n                console.log(\"HORDE MODE: Activated via stargateInterface\");\n            } else {\n                console.error(\"HORDE MODE: Failed to activate - game.activateHordeMode not available\");\n            }\n        });\n        \n        // Add NO button\n        const noBtn = document.createElement('button');\n        noBtn.className = 'horde-confirm-btn horde-confirm-no';\n        noBtn.textContent = 'CANCEL';\n        noBtn.addEventListener('click', () => {\n            // Just remove the confirmation dialog\n            document.body.removeChild(modal);\n        });\n        \n        // Add buttons to container\n        buttons.appendChild(noBtn);  // Cancel on left\n        buttons.appendChild(yesBtn); // Confirm on right\n        \n        // Add buttons to content\n        content.appendChild(buttons);\n        \n        // Add content to modal\n        modal.appendChild(content);\n        \n        // Add modal to body\n        document.body.appendChild(modal);\n    }\n    \n    // Helper method to show notifications\n    showNotification(message: string, color = 0x33aaff): void {\n        // Create notification element\n        const notification = document.createElement('div');\n        notification.style.position = 'fixed';\n        notification.style.top = '35%';\n        notification.style.left = '50%';\n        notification.style.transform = 'translate(-50%, -50%)';\n        notification.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';\n        notification.style.color = '#fff';\n        notification.style.padding = '15px 30px';\n        notification.style.borderRadius = '10px';\n        notification.style.border = `2px solid #${color.toString(16).padStart(6, '0')}`;\n        notification.style.boxShadow = `0 0 15px #${color.toString(16).padStart(6, '0')}`;\n        notification.style.fontFamily = 'Courier New, monospace';\n        notification.style.fontSize = '16px';\n        notification.style.zIndex = '1001'; // Above the stargate UI\n        notification.style.textAlign = 'center';\n        \n        // Set notification text\n        notification.textContent = message;\n        \n        // Add to DOM\n        document.body.appendChild(notification);\n        \n        // Remove after a few seconds\n        setTimeout(() => {\n            notification.style.opacity = '0';\n            notification.style.transition = 'opacity 0.8s';\n            \n            setTimeout(() => {\n                notification.remove();\n            }, 800);\n        }, 2000);\n    }\n}\n","// eventHandlers.ts - Event handling and MessageBus subscriptions\n\ninterface TradingView {\n    sellEnergyOrb(rarity: string): boolean;\n    purchaseLaserTurret(): void;\n}\n\nexport class EventHandlers {\n    private tradingView: TradingView | null;\n    private isMobile: boolean;\n    \n    constructor() {\n        this.tradingView = null;\n        this.isMobile = false;\n    }\n    \n    setTradingView(tradingView: TradingView): void {\n        this.tradingView = tradingView;\n    }\n    \n    setMobile(isMobile: boolean): void {\n        this.isMobile = isMobile;\n    }\n    \n    setupOrbSellHandlers(updateUICallback: () => void): void {\n        // Energy orb sell handlers\n        const sellOrbCommon = document.getElementById('sell-orb-common');\n        if (sellOrbCommon) {\n            sellOrbCommon.addEventListener('click', () => {\n                if (this.tradingView && this.tradingView.sellEnergyOrb('common')) {\n                    updateUICallback();\n                }\n            });\n        }\n        \n        const sellOrbUncommon = document.getElementById('sell-orb-uncommon');\n        if (sellOrbUncommon) {\n            sellOrbUncommon.addEventListener('click', () => {\n                if (this.tradingView && this.tradingView.sellEnergyOrb('uncommon')) {\n                    updateUICallback();\n                }\n            });\n        }\n        \n        const sellOrbRare = document.getElementById('sell-orb-rare');\n        if (sellOrbRare) {\n            sellOrbRare.addEventListener('click', () => {\n                if (this.tradingView && this.tradingView.sellEnergyOrb('rare')) {\n                    updateUICallback();\n                }\n            });\n        }\n        \n        const sellOrbEpic = document.getElementById('sell-orb-epic');\n        if (sellOrbEpic) {\n            sellOrbEpic.addEventListener('click', () => {\n                if (this.tradingView && this.tradingView.sellEnergyOrb('epic')) {\n                    updateUICallback();\n                }\n            });\n        }\n        \n        const sellOrbLegendary = document.getElementById('sell-orb-legendary');\n        if (sellOrbLegendary) {\n            sellOrbLegendary.addEventListener('click', () => {\n                if (this.tradingView && this.tradingView.sellEnergyOrb('legendary')) {\n                    updateUICallback();\n                }\n            });\n        }\n    }\n    \n    setupLaserPurchaseHandler(updateUICallback: () => void): void {\n        // Add handler for purchasing laser turrets\n        const purchaseLaserBtn = document.getElementById('purchase-laser');\n        if (purchaseLaserBtn) {\n            purchaseLaserBtn.addEventListener('click', () => {\n                if (this.tradingView) {\n                    this.tradingView.purchaseLaserTurret();\n                    updateUICallback();\n                }\n            });\n        }\n    }\n    \n    // Add a new method for setting up touch events\n    setupTouchEvents(): void {\n        if (!this.isMobile) return;\n        \n        const stargateUI = document.getElementById('stargate-ui');\n        if (!stargateUI) return;\n        \n        console.log(\"Setting up touch events for stargate UI\");\n        \n        // Make sure the undock button has proper touch handling\n        const undockBtn = document.getElementById('undock-btn');\n        if (undockBtn) {\n            undockBtn.style.touchAction = 'manipulation';\n            (undockBtn.style as any).webkitTapHighlightColor = 'transparent';\n            undockBtn.style.position = 'relative';\n            undockBtn.style.zIndex = '9999';\n            \n            // Ensure proper touch handling\n            undockBtn.addEventListener('touchstart', (e: TouchEvent) => {\n                console.log(\"Touch start on undock button\");\n                // Change appearance to show it's being touched\n                undockBtn.style.backgroundColor = '#1b88db';\n                undockBtn.style.transform = 'scale(0.98)';\n                // Prevent any default behavior that might interfere\n                e.stopPropagation();\n            }, { passive: false });\n            \n            undockBtn.addEventListener('touchend', (e: TouchEvent) => {\n                console.log(\"Touch end on undock button\");\n                // Reset appearance\n                undockBtn.style.backgroundColor = '#33aaff';\n                undockBtn.style.transform = 'scale(1)';\n                // Prevent any default behavior that might interfere\n                e.stopPropagation();\n            }, { passive: false });\n        }\n        \n        // Prevent default touchmove on body but allow scrolling within the stargate UI\n        stargateUI.addEventListener('touchmove', (e: TouchEvent) => {\n            // Allow the default scroll behavior within the stargate UI\n            e.stopPropagation();\n        }, { passive: true });\n        \n        // Fix for iOS scrolling issues - only prevent at the top, not at the bottom\n        stargateUI.addEventListener('touchstart', (e: TouchEvent) => {\n            // Only prevent pull-to-refresh at the top, don't interfere with bottom scrolling\n            const scrollTop = stargateUI.scrollTop;\n            \n            if (scrollTop <= 0 && e.touches[0].screenY < e.touches[0].clientY) {\n                e.preventDefault();\n            }\n            // Removed condition that was preventing scrolling at the bottom\n        }, { passive: false });\n        \n        // Handle tabbed content for better touch experience\n        const tabButtons = stargateUI.querySelectorAll('.tablinks');\n        if (tabButtons.length > 0) {\n            tabButtons.forEach(button => {\n                button.addEventListener('touchend', ((e: TouchEvent) => {\n                    // Prevent rapid multiple touches\n                    e.preventDefault();\n\n                    // Simulate a click event\n                    (button as HTMLElement).click();\n                }) as EventListener);\n            });\n        }\n        \n        // Improve touch experience for all buttons in the stargate UI\n        const allButtons = stargateUI.querySelectorAll('button');\n        allButtons.forEach(button => {\n            if (button !== undockBtn) { // We already handled the undock button specially\n                button.style.touchAction = 'manipulation';\n                (button.style as any).webkitTapHighlightColor = 'transparent';\n                \n                // Provide visual feedback on touch\n                button.addEventListener('touchstart', () => {\n                    button.style.transform = 'scale(0.98)';\n                }, { passive: true });\n                \n                button.addEventListener('touchend', () => {\n                    button.style.transform = 'scale(1)';\n                }, { passive: true });\n            }\n        });\n    }\n}\n","// helpers.ts - Utility functions and common operations\n\ninterface Resources {\n    iron: number;\n    gold: number;\n    platinum: number;\n    orbs?: {\n        common: number;\n        uncommon: number;\n        rare: number;\n        epic: number;\n        legendary: number;\n    };\n}\n\ninterface Spaceship {\n    credits: number;\n    fuel: number;\n    maxFuel: number;\n    shield: number;\n    maxShield: number;\n    hull: number;\n    maxHull: number;\n}\n\ninterface GameSyncResult {\n    spaceship: Spaceship;\n    resources: Resources;\n}\n\nexport class StargateHelpers {\n    static updateResourceDisplays(resources: Resources): void {\n        // Update resource display with visual elements\n        const ironEl = document.getElementById('ms-iron');\n        const goldEl = document.getElementById('ms-gold');\n        const platinumEl = document.getElementById('ms-platinum');\n        \n        if (ironEl) ironEl.textContent = String(resources.iron);\n        if (goldEl) goldEl.textContent = String(resources.gold);\n        if (platinumEl) platinumEl.textContent = String(resources.platinum);\n    }\n    \n    static updateCreditsDisplay(spaceship: Spaceship): void {\n        // Update credits with styling\n        const creditsEl = document.getElementById('ms-credits');\n        if (creditsEl) {\n            creditsEl.textContent = `${spaceship.credits} CR`;\n        }\n    }\n    \n    static updateStatusGauges(spaceship: Spaceship): void {\n        // Update fuel gauge\n        const fuelGauge = document.getElementById('fuel-gauge');\n        const fuelLevel = document.getElementById('fuel-level');\n        if (fuelGauge) {\n            fuelGauge.style.width = `${(spaceship.fuel / spaceship.maxFuel) * 100}%`;\n        }\n        if (fuelLevel) {\n            fuelLevel.textContent = String(Math.round((spaceship.fuel / spaceship.maxFuel) * 100));\n        }\n        \n        // Update shield gauge\n        const shieldGauge = document.getElementById('shield-gauge');\n        const shieldLevel = document.getElementById('shield-level');\n        if (shieldGauge) {\n            shieldGauge.style.width = `${(spaceship.shield / spaceship.maxShield) * 100}%`;\n        }\n        if (shieldLevel) {\n            shieldLevel.textContent = String(Math.round((spaceship.shield / spaceship.maxShield) * 100));\n        }\n        \n        // Update hull gauge\n        const hullGauge = document.getElementById('hull-gauge');\n        const hullLevel = document.getElementById('hull-level');\n        if (hullGauge) {\n            hullGauge.style.width = `${(spaceship.hull / spaceship.maxHull) * 100}%`;\n        }\n        if (hullLevel) {\n            hullLevel.textContent = String(Math.round((spaceship.hull / spaceship.maxHull) * 100));\n        }\n    }\n    \n    static updateServiceButtons(spaceship: Spaceship): void {\n        // Disable refuel button if not enough credits or fuel is full\n        const refuelBtn = document.getElementById('refuel-btn') as HTMLButtonElement;\n        if (refuelBtn) {\n            if (spaceship.credits < 100 || spaceship.fuel >= spaceship.maxFuel * 0.999) {\n                refuelBtn.disabled = true;\n                refuelBtn.style.backgroundColor = '#555';\n                refuelBtn.style.cursor = 'not-allowed';\n            } else {\n                refuelBtn.disabled = false;\n                refuelBtn.style.backgroundColor = '#00cc33';\n                refuelBtn.style.cursor = 'pointer';\n            }\n        }\n        \n        // Disable shield repair button if not enough credits or shield is full\n        const repairShieldBtn = document.getElementById('repair-shield-btn') as HTMLButtonElement;\n        if (repairShieldBtn) {\n            if (spaceship.credits < 150 || spaceship.shield >= spaceship.maxShield * 0.999) {\n                repairShieldBtn.disabled = true;\n                repairShieldBtn.style.backgroundColor = '#555';\n                repairShieldBtn.style.cursor = 'not-allowed';\n            } else {\n                repairShieldBtn.disabled = false;\n                repairShieldBtn.style.backgroundColor = '#3399ff';\n                repairShieldBtn.style.cursor = 'pointer';\n            }\n        }\n        \n        // Disable hull repair button if not enough credits or hull is full\n        const repairHullBtn = document.getElementById('repair-hull-btn') as HTMLButtonElement;\n        if (repairHullBtn) {\n            if (spaceship.credits < 200 || spaceship.hull >= spaceship.maxHull * 0.999) {\n                repairHullBtn.disabled = true;\n                repairHullBtn.style.backgroundColor = '#555';\n                repairHullBtn.style.cursor = 'not-allowed';\n            } else {\n                repairHullBtn.disabled = false;\n                repairHullBtn.style.backgroundColor = '#ff9900';\n                repairHullBtn.style.cursor = 'pointer';\n            }\n        }\n    }\n    \n    static configureMobileUI(stargateUI: HTMLElement, isMobile: boolean): void {\n        if (!isMobile) return;\n        \n        // Ensure proper mobile styling\n        stargateUI.style.width = '92%';\n        stargateUI.style.maxWidth = '92vw';\n        stargateUI.style.maxHeight = '85vh';\n        (stargateUI.style as any).webkitOverflowScrolling = 'touch';\n        stargateUI.style.touchAction = 'pan-y';\n        stargateUI.style.overscrollBehavior = 'auto';\n        \n        // Ensure proper positioning\n        stargateUI.style.position = 'absolute';\n        stargateUI.style.top = '50%';\n        stargateUI.style.left = '50%';\n        stargateUI.style.transform = 'translate(-50%, -50%)';\n        stargateUI.style.zIndex = '1000';\n        \n        // Ensure body is in a state that allows the UI to be visible\n        document.body.classList.remove('undocking', 'modal-open');\n    }\n    \n    static syncWithGameResources(): GameSyncResult | null {\n        // Sync resources with game if available (similar to BlackjackGame)\n        if (window.game && (window.game as any).controls) {\n            // Get reference to spaceship and resources\n            const spaceship = (window.game as any).spaceship;\n            const resources = (window.game as any).controls.resources;\n            \n            // Return references for use by caller\n            if (spaceship && resources) {\n                console.log(\"Syncing stargate UI with game resources:\", resources);\n                return { spaceship, resources };\n            }\n        }\n        return null;\n    }\n}\n","// stargateInterface.js - Handles the stargate docking and trading UI\n\nimport { MobileDetector } from '../../utils/mobileDetector.ts';\nimport { TerminalView } from './components/stargate/terminalView.js';\nimport { SystemsView } from './components/stargate/systemsView.js';\nimport { TradingView } from './components/stargate/tradingView.js';\nimport { UpgradesView } from './components/stargate/upgrades.js';\nimport { MissionsView } from './components/stargate/missions.js';\nimport { EventHandlers } from './components/stargate/eventHandlers.js';\nimport { StargateHelpers } from './components/stargate/helpers.js';\n\ntype StargateStarMap = any;\n\ntype StargateBlackjackGame = any;\n\ntype StargateSettings = any;\n\ntype StargateSpaceship = any;\n\ntype StargateResources = any;\n\nexport class StargateInterface {\n    starMap: StargateStarMap | null;\n    blackjackGame: StargateBlackjackGame | null;\n    settings: StargateSettings | null;\n    isMobile: boolean;\n    terminalView: TerminalView;\n    systemsView: SystemsView;\n    tradingView: TradingView;\n    upgradesView: UpgradesView;\n    missionsView: MissionsView;\n    eventHandlers: EventHandlers;\n\n    constructor() {\n        this.starMap = null;\n        this.blackjackGame = null;\n        this.settings = null;\n        this.isMobile = MobileDetector.isMobile();\n        \n        // Initialize submodules\n        this.terminalView = new TerminalView();\n        this.systemsView = new SystemsView();\n        this.tradingView = new TradingView();\n        this.upgradesView = new UpgradesView();\n        this.missionsView = new MissionsView();\n        this.eventHandlers = new EventHandlers();\n        \n        // Configure mobile settings\n        this.terminalView.setMobile(this.isMobile);\n        this.eventHandlers.setMobile(this.isMobile);\n        this.eventHandlers.setTradingView(this.tradingView);\n        this.missionsView.setHideCallback(() => this.hideStargateUI());\n        \n        this.setupStargateUI();\n        this.setupEventHandlers();\n    }\n    \n    setStarMap(starMap: StargateStarMap): void {\n        this.starMap = starMap;\n        this.systemsView.setStarMap(starMap as unknown as never);\n    }\n    \n    setBlackjackGame(blackjackGame: StargateBlackjackGame): void {\n        this.blackjackGame = blackjackGame;\n        this.systemsView.setBlackjackGame(blackjackGame as unknown as never);\n    }\n    \n    setSettings(settings: StargateSettings): void {\n        this.settings = settings;\n        this.systemsView.setSettings(settings as unknown as never);\n        \n        // Pass the stargate interface reference to settings\n        if (this.settings) {\n            this.settings.setStargateInterface(this);\n        }\n    }\n    \n    setupStargateUI(): void {\n        // Create and inject styles\n        this.terminalView.createStyles();\n        \n        // Create docking prompt\n        this.terminalView.createDockingPrompt();\n        \n        // Create main UI container\n        const stargateUI = this.terminalView.createMainUI() as unknown as HTMLDivElement;\n        stargateUI.innerHTML = this.terminalView.getMainUIContent();\n        \n        document.body.appendChild(stargateUI);\n    }\n    \n    showDockingPrompt(): void {\n        this.terminalView.showDockingPrompt();\n    }\n    \n    hideDockingPrompt(): void {\n        this.terminalView.hideDockingPrompt();\n    }\n    \n    showStargateUI(): void {\n        const stargateUI = document.getElementById('stargate-ui') as HTMLDivElement | null;\n        if (stargateUI) {\n            console.log(\"Showing stargate UI on \" + (this.isMobile ? \"mobile\" : \"desktop\"));\n            stargateUI.style.display = 'block';\n            stargateUI.style.backgroundColor = 'rgba(20, 30, 50, 0.9)';\n            \n            // Mobile-specific adjustments\n            if (this.isMobile) {\n                StargateHelpers.configureMobileUI(stargateUI, this.isMobile);\n            }\n        }\n        \n        this.hideDockingPrompt();\n        this.systemsView.setupAllSystemButtons();\n        \n        if (this.isMobile) {\n            this.eventHandlers.setupTouchEvents();\n        }\n        \n        // Sync resources with game\n        const gameData = StargateHelpers.syncWithGameResources();\n        if (gameData) {\n            this.updateStargateUI(gameData.spaceship, gameData.resources);\n        }\n    }\n    \n    hideStargateUI(): void {\n        const stargateUI = document.getElementById('stargate-ui') as HTMLDivElement | null;\n        if (stargateUI) {\n            stargateUI.style.display = 'none';\n        }\n    }\n\n    // Add alias for compatibility\n    hide(): void {\n        this.hideStargateUI();\n    }\n    \n    updateStargateUI(spaceship: StargateSpaceship, resources: StargateResources): void {\n        // Set references in submodules\n        this.tradingView.setGameReferences(spaceship as any, resources as any);\n        this.upgradesView.setSpaceship(spaceship as any);\n        \n        // Update displays using submodules\n        StargateHelpers.updateResourceDisplays(resources as any);\n        StargateHelpers.updateCreditsDisplay(spaceship as any);\n        StargateHelpers.updateStatusGauges(spaceship as any);\n        StargateHelpers.updateServiceButtons(spaceship as any);\n        \n        this.upgradesView.updateUpgradeDisplays();\n        this.tradingView.updateResourceSellButtons();\n        this.tradingView.updateOrbCounts();\n        this.tradingView.updateOrbSellButtons();\n        this.tradingView.updateLaserTurretDisplay();\n    }\n    setupEventHandlers(): void {\n        const updateUICallback = () => {\n            const gameData = StargateHelpers.syncWithGameResources();\n            if (gameData) {\n                this.updateStargateUI(gameData.spaceship, gameData.resources);\n            }\n        };\n        \n        // Setup orb selling handlers\n        this.eventHandlers.setupOrbSellHandlers(updateUICallback);\n        \n        // Setup laser purchase handler\n        this.eventHandlers.setupLaserPurchaseHandler(updateUICallback);\n        \n        // Setup horde mode button\n        this.missionsView.setupHordeButton();\n    }\n}\n"],"names":["TerminalScreen","__publicField","isMobile","dockingPrompt","stargateUI","resource","value","element","barId","percentage","bar","credits","rarity","count","upgradeType","level","progressBar","cost","ui","TerminalEffects","style","color","intensity","hex","result","type","glowClasses","CommandParser","input","trimmed","parts","rawCommand","_a","command","args","tokens","current","inQuotes","quoteChar","i","char","partial","cmd","CommandHandlers","stargateInterface","parsedCommand","now","error","helpTopics","topic","item","system","TerminalMessages","orb","upgrade","buttonColor","TerminalKeyboard","event","pressed","functionNumber","character","text","callback","handlers","index","data","handler","TerminalView","parsed","action","target","message","SystemsView","starMap","blackjackGame","settings","starMapButton","blackjackButton","settingsButton","customSystemBtn","TradingView","spaceship","resources","orbCount","capitalizedRarity","mainMessageBus","notification","commonCount","uncommonCount","rareCount","epicCount","legendaryCount","updateOrbSellButton","buttonId","borderColor","button","laserCountElement","purchaseLaserBtn","sellIron","sellGold","sellPlatinum","btn","resourceAmount","r","g","b","UpgradesView","currentFuelLevel","currentFuelCapacity","nextFuelCapacity","fuelUpgradeCost","fuelUpgradeProgress","currentEngineLevel","currentMaxVelocity","nextMaxVelocity","engineUpgradeCost","engineUpgradeProgress","currentMiningLevel","currentMiningEfficiency","nextMiningEfficiency","miningUpgradeCost","miningUpgradeProgress","currentHullLevel","currentHullResistance","nextHullResistance","hullUpgradeCost","hullUpgradeProgress","currentScannerLevel","currentScannerRange","nextScannerRange","scannerUpgradeCost","scannerUpgradeProgress","currentCredits","activeColor","MissionsView","hordeButton","modal","content","title","buttons","yesBtn","noBtn","EventHandlers","tradingView","updateUICallback","sellOrbCommon","sellOrbUncommon","sellOrbRare","sellOrbEpic","sellOrbLegendary","undockBtn","e","tabButtons","StargateHelpers","ironEl","goldEl","platinumEl","creditsEl","fuelGauge","fuelLevel","shieldGauge","shieldLevel","hullGauge","hullLevel","refuelBtn","repairShieldBtn","repairHullBtn","StargateInterface","MobileDetector","gameData"],"mappings":"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"}