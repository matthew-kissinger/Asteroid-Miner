var m=Object.defineProperty;var y=(l,e,t)=>e in l?m(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var r=(l,e,t)=>y(l,typeof e!="symbol"?e+"":e,t);import{c as b}from"./game-core-OtPnLuF2.js";import"./three-DBvJLP14.js";class f{constructor(e=!1){r(this,"isMobile");this.isMobile=e}getGameUIStyles(){return{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:this.isMobile?"95%":"900px",maxWidth:this.isMobile?"600px":"none",height:this.isMobile?"auto":"650px",maxHeight:this.isMobile?"85vh":"none",backgroundColor:"rgba(6, 22, 31, 0.85)",backdropFilter:"blur(10px)",border:"2px solid #33aaff",borderRadius:"15px",boxShadow:"0 0 30px rgba(51, 170, 255, 0.5)",padding:this.isMobile?"15px":"25px",zIndex:"1000",display:"none",fontFamily:"Courier New, monospace",color:"#fff",userSelect:"none",overflowY:this.isMobile?"auto":"hidden"}}getMobileStyles(){return this.isMobile?{webkitOverflowScrolling:"touch",touchAction:"pan-y",overscrollBehavior:"contain"}:{}}getScanlineStyles(){return{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",backgroundImage:"linear-gradient(transparent 50%, rgba(0, 0, 0, 0.1) 50%)",backgroundSize:"100% 4px",pointerEvents:"none",zIndex:"1001",opacity:"0.15"}}getHeaderStyles(){return{textAlign:"center",marginBottom:"20px",position:"relative"}}getTitleStyles(){return{color:"#30cfd0",textShadow:"0 0 10px rgba(48, 207, 208, 0.7)",margin:"0 0 5px 0",fontSize:this.isMobile?"24px":"32px"}}getSubtitleStyles(){return{color:"rgba(255, 255, 255, 0.6)",fontSize:this.isMobile?"12px":"14px",letterSpacing:"2px"}}getCloseButtonStyles(){const e={position:"absolute",top:"0",right:"0",backgroundColor:"transparent",border:"none",color:"#33aaff",fontSize:"32px",cursor:"pointer",outline:"none",padding:"0 10px",lineHeight:"1"};return this.isMobile?{...e,fontSize:"42px",padding:"5px 15px",backgroundColor:"rgba(0, 0, 0, 0.3)",borderRadius:"50%",width:"50px",height:"50px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 0 10px rgba(51, 170, 255, 0.5)",right:"5px",top:"5px"}:e}getGameAreaStyles(){return{display:"flex",flexDirection:"column",height:this.isMobile?"auto":"calc(100% - 80px)"}}getPlayerAreaStyles(){return{flex:"1",border:"1px solid rgba(51, 170, 255, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"15px",background:"linear-gradient(to bottom, rgba(9, 30, 42, 0.4), rgba(9, 30, 42, 0.6))"}}getDealerAreaStyles(){return{...this.getPlayerAreaStyles(),background:"linear-gradient(to bottom, rgba(9, 30, 42, 0.6), rgba(9, 30, 42, 0.4))"}}getAreaHeaderStyles(){return{display:"flex",justifyContent:"space-between",marginBottom:"10px"}}getDealerTitleStyles(){return{color:"#33aaff",fontWeight:"bold"}}getPlayerTitleStyles(){return{color:"#30cfd0",fontWeight:"bold"}}getScoreStyles(e=!1){return{color:"#fff",fontWeight:"bold",backgroundColor:e?"rgba(48, 207, 208, 0.2)":"rgba(51, 170, 255, 0.2)",padding:"0 10px",borderRadius:"4px"}}getCardsContainerStyles(){return{display:"flex",gap:"15px",flexWrap:"wrap",height:this.isMobile?"auto":"130px",minHeight:this.isMobile?"120px":"130px"}}getCardStyles(e=!1){return{width:this.isMobile?"70px":"100px",height:this.isMobile?"105px":"150px",fontSize:this.isMobile?"80%":"100%",backgroundColor:e?"rgba(9, 30, 42, 0.8)":"rgba(15, 35, 50, 0.9)",border:e?"2px solid rgba(51, 170, 255, 0.3)":"2px solid rgba(51, 170, 255, 0.7)",borderRadius:"10px",boxShadow:e?"0 0 5px rgba(51, 170, 255, 0.3)":"0 0 10px rgba(51, 170, 255, 0.5)",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",transition:"transform 0.3s ease"}}getCardValueStyles(e="top"){const t={position:"absolute",fontSize:this.isMobile?"14px":"20px",fontWeight:"bold"};return e==="top"?{...t,top:"8px",left:"8px"}:{...t,bottom:"8px",right:"8px",transform:"rotate(180deg)"}}getCardSuitStyles(e="top"){const t={position:"absolute",fontSize:this.isMobile?"12px":"16px"};return e==="top"?{...t,top:"8px",right:"8px"}:{...t,bottom:"8px",left:"8px",transform:"rotate(180deg)"}}getCenterSymbolStyles(){return{fontSize:this.isMobile?"28px":"40px",lineHeight:"1",opacity:"0.9"}}getCardColor(e){return["hearts","diamonds"].includes(e)?"#e55c8a":"#30cfd0"}getSpeechBubbleStyles(){return{position:this.isMobile?"relative":"absolute",bottom:this.isMobile?"auto":"15px",right:this.isMobile?"auto":"15px",marginTop:this.isMobile?"10px":"0",backgroundColor:"rgba(15, 40, 55, 0.9)",border:"1px solid #33aaff",borderRadius:"8px",padding:"10px 15px",maxWidth:this.isMobile?"100%":"300px",fontStyle:"italic",color:"#fff",boxShadow:"0 0 10px rgba(51, 170, 255, 0.3)",display:"none"}}getStatusAreaStyles(){return{height:"60px",display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"15px"}}getGameStatusStyles(){return{padding:"8px 20px",borderRadius:"20px",backgroundColor:"rgba(51, 170, 255, 0.2)",border:"1px solid rgba(51, 170, 255, 0.4)",color:"#fff",textAlign:"center",fontWeight:"bold",letterSpacing:"1px",fontSize:this.isMobile?"12px":"14px",width:this.isMobile?"100%":"auto"}}getControlsAreaStyles(){return{display:"flex",justifyContent:"space-between",alignItems:"center",height:"auto",flexDirection:this.isMobile?"column":"row",gap:this.isMobile?"15px":"0"}}getBettingControlsStyles(){return{display:"flex",flexDirection:"column",width:this.isMobile?"100%":"250px"}}getBettingTitleStyles(){return{marginBottom:"10px",color:"rgba(255, 255, 255, 0.8)",fontWeight:"bold"}}getResourceOptionsStyles(){return{display:"flex",gap:"10px"}}getResourceButtonStyles(e){return{flex:"1",padding:this.isMobile?"10px 5px":"8px 5px",backgroundColor:"rgba(15, 40, 55, 0.8)",border:`1px solid ${e}`,borderRadius:"5px",color:"#fff",boxShadow:`0 0 10px rgba(${e.split("(")[1].split(")")[0]}, 0.3)`,cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",transition:"background-color 0.2s, box-shadow 0.2s"}}getResourceButtonHoverStyles(e){return{backgroundColor:"rgba(25, 60, 80, 0.8)",boxShadow:`0 0 15px ${e}`}}getBetAmountControlsStyles(){return{display:"flex",marginTop:"10px",gap:"10px"}}getBetAmountDisplayStyles(){return{flex:"1",backgroundColor:"rgba(15, 40, 55, 0.8)",border:"1px solid rgba(51, 170, 255, 0.5)",borderRadius:"5px",padding:"8px 10px",textAlign:"center",fontWeight:"bold"}}getControlButtonStyles(){return{width:this.isMobile?"50px":"40px",height:this.isMobile?"40px":"auto",backgroundColor:"rgba(15, 40, 55, 0.8)",border:"1px solid rgba(51, 170, 255, 0.5)",borderRadius:"5px",color:"#fff",cursor:"pointer",fontSize:this.isMobile?"20px":"16px"}}getControlButtonHoverStyles(){return{backgroundColor:"rgba(25, 60, 80, 0.8)",boxShadow:"0 0 10px rgba(51, 170, 255, 0.3)"}}getGameActionsStyles(){return{display:"flex",gap:"15px",flexWrap:this.isMobile?"wrap":"nowrap",justifyContent:this.isMobile?"center":"flex-end",width:this.isMobile?"100%":"auto"}}getActionButtonStyles(e){return{padding:this.isMobile?"15px 20px":"12px 18px",backgroundColor:"rgba(15, 40, 55, 0.8)",border:`2px solid ${e}`,borderRadius:"5px",color:"#fff",fontWeight:"bold",cursor:"pointer",boxShadow:`0 0 10px ${e}`,transition:"all 0.2s",minWidth:this.isMobile?"80px":"auto",flex:this.isMobile?"1":"none"}}getActionButtonHoverStyles(e){return{backgroundColor:"rgba(25, 60, 80, 0.8)",boxShadow:`0 0 15px ${e}`}}applyStyles(e,t){Object.assign(e.style,t)}}class S{constructor(e=!1){r(this,"isMobile");r(this,"styles");r(this,"cardSymbols");this.isMobile=e,this.styles=new f(e),this.cardSymbols={spades:"♠",hearts:"♥",clubs:"♣",diamonds:"♦"}}createGameUI(){const e=document.createElement("div");e.id="blackjack-game",this.styles.applyStyles(e,this.styles.getGameUIStyles()),this.styles.applyStyles(e,this.styles.getMobileStyles());const t=document.createElement("div");this.styles.applyStyles(t,this.styles.getScanlineStyles()),e.appendChild(t);const s=this.createHeader();e.appendChild(s);const a=this.createGameArea();return e.appendChild(a),document.body.appendChild(e),e}createHeader(){const e=document.createElement("div");this.styles.applyStyles(e,this.styles.getHeaderStyles());const t=document.createElement("h2");t.textContent="STELLAR BLACKJACK",this.styles.applyStyles(t,this.styles.getTitleStyles()),e.appendChild(t);const s=document.createElement("div");s.textContent="WAGER RESOURCES • WIN BIG • BEAT THE DEALER",this.styles.applyStyles(s,this.styles.getSubtitleStyles()),e.appendChild(s);const a=this.createCloseButton();return e.appendChild(a),e}createCloseButton(){const e=document.createElement("button");return e.textContent="×",this.styles.applyStyles(e,this.styles.getCloseButtonStyles()),e}createGameArea(){const e=document.createElement("div");this.styles.applyStyles(e,this.styles.getGameAreaStyles());const t=this.createDealerArea();e.appendChild(t);const s=this.createStatusArea();e.appendChild(s);const a=this.createPlayerArea();e.appendChild(a);const i=this.createControlsArea();return e.appendChild(i),e}createDealerArea(){const e=document.createElement("div");this.styles.applyStyles(e,this.styles.getDealerAreaStyles());const t=this.createAreaHeader("DEALER","dealer-score",!1);e.appendChild(t);const s=document.createElement("div");s.id="dealer-cards",this.styles.applyStyles(s,this.styles.getCardsContainerStyles()),e.appendChild(s);const a=document.createElement("div");return a.id="dealer-speech",this.styles.applyStyles(a,this.styles.getSpeechBubbleStyles()),e.appendChild(a),e}createPlayerArea(){const e=document.createElement("div");this.styles.applyStyles(e,this.styles.getPlayerAreaStyles());const t=this.createAreaHeader("YOUR HAND","player-score",!0);e.appendChild(t);const s=document.createElement("div");return s.id="player-cards",this.styles.applyStyles(s,this.styles.getCardsContainerStyles()),e.appendChild(s),e}createAreaHeader(e,t,s){const a=document.createElement("div");a.className=s?"player-header":"dealer-header",this.styles.applyStyles(a,this.styles.getAreaHeaderStyles());const i=document.createElement("div");i.textContent=e,this.styles.applyStyles(i,s?this.styles.getPlayerTitleStyles():this.styles.getDealerTitleStyles()),a.appendChild(i);const o=document.createElement("div");return o.id=t,o.textContent="0",this.styles.applyStyles(o,this.styles.getScoreStyles(s)),a.appendChild(o),a}createStatusArea(){const e=document.createElement("div");this.styles.applyStyles(e,this.styles.getStatusAreaStyles());const t=document.createElement("div");return t.id="game-status",t.textContent="PLACE YOUR BET TO BEGIN",this.styles.applyStyles(t,this.styles.getGameStatusStyles()),e.appendChild(t),e}createControlsArea(){const e=document.createElement("div");this.styles.applyStyles(e,this.styles.getControlsAreaStyles());const t=this.createBettingControls();e.appendChild(t);const s=this.createGameActions();return e.appendChild(s),e}createBettingControls(){const e=document.createElement("div");e.id="betting-controls",this.styles.applyStyles(e,this.styles.getBettingControlsStyles());const t=document.createElement("div");t.textContent="PLACE YOUR BET",this.styles.applyStyles(t,this.styles.getBettingTitleStyles()),e.appendChild(t);const s=this.createResourceOptions();e.appendChild(s);const a=this.createBetAmountControls();return e.appendChild(a),e}createResourceOptions(){const e=document.createElement("div");return this.styles.applyStyles(e,this.styles.getResourceOptionsStyles()),[{name:"iron",color:"rgba(150, 150, 150, 1)"},{name:"gold",color:"rgba(255, 215, 0, 1)"},{name:"platinum",color:"rgba(229, 228, 226, 1)"}].forEach(s=>{const a=this.createResourceButton(s.name,s.color);e.appendChild(a)}),e}createResourceButton(e,t){const s=document.createElement("button");s.className="resource-btn",s.dataset.resource=e,this.styles.applyStyles(s,this.styles.getResourceButtonStyles(t));const a=document.createElement("span");a.textContent=e.toUpperCase(),a.style.fontWeight="bold",a.style.fontSize="12px",s.appendChild(a);const i=document.createElement("span");return i.className=`${e}-amount`,i.textContent="0 UNITS",i.style.fontSize="10px",i.style.marginTop="3px",i.style.opacity="0.7",s.appendChild(i),s}createBetAmountControls(){const e=document.createElement("div");this.styles.applyStyles(e,this.styles.getBetAmountControlsStyles());const t=document.createElement("div");t.id="bet-amount",t.textContent="0",this.styles.applyStyles(t,this.styles.getBetAmountDisplayStyles()),e.appendChild(t);const s=document.createElement("button");s.textContent="-",s.id="decrease-bet-btn",this.styles.applyStyles(s,this.styles.getControlButtonStyles()),e.appendChild(s);const a=document.createElement("button");return a.textContent="+",a.id="increase-bet-btn",this.styles.applyStyles(a,this.styles.getControlButtonStyles()),e.appendChild(a),e}createGameActions(){const e=document.createElement("div");return this.styles.applyStyles(e,this.styles.getGameActionsStyles()),[{id:"deal-btn",text:"DEAL",color:"#30cfd0"},{id:"hit-btn",text:"HIT",color:"#ff9e3d"},{id:"stand-btn",text:"STAND",color:"#e55c8a"},{id:"double-btn",text:"DOUBLE",color:"#a281ff"}].forEach(s=>{const a=this.createActionButton(s.id,s.text,s.color);e.appendChild(a)}),e}createActionButton(e,t,s){const a=document.createElement("button");return a.id=e,a.textContent=t,this.styles.applyStyles(a,this.styles.getActionButtonStyles(s)),a.disabled=!0,a.style.opacity="0.5",a}createCardElement(e,t=!1){const s=document.createElement("div");return s.className="card",this.styles.applyStyles(s,this.styles.getCardStyles(t)),t?this.createFaceDownCard(s):this.createFaceUpCard(s,e),s}createFaceUpCard(e,t){const s=this.styles.getCardColor(t.suit),a=document.createElement("div");a.textContent=t.value,a.style.color=s,this.styles.applyStyles(a,this.styles.getCardValueStyles("top")),e.appendChild(a);const i=document.createElement("div");i.textContent=this.cardSymbols[t.suit],i.style.color=s,this.styles.applyStyles(i,this.styles.getCardSuitStyles("top")),e.appendChild(i);const o=document.createElement("div");o.textContent=this.cardSymbols[t.suit],o.style.color=s,this.styles.applyStyles(o,this.styles.getCenterSymbolStyles()),e.appendChild(o);const n=document.createElement("div");n.textContent=t.value,n.style.color=s,this.styles.applyStyles(n,this.styles.getCardValueStyles("bottom")),e.appendChild(n);const h=document.createElement("div");h.textContent=this.cardSymbols[t.suit],h.style.color=s,this.styles.applyStyles(h,this.styles.getCardSuitStyles("bottom")),e.appendChild(h);const c=document.createElement("div");c.style.position="absolute",c.style.inset="0",c.style.opacity="0.05",c.style.backgroundImage="radial-gradient(circle, #fff 1px, transparent 1px)",c.style.backgroundSize="10px 10px",c.style.pointerEvents="none",e.appendChild(c);const d=document.createElement("div");d.style.position="absolute",d.style.inset="0",d.style.background="linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 50%, rgba(255,255,255,0.1) 100%)",d.style.pointerEvents="none",e.appendChild(d)}createFaceDownCard(e){const t=document.createElement("div");t.style.width="80%",t.style.height="80%",t.style.border="2px solid rgba(51, 170, 255, 0.4)",t.style.borderRadius="5px",t.style.backgroundImage="radial-gradient(circle, rgba(51, 170, 255, 0.2) 10%, transparent 10%)",t.style.backgroundSize="10px 10px",e.appendChild(t);const s=document.createElement("div");s.style.position="absolute",s.style.fontWeight="bold",s.style.fontSize=this.isMobile?"12px":"14px",s.style.color="rgba(51, 170, 255, 0.7)",s.textContent="BJ",e.appendChild(s)}show(e){e&&(e.style.display="block")}hide(e){e&&(e.style.display="none")}updateResourceDisplay(e){if(e&&e.cargo){e.cargo.iron===void 0&&(e.cargo.iron=0),e.cargo.gold===void 0&&(e.cargo.gold=0),e.cargo.platinum===void 0&&(e.cargo.platinum=0);const t=document.querySelector(".iron-amount");t&&(t.textContent=`${e.cargo.iron} UNITS`);const s=document.querySelector(".gold-amount");s&&(s.textContent=`${e.cargo.gold} UNITS`);const a=document.querySelector(".platinum-amount");a&&(a.textContent=`${e.cargo.platinum} UNITS`)}}updateScore(e,t=!0){const s=document.getElementById(t?"player-score":"dealer-score");s&&(s.textContent=String(e))}updateGameStatus(e){const t=document.getElementById("game-status");t&&(t.textContent=e)}updateBetAmount(e){const t=document.getElementById("bet-amount");t&&(t.textContent=String(e))}clearCards(e=!0){const t=document.getElementById(e?"player-cards":"dealer-cards");t&&(t.innerHTML="")}addCard(e,t=!1,s=!0){const a=document.getElementById(s?"player-cards":"dealer-cards");if(a){const i=this.createCardElement(e,t);return t&&(i.id="face-down-card"),a.appendChild(i),setTimeout(()=>{i.style.transform="translateY(-5px)"},50),i}return null}showDealerSpeech(e,t=4e3){const s=document.getElementById("dealer-speech");s&&(s.textContent=e,s.style.display="block",setTimeout(()=>{s.style.display="none"},t))}revealDealerCard(e){const t=document.getElementById("face-down-card");if(t){t.remove();const s=this.createCardElement(e),a=document.getElementById("dealer-cards");if(a)return a.appendChild(s),setTimeout(()=>{s.style.transform="translateY(-5px)"},50),s}return null}}class C{constructor(){r(this,"deck");this.deck=[],this.createDeck()}createDeck(){const e=["hearts","diamonds","clubs","spades"],t=["A","2","3","4","5","6","7","8","9","10","J","Q","K"];this.deck=[];for(let s of e)for(let a of t)this.deck.push({suit:s,value:a});this.shuffle()}shuffle(){for(let e=this.deck.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[this.deck[e],this.deck[t]]=[this.deck[t],this.deck[e]]}}drawCard(){this.deck.length===0&&this.createDeck();const e=this.deck.pop();return e||(this.createDeck(),this.deck.pop())}getCardValue(e){return e.value==="A"?11:["J","Q","K"].includes(e.value)?10:parseInt(e.value)}isEmpty(){return this.deck.length===0}getRemainingCards(){return this.deck.length}reset(){this.createDeck()}}class x{constructor(){r(this,"gameActive");r(this,"playerHand");r(this,"dealerHand");r(this,"gameResult");r(this,"dealerPhrases");this.gameActive=!1,this.playerHand=[],this.dealerHand=[],this.gameResult=null,this.dealerPhrases={win:["Yarr! The cosmos favors ye today!","By the stars! Ye've bested me!","Void take me! Ye've got luck in yer tanks!","Stellar victory, spacer!","Blast me thrusters! Ye win this round!"],lose:["The black hole claims another victim!","Better luck in the next galaxy, rookie!","Space is cold, and so is defeat!","Yarr! The dealer always wins, spacer!","Back to the asteroid mines with ye!"],blackjack:["SUPERNOVA! A cosmic blackjack!","By the void! A perfect 21!","The stars aligned for ye today!","Quantum perfection! A blackjack!"],push:["A cosmic stalemate, eh?","The universe remains in balance.","Neither winner nor loser in the void.","We split the cosmic dust this time."]}}calculateScore(e){let t=0,s=0;for(let a of e)a.value==="A"?(s++,t+=11):["J","Q","K"].includes(a.value)?t+=10:t+=parseInt(a.value);for(;t>21&&s>0;)t-=10,s--;return t}calculateVisibleDealerScore(){return this.dealerHand.length<=1?this.dealerHand.length?this.getCardValue(this.dealerHand[0]):0:this.calculateScore(this.dealerHand.slice(0,-1))}getCardValue(e){return e.value==="A"?11:["J","Q","K"].includes(e.value)?10:parseInt(e.value)}isBlackjack(e){return e.length===2&&this.calculateScore(e)===21}isBust(e){return this.calculateScore(e)>21}checkForNaturalBlackjack(){const e=this.calculateScore(this.playerHand),t=this.calculateScore(this.dealerHand);return e===21||t===21?e===21&&t===21?"push":e===21?"blackjack":"lose":null}shouldDealerHit(){return this.calculateScore(this.dealerHand)<17}determineOutcome(){const e=this.calculateScore(this.playerHand),t=this.calculateScore(this.dealerHand);return t>21||e>t?"win":t>e?"lose":"push"}canDoubleDown(e,t){return this.playerHand.length===2&&e*2<=t}getDealerPhrase(e){const t=this.dealerPhrases[e];return t&&t.length>0?t[Math.floor(Math.random()*t.length)]:""}reset(){this.gameActive=!1,this.playerHand=[],this.dealerHand=[],this.gameResult=null}startGame(){this.gameActive=!0,this.playerHand=[],this.dealerHand=[],this.gameResult=null}addCardToPlayer(e){this.playerHand.push(e)}addCardToDealer(e){this.dealerHand.push(e)}endGame(e){this.gameActive=!1,this.gameResult=e}getPlayerScore(){return this.calculateScore(this.playerHand)}getDealerScore(){return this.calculateScore(this.dealerHand)}getPlayerHand(){return[...this.playerHand]}getDealerHand(){return[...this.dealerHand]}getLastDealerCard(){return this.dealerHand.length>0?this.dealerHand[this.dealerHand.length-1]:null}isGameActive(){return this.gameActive}getGameResult(){return this.gameResult}}class B{constructor(e=null){r(this,"audio");this.audio=e}animateCardDeal(e,t=50){e&&(e.style.transform="translateY(0px) scale(0.8)",e.style.opacity="0",setTimeout(()=>{e.style.transition="transform 0.3s ease, opacity 0.3s ease",e.style.transform="translateY(-5px) scale(1)",e.style.opacity="1"},t))}animateCardFlip(e,t=null){e&&(e.style.transition="transform 0.2s ease",e.style.transform="rotateY(90deg) translateY(-5px)",setTimeout(()=>{t&&t(),e.style.transform="rotateY(0deg) translateY(-5px)"},200))}animateButtonPress(e){e&&(e.style.transition="transform 0.1s ease",e.style.transform="scale(0.95)",setTimeout(()=>{e.style.transform="scale(1)"},100))}animateResourceSelection(e){e&&(e.style.transition="transform 0.2s ease, border-width 0.2s ease",e.style.transform="scale(1.05)",e.style.borderWidth="2px")}removeResourceSelection(e){e&&(e.style.transform="scale(1)",e.style.borderWidth="1px")}animateBetChange(e,t){e&&(e.style.transition="transform 0.15s ease",e.style.transform="scale(1.1)",setTimeout(()=>{e.textContent=String(t),e.style.transform="scale(1)"},75))}animateScoreUpdate(e,t,s=!1){if(!e)return;const a=e.style.color,i=s?"#ff6b6b":"#30cfd0";e.style.transition="color 0.2s ease, transform 0.2s ease",e.style.color=i,e.style.transform="scale(1.1)",e.textContent=t,setTimeout(()=>{e.style.color=a,e.style.transform="scale(1)"},200)}animateStatusUpdate(e,t,s="normal"){if(!e)return;let a="rgba(51, 170, 255, 0.2)",i="rgba(51, 170, 255, 0.4)";switch(s){case"win":case"blackjack":a="rgba(48, 207, 208, 0.3)",i="rgba(48, 207, 208, 0.6)";break;case"lose":case"bust":a="rgba(255, 107, 107, 0.3)",i="rgba(255, 107, 107, 0.6)";break;case"push":a="rgba(255, 193, 7, 0.3)",i="rgba(255, 193, 7, 0.6)";break}e.style.transition="background-color 0.3s ease, border-color 0.3s ease, transform 0.3s ease",e.style.backgroundColor=a,e.style.borderColor=i,e.style.transform="scale(1.05)",e.textContent=t,setTimeout(()=>{e.style.transform="scale(1)"},300)}animateSpeechBubble(e,t){e&&(e.textContent=t,e.style.opacity="0",e.style.transform="translateY(10px) scale(0.9)",e.style.display="block",setTimeout(()=>{e.style.transition="opacity 0.3s ease, transform 0.3s ease",e.style.opacity="1",e.style.transform="translateY(0px) scale(1)"},50))}hideSpeechBubble(e){e&&(e.style.transition="opacity 0.3s ease, transform 0.3s ease",e.style.opacity="0",e.style.transform="translateY(-10px) scale(0.9)",setTimeout(()=>{e.style.display="none"},300))}animateWinCelebration(e){e&&(e.style.transition="box-shadow 0.5s ease",e.style.boxShadow="0 0 50px rgba(48, 207, 208, 0.8)",setTimeout(()=>{e.style.boxShadow="0 0 30px rgba(51, 170, 255, 0.5)"},2e3))}animateLoseEffect(e){e&&(e.style.transition="box-shadow 0.5s ease",e.style.boxShadow="0 0 50px rgba(255, 107, 107, 0.6)",setTimeout(()=>{e.style.boxShadow="0 0 30px rgba(51, 170, 255, 0.5)"},2e3))}animateBlackjackCelebration(e){e&&(e.style.transition="box-shadow 0.5s ease, transform 0.5s ease",e.style.boxShadow="0 0 80px rgba(48, 207, 208, 1)",e.style.transform="translate(-50%, -50%) scale(1.02)",setTimeout(()=>{e.style.boxShadow="0 0 30px rgba(51, 170, 255, 0.5)",e.style.transform="translate(-50%, -50%) scale(1)"},3e3))}animateCardHover(e,t){e&&(t?(e.style.transition="transform 0.2s ease, box-shadow 0.2s ease",e.style.transform="translateY(-10px) scale(1.05)",e.style.boxShadow="0 0 20px rgba(51, 170, 255, 0.8)"):(e.style.transform="translateY(-5px) scale(1)",e.style.boxShadow="0 0 10px rgba(51, 170, 255, 0.5)"))}playCardSound(e){var s,a,i,o,n,h,c,d,p,g;const t=this.audio;if(t)switch(e){case"deal":(s=t.playSound)==null||s.call(t,"boink");break;case"hit":(a=t.playSound)==null||a.call(t,"boink");break;case"stand":(i=t.playSound)==null||i.call(t,"boink");break;case"double":(o=t.playSound)==null||o.call(t,"boink"),setTimeout(()=>{var u;return(u=t.playSound)==null?void 0:u.call(t,"boink")},150);break;case"flip":(n=t.playSound)==null||n.call(t,"boink");break;case"win":(h=t.playSound)==null||h.call(t,"phaserUp");break;case"blackjack":(c=t.playSound)==null||c.call(t,"phaserUp"),setTimeout(()=>{var u;return(u=t.playSound)==null?void 0:u.call(t,"phaserUp")},300);break;case"lose":(d=t.playSound)==null||d.call(t,"phaserDown");break;case"bust":(p=t.playSound)==null||p.call(t,"phaserDown");break;case"push":(g=t.playSound)==null||g.call(t,"boink");break}}chainAnimations(e,t=300){e.forEach((s,a)=>{setTimeout(()=>{typeof s=="function"&&s()},a*t)})}resetAnimations(e){e&&(e.style.transition="",e.style.transform="",e.style.opacity="",e.style.boxShadow="")}}class v{constructor(e=null){r(this,"spaceship");r(this,"currentBet");this.spaceship=e,this.currentBet={resource:null,amount:0}}setSpaceship(e){this.spaceship=e}selectBetResource(e){this.currentBet.resource=e,this.currentBet.amount=1}increaseBet(){const e=this.getMaxBet();return this.currentBet.amount<e?(this.currentBet.amount++,!0):!1}decreaseBet(){return this.currentBet.amount>1?(this.currentBet.amount--,!0):!1}getMaxBet(){return!this.currentBet.resource||!this.spaceship||!this.spaceship.cargo?0:this.spaceship.cargo[this.currentBet.resource]||0}getCurrentBet(){return{...this.currentBet}}hasValidBet(){return!!this.currentBet.resource&&this.currentBet.amount>0}canAffordBet(){if(!this.hasValidBet()||!this.spaceship||!this.spaceship.cargo)return!1;const e=this.currentBet.resource;return e?(this.spaceship.cargo[e]||0)>=this.currentBet.amount:!1}canAffordDoubleDown(){if(!this.hasValidBet()||!this.spaceship||!this.spaceship.cargo)return!1;const e=this.currentBet.resource;return e?(this.spaceship.cargo[e]||0)>=this.currentBet.amount:!1}placeBet(){if(!this.canAffordBet())return!1;const e=this.currentBet.resource;if(!this.spaceship||!this.spaceship.cargo||!e)return!1;this.spaceship.cargo[e]=(this.spaceship.cargo[e]||0)-this.currentBet.amount;const t=window.game;return t&&t.controls&&t.controls.resources&&(t.controls.resources[e]=this.spaceship.cargo[e]||0),!0}doubleDown(){if(!this.canAffordDoubleDown())return!1;const e=this.currentBet.resource;if(!this.spaceship||!this.spaceship.cargo||!e)return!1;this.spaceship.cargo[e]=(this.spaceship.cargo[e]||0)-this.currentBet.amount,this.currentBet.amount*=2;const t=window.game;return t&&t.controls&&t.controls.resources&&(t.controls.resources[e]=this.spaceship.cargo[e]||0),!0}calculateWinPayout(){return this.currentBet.amount*2}calculateBlackjackPayout(){return this.currentBet.amount*3}calculatePushPayout(){return this.currentBet.amount}payOut(e){if(!this.spaceship||!this.spaceship.cargo||!this.currentBet.resource)return;const t=this.currentBet.resource;if(!t)return;this.spaceship.cargo[t]=(this.spaceship.cargo[t]||0)+e;const s=window.game;s&&s.controls&&s.controls.resources&&(s.controls.resources[t]=this.spaceship.cargo[t]||0)}handleWin(){const e=this.calculateWinPayout();return this.payOut(e),e}handleBlackjack(){const e=this.calculateBlackjackPayout();return this.payOut(e),e}handlePush(){const e=this.calculatePushPayout();return this.payOut(e),e}reset(){this.currentBet={resource:null,amount:0}}getResourceAmounts(){return!this.spaceship||!this.spaceship.cargo?{iron:0,gold:0,platinum:0}:{iron:this.spaceship.cargo.iron||0,gold:this.spaceship.cargo.gold||0,platinum:this.spaceship.cargo.platinum||0}}initializeCargo(){return this.spaceship?(this.spaceship.cargo||(console.warn("Creating cargo object for spaceship"),this.spaceship.cargo={iron:0,gold:0,platinum:0}),this.spaceship.cargo.iron===void 0&&(this.spaceship.cargo.iron=0),this.spaceship.cargo.gold===void 0&&(this.spaceship.cargo.gold=0),this.spaceship.cargo.platinum===void 0&&(this.spaceship.cargo.platinum=0),!0):(console.error("No spaceship object available"),!1)}syncWithGameResources(){const e=window.game;if(e&&e.controls&&e.controls.resources){if(!this.spaceship)return;const t=e.controls.resources;this.spaceship.cargo||(this.spaceship.cargo={}),this.spaceship.cargo.iron=t.iron||0,this.spaceship.cargo.gold=t.gold||0,this.spaceship.cargo.platinum=t.platinum||0}}getBetDisplayString(){return this.hasValidBet()?`${this.currentBet.amount} ${this.currentBet.resource?this.currentBet.resource.toUpperCase():""}`:"0"}getResourceColor(e){switch(e){case"iron":return"rgba(150, 150, 150, 1)";case"gold":return"rgba(255, 215, 0, 1)";case"platinum":return"rgba(229, 228, 226, 1)";default:return"rgba(255, 255, 255, 1)"}}}class k{constructor(e,t=!1){r(this,"game");r(this,"isMobile");r(this,"eventListeners");this.game=e,this.isMobile=t,this.eventListeners=new Map}setupEventHandlers(){this.setupCloseButtonHandler(),this.setupResourceButtonHandlers(),this.setupBetControlHandlers(),this.setupActionButtonHandlers(),this.setupMobileEventHandlers()}setupCloseButtonHandler(){const e=document.querySelector("#blackjack-game button");if(e){const t=()=>this.game.hide();this.addEventHandler(e,"click",t)}}setupResourceButtonHandlers(){document.querySelectorAll(".resource-btn").forEach(t=>{const s=t.dataset.resource;if(!s)return;const a=()=>{if(this.game.gameLogic.isGameActive())return;const n=this.game.betting.getResourceColor(s);t.style.backgroundColor="rgba(25, 60, 80, 0.8)",t.style.boxShadow=`0 0 15px ${n}`},i=()=>{if(this.game.gameLogic.isGameActive())return;const n=this.game.betting.getResourceColor(s);t.style.backgroundColor="rgba(15, 40, 55, 0.8)",t.style.boxShadow=`0 0 10px rgba(${n.split("(")[1].split(")")[0]}, 0.3)`},o=()=>{this.game.gameLogic.isGameActive()||(this.game.selectBetResource(s),this.game.animations.playCardSound("boink"),document.querySelectorAll(".resource-btn").forEach(n=>{this.game.animations.removeResourceSelection(n)}),this.game.animations.animateResourceSelection(t))};this.addEventHandler(t,"mouseover",a),this.addEventHandler(t,"mouseout",i),this.addEventHandler(t,"click",o),this.isMobile&&(this.addEventHandler(t,"touchstart",a,{passive:!0}),this.addEventHandler(t,"touchend",n=>{i(),n.preventDefault(),o()}))})}setupBetControlHandlers(){const e=document.getElementById("decrease-bet-btn"),t=document.getElementById("increase-bet-btn");if(e){const s=()=>{if(!this.game.gameLogic.isGameActive()&&this.game.betting.getCurrentBet().resource&&this.game.betting.decreaseBet()){this.game.view.updateBetAmount(this.game.betting.getCurrentBet().amount);const a=document.getElementById("bet-amount");this.game.animations.animateBetChange(a,this.game.betting.getCurrentBet().amount),this.game.animations.playCardSound("boink")}};this.setupControlButton(e,s)}if(t){const s=()=>{if(!this.game.gameLogic.isGameActive()&&this.game.betting.getCurrentBet().resource&&this.game.betting.increaseBet()){this.game.view.updateBetAmount(this.game.betting.getCurrentBet().amount);const a=document.getElementById("bet-amount");this.game.animations.animateBetChange(a,this.game.betting.getCurrentBet().amount),this.game.animations.playCardSound("boink")}};this.setupControlButton(t,s)}}setupActionButtonHandlers(){[{id:"deal-btn",handler:()=>this.game.startGame()},{id:"hit-btn",handler:()=>this.game.hit()},{id:"stand-btn",handler:()=>this.game.stand()},{id:"double-btn",handler:()=>this.game.doubleDown()}].forEach(t=>{const s=document.getElementById(t.id);if(s){const a=()=>{s.disabled||(this.game.animations.animateButtonPress(s),t.handler(),this.game.animations.playCardSound("boink"))};this.setupActionButton(s,a)}})}setupMobileEventHandlers(){if(!this.isMobile)return;const e=document.getElementById("blackjack-game");e&&this.addEventHandler(e,"touchmove",t=>{t.preventDefault()},{passive:!1}),this.addEventHandler(window,"orientationchange",()=>{setTimeout(()=>{this.game.view.updateResourceDisplay(this.game.spaceship)},100)})}setupControlButton(e,t){const s=()=>{if(!e.disabled){const i=this.game.view.styles.getControlButtonHoverStyles();Object.assign(e.style,i)}},a=()=>{e.disabled||(e.style.backgroundColor="rgba(15, 40, 55, 0.8)",e.style.boxShadow="none")};this.addEventHandler(e,"mouseover",s),this.addEventHandler(e,"mouseout",a),this.addEventHandler(e,"click",t),this.isMobile&&(this.addEventHandler(e,"touchstart",s,{passive:!0}),this.addEventHandler(e,"touchend",i=>{a(),i.preventDefault(),t()}))}setupActionButton(e,t){const s=this.getButtonColor(e.id),a=()=>{if(!e.disabled){const o=this.game.view.styles.getActionButtonHoverStyles(s);Object.assign(e.style,o)}},i=()=>{e.disabled||(e.style.backgroundColor="rgba(15, 40, 55, 0.8)",e.style.boxShadow=`0 0 10px ${s}`)};this.addEventHandler(e,"mouseover",a),this.addEventHandler(e,"mouseout",i),this.addEventHandler(e,"click",t),this.isMobile&&(this.addEventHandler(e,"touchstart",a,{passive:!0}),this.addEventHandler(e,"touchend",o=>{i(),o.preventDefault(),t()}))}getButtonColor(e){switch(e){case"deal-btn":return"#30cfd0";case"hit-btn":return"#ff9e3d";case"stand-btn":return"#e55c8a";case"double-btn":return"#a281ff";default:return"#33aaff"}}addEventHandler(e,t,s,a=!1){var n;e.addEventListener(t,s,a);const i=e,o=`${i.id||i.className}_${t}`;this.eventListeners.has(o)||this.eventListeners.set(o,[]),(n=this.eventListeners.get(o))==null||n.push({element:e,event:t,handler:s,options:a})}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.forEach(({element:t,event:s,handler:a,options:i})=>{t.removeEventListener(s,a,i)})}),this.eventListeners.clear()}updateButtonStates(){const e=document.getElementById("deal-btn"),t=document.getElementById("hit-btn"),s=document.getElementById("stand-btn"),a=document.getElementById("double-btn");if([e,t,s,a].forEach(i=>{i&&(i.disabled=!0,i.style.opacity="0.5",i.style.cursor="default")}),this.game.gameLogic.isGameActive()){t&&(t.disabled=!1,t.style.opacity="1",t.style.cursor="pointer"),s&&(s.disabled=!1,s.style.opacity="1",s.style.cursor="pointer");const o=this.game.gameLogic.getPlayerHand().length===2&&this.game.betting.canAffordDoubleDown();a&&(a.disabled=!o,a.style.opacity=o?"1":"0.5",a.style.cursor=o?"pointer":"default")}else{const i=this.game.betting.hasValidBet();e&&(e.disabled=!i,e.style.opacity=i?"1":"0.5",e.style.cursor=i?"pointer":"default")}}setupKeyboardHandlers(){const e=t=>{if(!(!this.game.gameUI||this.game.gameUI.style.display==="none"))switch(t.key.toLowerCase()){case"escape":this.game.hide();break;case"enter":case" ":!this.game.gameLogic.isGameActive()&&this.game.betting.hasValidBet()&&this.game.startGame();break;case"h":this.game.gameLogic.isGameActive()&&this.game.hit();break;case"s":this.game.gameLogic.isGameActive()&&this.game.stand();break;case"d":this.game.gameLogic.isGameActive()&&this.game.doubleDown();break;case"1":this.selectResource("iron");break;case"2":this.selectResource("gold");break;case"3":this.selectResource("platinum");break;case"arrowup":case"+":!this.game.gameLogic.isGameActive()&&this.game.betting.getCurrentBet().resource&&this.game.betting.increaseBet()&&this.game.view.updateBetAmount(this.game.betting.getCurrentBet().amount),t.preventDefault();break;case"arrowdown":case"-":!this.game.gameLogic.isGameActive()&&this.game.betting.getCurrentBet().resource&&this.game.betting.decreaseBet()&&this.game.view.updateBetAmount(this.game.betting.getCurrentBet().amount),t.preventDefault();break}};this.addEventHandler(document,"keydown",e)}selectResource(e){if(!this.game.gameLogic.isGameActive()){const t=document.querySelector(`[data-resource="${e}"]`);t&&t.click()}}setupResizeHandler(){const e=()=>{this.isMobile=window.innerWidth<=768||window.innerHeight<=600,this.game.view&&(this.game.view.isMobile=this.isMobile)};this.addEventHandler(window,"resize",e)}initialize(){this.setupEventHandlers(),this.setupKeyboardHandlers(),this.setupResizeHandler()}destroy(){this.removeAllEventListeners()}}class H{constructor(e,t,s){r(this,"scene");r(this,"spaceship");r(this,"audio");r(this,"isMobile");r(this,"view");r(this,"deck");r(this,"gameLogic");r(this,"animations");r(this,"betting");r(this,"eventHandlers");r(this,"gameUI");this.scene=e,this.spaceship=t,this.audio=s,this.isMobile=b.isMobile(),console.log("BlackjackGame constructor - spaceship:",this.spaceship),console.log("BlackjackGame constructor - cargo:",this.spaceship?this.spaceship.cargo:null),console.log("BlackjackGame constructor - isMobile:",this.isMobile),this.view=new S(this.isMobile),this.deck=new C,this.gameLogic=new x,this.animations=new B(this.audio),this.betting=new v(this.spaceship),this.eventHandlers=new k(this,this.isMobile),this.gameUI=null}init(){this.gameUI||this.createGameUI()}createGameUI(){this.gameUI=this.view.createGameUI(),this.eventHandlers.initialize(),this.updateControls()}show(){if(window.game&&window.game.introSequenceActive){console.log("BlackjackGame: Not showing game UI during intro sequence");return}if(this.gameUI){if(this.view.show(this.gameUI),this.reset(),this.audio&&this.isMobile){const e=this.audio;setTimeout(()=>{var t;console.log("Mobile: Attempting to play initial sound in BlackjackGame"),(t=e.playSound)==null||t.call(e,"boink")},100)}this.betting.syncWithGameResources(),this.view.updateResourceDisplay(this.spaceship),this.animations.playCardSound("boink")}else this.init(),this.show()}hide(){if(this.gameUI){this.view.hide(this.gameUI),this.animations.playCardSound("boink");const e=document.getElementById("stargate-ui");e&&(e.style.display="block")}}reset(){this.gameLogic.reset(),this.betting.reset(),this.view.clearCards(!0),this.view.clearCards(!1),this.view.updateScore(0,!0),this.view.updateScore(0,!1),this.view.updateGameStatus("PLACE YOUR BET TO BEGIN"),this.view.updateBetAmount("0");const e=document.getElementById("dealer-speech");e&&(e.style.display="none"),document.querySelectorAll(".resource-btn").forEach(t=>{this.animations.removeResourceSelection(t)}),this.updateControls()}selectBetResource(e){this.betting.selectBetResource(e);const t=this.betting.getCurrentBet();this.view.updateBetAmount(t.amount),this.updateControls()}updateControls(){this.eventHandlers.updateButtonStates()}startGame(){if(console.log("Starting game with bet:",this.betting.getCurrentBet()),!this.betting.hasValidBet()){console.log("No valid bet selected");return}if(!this.betting.initializeCargo()){this.view.updateGameStatus("ERROR: GAME DATA MISSING");return}if(!this.betting.canAffordBet()){this.view.updateGameStatus("NOT ENOUGH RESOURCES");return}if(!this.betting.placeBet()){this.view.updateGameStatus("BET FAILED");return}this.view.updateResourceDisplay(this.spaceship),this.deck.reset(),this.gameLogic.startGame(),this.view.clearCards(!0),this.view.clearCards(!1),this.dealCardToPlayer(),this.dealCardToPlayer(),this.dealCardToDealer(),this.dealCardToDealer(!0);const e=this.gameLogic.checkForNaturalBlackjack();e?this.handleGameEnd(e):this.view.updateGameStatus("YOUR MOVE"),this.updateControls(),this.animations.playCardSound("deal")}dealCardToPlayer(){const e=this.deck.drawCard();this.gameLogic.addCardToPlayer(e);const t=this.view.addCard(e,!1,!0);t&&this.animations.animateCardDeal(t);const s=this.gameLogic.getPlayerScore();this.view.updateScore(s,!0),this.gameLogic.isBust(this.gameLogic.getPlayerHand())&&this.handleGameEnd("bust")}dealCardToDealer(e=!1){const t=this.deck.drawCard();this.gameLogic.addCardToDealer(t);const s=this.view.addCard(t,e,!1);if(s&&this.animations.animateCardDeal(s),!e){const a=this.gameLogic.calculateVisibleDealerScore();this.view.updateScore(a,!1)}}hit(){this.gameLogic.isGameActive()&&(this.dealCardToPlayer(),this.animations.playCardSound("hit"),this.updateControls())}stand(){this.gameLogic.isGameActive()&&(this.animations.playCardSound("stand"),this.dealerPlay())}doubleDown(){if(this.gameLogic.isGameActive()&&this.gameLogic.getPlayerHand().length===2){if(!this.betting.canAffordDoubleDown()){this.view.updateGameStatus("NOT ENOUGH RESOURCES FOR DOUBLE DOWN");return}this.betting.doubleDown(),this.view.updateResourceDisplay(this.spaceship),this.dealCardToPlayer(),this.gameLogic.isBust(this.gameLogic.getPlayerHand())||this.dealerPlay(),this.animations.playCardSound("double")}}dealerPlay(){const e=this.gameLogic.getLastDealerCard();if(e){const s=document.getElementById("face-down-card");s?this.animations.animateCardFlip(s,()=>{this.view.revealDealerCard(e),this.view.updateScore(this.gameLogic.getDealerScore(),!1)}):(this.view.revealDealerCard(e),this.view.updateScore(this.gameLogic.getDealerScore(),!1))}const t=()=>{if(this.gameLogic.shouldDealerHit())this.dealCardToDealer(),this.animations.playCardSound("hit"),setTimeout(()=>{t()},800);else{const s=this.gameLogic.determineOutcome();this.handleGameEnd(s)}};setTimeout(t,800)}handleGameEnd(e){this.gameLogic.endGame(e);let t="",s=e==="bust"?"lose":e;switch(e){case"win":this.betting.handleWin(),t="YOU WIN!",this.gameUI&&this.animations.animateWinCelebration(this.gameUI),this.animations.playCardSound("win");break;case"blackjack":this.betting.handleBlackjack(),t="BLACKJACK! TRIPLE PAYOUT!",this.gameUI&&this.animations.animateBlackjackCelebration(this.gameUI),this.animations.playCardSound("blackjack");break;case"lose":case"bust":t=e==="bust"?"BUST! YOU LOSE":"DEALER WINS",this.gameUI&&this.animations.animateLoseEffect(this.gameUI),this.animations.playCardSound(e),s="lose";break;case"push":this.betting.handlePush(),t="PUSH - BETS RETURNED",this.animations.playCardSound("push");break}this.view.updateGameStatus(t),this.view.updateResourceDisplay(this.spaceship);const a=this.gameLogic.getDealerPhrase(s);a&&this.view.showDealerSpeech(a),this.updateControls()}destroy(){this.eventHandlers&&this.eventHandlers.destroy(),this.gameUI&&this.gameUI.parentNode&&this.gameUI.parentNode.removeChild(this.gameUI),this.gameUI=null}}export{H as BlackjackGame};
//# sourceMappingURL=blackjackGame-DXuUSgae.js.map
