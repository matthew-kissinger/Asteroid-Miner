{"version":3,"file":"starMap-DErtprvI.js","sources":["../../js/modules/ui/starmap/canvasRenderer.ts","../../js/modules/ui/starmap/navigationLogic.ts","../../js/modules/ui/starmap/dataManager.ts","../../js/modules/ui/starmap/uiCreator.ts","../../js/modules/ui/starMap.ts"],"sourcesContent":["// canvasRenderer.ts - Handles star map canvas rendering\n\ninterface StarSystem {\n    name: string;\n    position: { x: number; y: number };\n    starColor?: number;\n    connections: string[];\n}\n\ninterface StarSystemGenerator {\n    getAllSystems(): Record<string, StarSystem>;\n    currentSystem: string;\n    warpGates: Record<string, string[]>;\n}\n\nexport class CanvasRenderer {\n    private isMobile: boolean;\n\n    constructor(isMobile: boolean) {\n        this.isMobile = isMobile;\n    }\n\n    // Draw the star map on the canvas\n    updateCanvas(starSystemGenerator: StarSystemGenerator): void {\n        const canvas = document.getElementById('star-map-canvas') as HTMLCanvasElement;\n        if (!canvas) return;\n        \n        const ctx = canvas.getContext('2d');\n        if (!ctx) return;\n        \n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        \n        // Define the center of the canvas\n        const centerX = canvas.width / 2;\n        const centerY = canvas.height / 2;\n        \n        // Get systems data\n        const systems = starSystemGenerator.getAllSystems();\n        const currentSystem = starSystemGenerator.currentSystem;\n        const connections = starSystemGenerator.warpGates;\n        \n        // First draw connections\n        this.drawConnections(ctx, centerX, centerY, systems, connections);\n        \n        // Highlight connections from current system\n        this.drawCurrentSystemConnections(ctx, centerX, centerY, systems, currentSystem);\n        \n        // Now draw systems\n        this.drawSystems(ctx, centerX, centerY, systems, currentSystem);\n    }\n\n    drawConnections(ctx: CanvasRenderingContext2D, centerX: number, centerY: number, systems: Record<string, StarSystem>, connections: Record<string, string[]>): void {\n        ctx.lineWidth = 1;\n        ctx.strokeStyle = 'rgba(48, 207, 208, 0.4)';\n        \n        for (const [systemId, connectedSystems] of Object.entries(connections)) {\n            const system = systems[systemId];\n            if (!system) continue;\n            \n            // Convert system position to canvas position\n            const x1 = centerX + system.position.x;\n            const y1 = centerY + system.position.y;\n            \n            for (const connectedId of connectedSystems) {\n                const connectedSystem = systems[connectedId];\n                if (!connectedSystem) continue;\n                \n                // Convert connected system position to canvas position\n                const x2 = centerX + connectedSystem.position.x;\n                const y2 = centerY + connectedSystem.position.y;\n                \n                // Draw the connection\n                ctx.beginPath();\n                ctx.moveTo(x1, y1);\n                ctx.lineTo(x2, y2);\n                ctx.stroke();\n            }\n        }\n    }\n\n    drawCurrentSystemConnections(ctx: CanvasRenderingContext2D, centerX: number, centerY: number, systems: Record<string, StarSystem>, currentSystem: string): void {\n        if (currentSystem && systems[currentSystem]) {\n            const currentSystemData = systems[currentSystem];\n            const x1 = centerX + currentSystemData.position.x;\n            const y1 = centerY + currentSystemData.position.y;\n            \n            ctx.lineWidth = this.isMobile ? 3 : 2;\n            ctx.strokeStyle = 'rgba(48, 207, 208, 0.8)';\n            \n            for (const connectedId of currentSystemData.connections) {\n                const connectedSystem = systems[connectedId];\n                if (!connectedSystem) continue;\n                \n                // Convert connected system position to canvas position\n                const x2 = centerX + connectedSystem.position.x;\n                const y2 = centerY + connectedSystem.position.y;\n                \n                // Draw the connection\n                ctx.beginPath();\n                ctx.moveTo(x1, y1);\n                ctx.lineTo(x2, y2);\n                ctx.stroke();\n            }\n        }\n    }\n\n    drawSystems(ctx: CanvasRenderingContext2D, centerX: number, centerY: number, systems: Record<string, StarSystem>, currentSystem: string, selectedSystem: string | null = null): void {\n        // Now draw systems\n        for (const [systemId, system] of Object.entries(systems)) {\n            // Convert system position to canvas position\n            const x = centerX + system.position.x;\n            const y = centerY + system.position.y;\n            \n            // Determine if it's the current system, selected system, or regular\n            const isCurrent = systemId === currentSystem;\n            const isSelected = systemId === selectedSystem;\n            const isConnected = currentSystem && systems[currentSystem] && \n                                systems[currentSystem].connections.includes(systemId);\n            \n            // Draw a circle for the system\n            ctx.beginPath();\n            \n            // Size based on status and device\n            let radius: number;\n            if (this.isMobile) {\n                radius = isCurrent ? 18 : isSelected ? 15 : 10;\n            } else {\n                radius = isCurrent ? 15 : isSelected ? 12 : 8;\n            }\n            \n            // Fill color based on star class\n            ctx.fillStyle = system.starColor ? `#${system.starColor.toString(16).padStart(6, '0')}` : '#ffffff';\n            \n            // Add glow for current and selected\n            if (isCurrent || isSelected) {\n                ctx.shadowBlur = this.isMobile ? 20 : 15;\n                ctx.shadowColor = isCurrent ? '#30cfd0' : '#ffffff';\n            } else {\n                ctx.shadowBlur = 0;\n            }\n            \n            // Draw the star\n            ctx.arc(x, y, radius, 0, Math.PI * 2);\n            ctx.fill();\n            \n            // Reset shadow\n            ctx.shadowBlur = 0;\n            \n            // Draw border for connected systems\n            if (isConnected && !isCurrent) {\n                ctx.strokeStyle = '#30cfd0';\n                ctx.lineWidth = this.isMobile ? 3 : 2;\n                ctx.beginPath();\n                ctx.arc(x, y, radius + 3, 0, Math.PI * 2);\n                ctx.stroke();\n            }\n            \n            // Draw name label\n            ctx.fillStyle = isCurrent ? '#30cfd0' : isSelected ? '#ffffff' : '#aaaaaa';\n            ctx.font = isCurrent ? \n                      (this.isMobile ? 'bold 14px Courier New' : 'bold 12px Courier New') : \n                      (this.isMobile ? '12px Courier New' : '10px Courier New');\n            ctx.textAlign = 'center';\n            ctx.fillText(system.name, x, y + radius + (this.isMobile ? 18 : 15));\n        }\n    }\n\n    // Find which system was clicked (if any)\n    findSystemAtPosition(x: number, y: number, starSystemGenerator: StarSystemGenerator): string | null {\n        const systems = starSystemGenerator.getAllSystems();\n        const currentSystem = starSystemGenerator.currentSystem;\n        \n        // Define the center of the canvas\n        const centerX = 250;\n        const centerY = 250;\n        \n        // Check each system\n        for (const [systemId, system] of Object.entries(systems)) {\n            // Convert system position to canvas position\n            const canvasX = centerX + system.position.x;\n            const canvasY = centerY + system.position.y;\n            \n            // Calculate distance from click to star\n            const dx = x - canvasX;\n            const dy = y - canvasY;\n            const distance = Math.sqrt(dx * dx + dy * dy);\n            \n            // If click is within the star's radius (make current system bigger)\n            // Use larger tap area for mobile\n            const radius = systemId === currentSystem ? \n                          (this.isMobile ? 20 : 15) : \n                          (this.isMobile ? 15 : 10);\n            if (distance <= radius) {\n                return systemId;\n            }\n        }\n        \n        return null;\n    }\n}\n","// navigationLogic.ts - Handles star map navigation and travel logic\n\ninterface StarSystem {\n    name: string;\n    starClass: string;\n    classification: string;\n    resourceMultipliers: {\n        iron: number;\n        gold: number;\n        platinum: number;\n    };\n    description: string;\n    specialFeatures: string[];\n}\n\ninterface StarSystemGenerator {\n    getAllSystems(): Record<string, StarSystem>;\n    currentSystem: string;\n    getCurrentSystemConnections(): string[];\n    travelToSystem(systemId: string): boolean;\n    getCurrentSystemData(): StarSystem | null;\n}\n\ninterface DockingSystem {\n    // Docking system interface\n}\n\ninterface StargateInterface {\n    // Stargate interface\n}\n\ninterface Environment {\n    travelToSystem(systemId: string): boolean;\n}\n\nexport class NavigationLogic {\n    private starSystemGenerator: StarSystemGenerator;\n    private selectedSystem: string | null;\n    private isTraveling: boolean;\n\n    constructor(starSystemGenerator: StarSystemGenerator, _dockingSystem: DockingSystem, _stargateInterface: StargateInterface) {\n        this.starSystemGenerator = starSystemGenerator;\n        this.selectedSystem = null;\n        this.isTraveling = false;\n    }\n\n    // Select a system and update the UI\n    selectSystem(\n        systemId: string | null, \n        isMobile: boolean, \n        updateSelectedSystemCallback: (system: StarSystem | null, isMobile: boolean) => void, \n        updateTravelButtonCallback: (systemId: string | null, isCurrentSystem: boolean, isConnected: boolean) => void\n    ): void {\n        console.log(`Selecting system: ${systemId}`);\n        this.selectedSystem = systemId;\n        \n        if (!systemId) {\n            // Clear selection\n            updateSelectedSystemCallback(null, isMobile);\n            updateTravelButtonCallback(null, false, false);\n            return;\n        }\n        \n        // Get system data\n        const system = this.starSystemGenerator.getAllSystems()[systemId];\n        const currentSystem = this.starSystemGenerator.currentSystem;\n        \n        // Update selected system info card\n        updateSelectedSystemCallback(system, isMobile);\n        \n        // Enable/disable travel button\n        const isConnected = this.starSystemGenerator.getCurrentSystemConnections().includes(systemId);\n        const isCurrentSystem = systemId === currentSystem;\n        \n        updateTravelButtonCallback(systemId, isCurrentSystem, isConnected);\n    }\n\n    // Handle travel to selected system\n    handleTravel(hideCallback: () => void): void {\n        if (this.selectedSystem && this.selectedSystem !== this.starSystemGenerator.currentSystem) {\n            console.log(`Initiating travel to system: ${this.selectedSystem}`);\n            \n            // Set traveling flag before hiding the star map\n            this.isTraveling = true;\n            \n            // Close the star map first\n            hideCallback();\n            \n            // Find the environment object to properly handle transition\n            const environment = (window.game as any).environment as Environment;\n            if (environment && environment.travelToSystem) {\n                const success = environment.travelToSystem(this.selectedSystem);\n                console.log(`Travel to ${this.selectedSystem} initiated: ${success}`);\n                \n                // Reset traveling flag after travel is complete\n                setTimeout(() => {\n                    this.isTraveling = false;\n                }, 5000); // Wait for transition to complete\n            } else {\n                // Fallback to direct use of starSystemGenerator\n                const success = this.starSystemGenerator.travelToSystem(this.selectedSystem);\n                \n                if (success) {\n                    // Reset selection\n                    this.selectSystem(null, false, () => {}, () => {});\n                    \n                    // Notify the user\n                    const currentSystemData = this.starSystemGenerator.getCurrentSystemData();\n                    if (currentSystemData) {\n                        this.showTravelNotification(currentSystemData.name, false);\n                    }\n                    \n                    // Reset traveling flag\n                    this.isTraveling = false;\n                }\n            }\n        }\n    }\n\n    // Show travel notification\n    showTravelNotification(systemName: string, isMobile: boolean): void {\n        // Create notification element\n        const notification = document.createElement('div');\n        notification.style.position = 'fixed';\n        notification.style.top = isMobile ? '30%' : '20%';\n        notification.style.left = '50%';\n        notification.style.transform = 'translate(-50%, -50%)';\n        notification.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';\n        notification.style.color = '#30cfd0';\n        notification.style.padding = isMobile ? '15px 30px' : '20px 40px';\n        notification.style.borderRadius = '10px';\n        notification.style.border = '2px solid #30cfd0';\n        notification.style.boxShadow = '0 0 30px #30cfd0';\n        notification.style.fontFamily = 'Courier New, monospace';\n        notification.style.fontSize = isMobile ? '18px' : '20px';\n        notification.style.fontWeight = 'bold';\n        notification.style.zIndex = '9999';\n        notification.style.textAlign = 'center';\n        notification.textContent = `ARRIVED AT ${systemName}`;\n        \n        // Add to DOM\n        document.body.appendChild(notification);\n        \n        // Remove after a few seconds\n        setTimeout(() => {\n            notification.style.opacity = '0';\n            notification.style.transition = 'opacity 1s';\n            \n            setTimeout(() => {\n                notification.remove();\n            }, 1000);\n        }, 3000);\n    }\n\n    getSelectedSystem(): string | null {\n        return this.selectedSystem;\n    }\n\n    isTravelingToSystem(): boolean {\n        return this.isTraveling;\n    }\n}\n","// dataManager.ts - Handles star map data management and system information\n\ninterface StarSystem {\n    name: string;\n    starClass: string;\n    classification: string;\n    resourceMultipliers: {\n        iron: number;\n        gold: number;\n        platinum: number;\n    };\n    description: string;\n    specialFeatures: string[];\n}\n\ninterface StarSystemGenerator {\n    getCurrentSystemData(): StarSystem | null;\n    getAllSystems(): Record<string, StarSystem>;\n    currentSystem: string;\n}\n\nexport class DataManager {\n    private starSystemGenerator: StarSystemGenerator;\n\n    constructor(starSystemGenerator: StarSystemGenerator) {\n        this.starSystemGenerator = starSystemGenerator;\n    }\n\n    // Update the current system information\n    updateCurrentSystemInfo(_isMobile: boolean): void {\n        const system = this.starSystemGenerator.getCurrentSystemData();\n        if (!system) return;\n        \n        // Update system name and class\n        const systemNameEl = document.getElementById('current-system-name');\n        const systemClassEl = document.getElementById('current-system-class');\n        if (systemNameEl) systemNameEl.textContent = system.name;\n        if (systemClassEl) {\n            systemClassEl.textContent = `Class ${system.starClass} - ${system.classification}`;\n        }\n        \n        // Update resource indicators\n        const ironIndicator = document.getElementById('current-iron-indicator');\n        const goldIndicator = document.getElementById('current-gold-indicator');\n        const platinumIndicator = document.getElementById('current-platinum-indicator');\n        \n        if (ironIndicator) {\n            ironIndicator.style.width = `${system.resourceMultipliers.iron * 50}%`;\n        }\n        if (goldIndicator) {\n            goldIndicator.style.width = `${system.resourceMultipliers.gold * 50}%`;\n        }\n        if (platinumIndicator) {\n            platinumIndicator.style.width = `${system.resourceMultipliers.platinum * 50}%`;\n        }\n        \n        // Update description and features\n        const descriptionEl = document.getElementById('current-system-description');\n        const featuresEl = document.getElementById('current-system-features');\n        if (descriptionEl) descriptionEl.textContent = system.description;\n        if (featuresEl) {\n            featuresEl.textContent = `Special Features: ${system.specialFeatures.join(', ')}`;\n        }\n    }\n\n    // Update selected system info card\n    updateSelectedSystemInfo(system: StarSystem | null, isMobile: boolean): void {\n        const selectedCard = document.getElementById('selected-system-card');\n        if (!selectedCard) return;\n\n        if (!system) {\n            // Clear selection\n            selectedCard.innerHTML = `\n                <div class=\"empty-selection\" style=\"color: #777; text-align: center; padding: 20px;\">\n                    No system selected.<br>${isMobile ? 'Tap' : 'Click'} on a star system in the map to select it.\n                </div>\n            `;\n            return;\n        }\n\n        selectedCard.innerHTML = `\n            <div id=\"selected-system-name\" style=\"font-size: ${isMobile ? '16px' : '18px'}; font-weight: bold; color: #fff; margin-bottom: 5px;\">${system.name}</div>\n            <div id=\"selected-system-class\" style=\"font-size: ${isMobile ? '12px' : '14px'}; color: #aaa; margin-bottom: 10px;\">Class ${system.starClass} - ${system.classification}</div>\n            <div id=\"selected-system-resources\" style=\"margin-bottom: 10px;\">\n                <div style=\"display: flex; justify-content: space-between; margin-bottom: 5px;\">\n                    <span>Iron:</span>\n                    <div class=\"resource-indicator\" style=\"width: 100px; height: 8px; background: #333; border-radius: 4px; overflow: hidden;\">\n                        <div style=\"height: 100%; width: ${system.resourceMultipliers.iron * 50}%; background: #aaa;\"></div>\n                    </div>\n                </div>\n                <div style=\"display: flex; justify-content: space-between; margin-bottom: 5px;\">\n                    <span>Gold:</span>\n                    <div class=\"resource-indicator\" style=\"width: 100px; height: 8px; background: #333; border-radius: 4px; overflow: hidden;\">\n                        <div style=\"height: 100%; width: ${system.resourceMultipliers.gold * 50}%; background: #FFD700;\"></div>\n                    </div>\n                </div>\n                <div style=\"display: flex; justify-content: space-between;\">\n                    <span>Platinum:</span>\n                    <div class=\"resource-indicator\" style=\"width: 100px; height: 8px; background: #333; border-radius: 4px; overflow: hidden;\">\n                        <div style=\"height: 100%; width: ${system.resourceMultipliers.platinum * 50}%; background: #E5E4E2;\"></div>\n                    </div>\n                </div>\n            </div>\n            <div style=\"font-size: ${isMobile ? '11px' : '12px'}; color: #ccc; margin-bottom: 10px;\">\n                ${system.description}\n            </div>\n            <div style=\"font-size: ${isMobile ? '11px' : '12px'}; color: #30cfd0;\">\n                Special Features: ${system.specialFeatures.join(', ')}\n            </div>\n        `;\n        \n        // Scroll to make selected system info visible on mobile\n        if (isMobile) {\n            const infoPanel = document.getElementById('system-info-panel');\n            if (infoPanel && selectedCard) {\n                infoPanel.scrollTop = selectedCard.offsetTop - infoPanel.offsetTop;\n            }\n        }\n    }\n\n    // Update travel button state\n    updateTravelButton(systemId: string | null, isCurrentSystem: boolean, isConnected: boolean): void {\n        const travelButton = document.getElementById('travel-button') as HTMLButtonElement;\n        if (!travelButton) return;\n\n        if (!systemId) {\n            // No system selected\n            travelButton.disabled = true;\n            travelButton.style.cursor = 'not-allowed';\n            travelButton.style.opacity = '0.5';\n            travelButton.textContent = 'TRAVEL TO SYSTEM';\n            return;\n        }\n\n        travelButton.disabled = isCurrentSystem || !isConnected;\n        travelButton.style.cursor = isCurrentSystem || !isConnected ? 'not-allowed' : 'pointer';\n        travelButton.style.opacity = isCurrentSystem || !isConnected ? '0.5' : '1';\n        \n        // Update button text\n        travelButton.textContent = isCurrentSystem ? 'CURRENT LOCATION' : \n                                  !isConnected ? 'NO DIRECT ROUTE' : 'TRAVEL TO SYSTEM';\n    }\n\n    getCurrentSystemData(): StarSystem | null {\n        return this.starSystemGenerator.getCurrentSystemData();\n    }\n\n    getAllSystems(): Record<string, StarSystem> {\n        return this.starSystemGenerator.getAllSystems();\n    }\n\n    getCurrentSystem(): string {\n        return this.starSystemGenerator.currentSystem;\n    }\n}\n","// uiCreator.ts - Handles star map UI creation and setup\n\nexport class UICreator {\n    private isMobile: boolean;\n\n    constructor(isMobile: boolean) {\n        this.isMobile = isMobile;\n    }\n\n    // Create star map UI\n    setupStarMapUI(): void {\n        // Create starmap container\n        const starMap = document.createElement('div');\n        starMap.id = 'star-map';\n        starMap.style.position = 'absolute';\n        starMap.style.top = '50%';\n        starMap.style.left = '50%';\n        starMap.style.transform = 'translate(-50%, -50%)';\n        \n        // Adjust size for mobile devices\n        if (this.isMobile) {\n            starMap.style.width = '95%';\n            starMap.style.height = '85vh'; // Reduced to ensure the button is visible\n            starMap.style.maxHeight = '700px';\n        } else {\n            starMap.style.width = '900px';\n            starMap.style.height = '700px';\n        }\n        \n        starMap.style.backgroundColor = 'rgba(10, 15, 30, 0.95)';\n        starMap.style.color = '#fff';\n        starMap.style.padding = this.isMobile ? '15px' : '30px';\n        starMap.style.borderRadius = '10px';\n        starMap.style.border = '2px solid #30cfd0';\n        starMap.style.boxShadow = '0 0 30px #30cfd0';\n        starMap.style.fontFamily = 'Courier New, monospace';\n        starMap.style.zIndex = '1500';\n        starMap.style.display = 'none';\n        starMap.style.overflow = 'hidden';\n        \n        // Create title\n        const title = document.createElement('h2');\n        title.textContent = 'STAR MAP';\n        title.style.textAlign = 'center';\n        title.style.color = '#30cfd0';\n        title.style.margin = '0 0 20px 0';\n        title.style.fontSize = this.isMobile ? '24px' : '28px';\n        starMap.appendChild(title);\n        \n        // Create map content container with flexible layout\n        const content = document.createElement('div');\n        content.style.display = 'flex';\n        content.style.flexDirection = this.isMobile ? 'column' : 'row';\n        content.style.height = this.isMobile ? 'calc(100% - 120px)' : 'calc(100% - 100px)';\n        content.style.gap = this.isMobile ? '15px' : '0';\n        \n        // Left column - System Map (stars and connections)\n        const mapContainer = this.createMapContainer();\n        \n        // Right column - System Information\n        const infoPanel = this.createInfoPanel();\n        \n        // Add all elements to the map\n        content.appendChild(mapContainer);\n        content.appendChild(infoPanel);\n        starMap.appendChild(content);\n        \n        // Close button\n        const closeButton = this.createCloseButton();\n        starMap.appendChild(closeButton);\n        \n        // Add to DOM\n        document.body.appendChild(starMap);\n    }\n\n    createMapContainer(): HTMLElement {\n        const mapContainer = document.createElement('div');\n        mapContainer.id = 'star-map-visual';\n        mapContainer.style.flex = '1';\n        mapContainer.style.background = 'rgba(0, 0, 0, 0.7)';\n        mapContainer.style.borderRadius = '10px';\n        mapContainer.style.border = '1px solid #30cfd0';\n        mapContainer.style.position = 'relative';\n        mapContainer.style.overflow = 'hidden';\n        mapContainer.style.height = this.isMobile ? '40%' : '100%';\n        mapContainer.style.minHeight = this.isMobile ? '250px' : 'auto';\n        \n        // Create canvas for map visualization\n        const canvas = document.createElement('canvas');\n        canvas.id = 'star-map-canvas';\n        canvas.width = 500;\n        canvas.height = 500;\n        canvas.style.width = '100%';\n        canvas.style.height = '100%';\n        mapContainer.appendChild(canvas);\n        \n        return mapContainer;\n    }\n\n    createInfoPanel(): HTMLElement {\n        const infoPanel = document.createElement('div');\n        infoPanel.id = 'system-info-panel';\n        infoPanel.style.width = this.isMobile ? '100%' : '350px';\n        infoPanel.style.marginLeft = this.isMobile ? '0' : '20px';\n        infoPanel.style.overflowY = 'auto';\n        infoPanel.style.height = this.isMobile ? '60%' : '100%';\n        (infoPanel.style as any).webkitOverflowScrolling = 'touch'; // For smooth scrolling on iOS\n        \n        // Current system section\n        const currentSystem = this.createCurrentSystemSection();\n        infoPanel.appendChild(currentSystem);\n        \n        // Selected system section\n        const selectedSystem = this.createSelectedSystemSection();\n        infoPanel.appendChild(selectedSystem);\n        \n        return infoPanel;\n    }\n\n    createCurrentSystemSection(): HTMLElement {\n        const currentSystem = document.createElement('div');\n        currentSystem.id = 'current-system-info';\n        currentSystem.innerHTML = `\n            <h3 style=\"color: #30cfd0; margin-top: 0; font-size: ${this.isMobile ? '16px' : '18px'};\">CURRENT SYSTEM</h3>\n            <div class=\"system-card\" style=\"background: rgba(0, 0, 0, 0.7); padding: 15px; border-radius: 5px; border: 1px solid #30cfd0; margin-bottom: 20px;\">\n                <div id=\"current-system-name\" style=\"font-size: ${this.isMobile ? '16px' : '18px'}; font-weight: bold; color: #fff; margin-bottom: 5px;\">Solar System</div>\n                <div id=\"current-system-class\" style=\"font-size: ${this.isMobile ? '12px' : '14px'}; color: #aaa; margin-bottom: 10px;\">Class G - Home System</div>\n                <div id=\"current-system-resources\" style=\"margin-bottom: 10px;\">\n                    <div style=\"display: flex; justify-content: space-between; margin-bottom: 5px;\">\n                        <span>Iron:</span>\n                        <div class=\"resource-indicator\" style=\"width: 100px; height: 8px; background: #333; border-radius: 4px; overflow: hidden;\">\n                            <div id=\"current-iron-indicator\" style=\"height: 100%; width: 50%; background: #aaa;\"></div>\n                        </div>\n                    </div>\n                    <div style=\"display: flex; justify-content: space-between; margin-bottom: 5px;\">\n                        <span>Gold:</span>\n                        <div class=\"resource-indicator\" style=\"width: 100px; height: 8px; background: #333; border-radius: 4px; overflow: hidden;\">\n                            <div id=\"current-gold-indicator\" style=\"height: 100%; width: 50%; background: #FFD700;\"></div>\n                        </div>\n                    </div>\n                    <div style=\"display: flex; justify-content: space-between;\">\n                        <span>Platinum:</span>\n                        <div class=\"resource-indicator\" style=\"width: 100px; height: 8px; background: #333; border-radius: 4px; overflow: hidden;\">\n                            <div id=\"current-platinum-indicator\" style=\"height: 100%; width: 50%; background: #E5E4E2;\"></div>\n                        </div>\n                    </div>\n                </div>\n                <div id=\"current-system-description\" style=\"font-size: ${this.isMobile ? '11px' : '12px'}; color: #ccc; margin-bottom: 10px;\">\n                    Our home system, with Earth as the starting location.\n                </div>\n                <div id=\"current-system-features\" style=\"font-size: ${this.isMobile ? '11px' : '12px'}; color: #30cfd0;\">\n                    Special Features: Earth\n                </div>\n            </div>\n        `;\n        return currentSystem;\n    }\n\n    createSelectedSystemSection(): HTMLElement {\n        const selectedSystem = document.createElement('div');\n        selectedSystem.id = 'selected-system-info';\n        selectedSystem.innerHTML = `\n            <h3 style=\"color: #30cfd0; font-size: ${this.isMobile ? '16px' : '18px'};\">SELECTED SYSTEM</h3>\n            <div id=\"selected-system-card\" class=\"system-card\" style=\"background: rgba(0, 0, 0, 0.7); padding: 15px; border-radius: 5px; border: 1px solid #555; margin-bottom: 20px;\">\n                <div class=\"empty-selection\" style=\"color: #777; text-align: center; padding: 20px;\">\n                    No system selected.<br>\n                    ${this.isMobile ? 'Tap' : 'Click'} on a star system in the map to select it.\n                </div>\n            </div>\n            <button id=\"travel-button\" disabled style=\"width: 100%; padding: ${this.isMobile ? '15px' : '12px'}; background-color: #30cfd0; color: #000; border: none; border-radius: 5px; cursor: not-allowed; font-family: 'Courier New', monospace; font-weight: bold; font-size: ${this.isMobile ? '18px' : '16px'}; opacity: 0.5;\">\n                TRAVEL TO SYSTEM\n            </button>\n        `;\n        return selectedSystem;\n    }\n\n    createCloseButton(): HTMLButtonElement {\n        const closeButton = document.createElement('button');\n        closeButton.id = 'close-star-map';\n        closeButton.textContent = 'RETURN TO STARGATE';\n        closeButton.style.width = '100%';\n        closeButton.style.padding = this.isMobile ? '15px' : '12px';\n        closeButton.style.marginTop = '20px';\n        closeButton.style.backgroundColor = '#555';\n        closeButton.style.color = '#fff';\n        closeButton.style.border = 'none';\n        closeButton.style.borderRadius = '5px';\n        closeButton.style.cursor = 'pointer';\n        closeButton.style.fontFamily = 'Courier New, monospace';\n        closeButton.style.fontWeight = 'bold';\n        closeButton.style.fontSize = this.isMobile ? '18px' : '16px';\n        \n        // Make the button more prominent on mobile\n        if (this.isMobile) {\n            closeButton.style.backgroundColor = '#30cfd0';\n            closeButton.style.color = '#000';\n            closeButton.style.boxShadow = '0 0 15px rgba(48, 207, 208, 0.7)';\n        }\n        \n        return closeButton;\n    }\n}\n","// starMap.js - Handles the star map UI for interstellar travel\n\nimport { MobileDetector } from '../../utils/mobileDetector.ts';\nimport { CanvasRenderer } from './starmap/canvasRenderer.js';\nimport { NavigationLogic } from './starmap/navigationLogic.js';\nimport { DataManager } from './starmap/dataManager.js';\nimport { UICreator } from './starmap/uiCreator.js';\n\n// Star system generator shape varies across game systems; use loose typing.\ntype StarSystemGenerator = any;\n\ntype DockingSystem = any;\n\ntype StargateInterfaceRef = {\n    showStargateUI?: () => void;\n};\n\ntype MapInteractionEvent = MouseEvent | Touch;\n\nexport class StarMap {\n    starSystemGenerator: StarSystemGenerator;\n    dockingSystem: DockingSystem | null;\n    stargateInterface: StargateInterfaceRef | null;\n    isVisible: boolean;\n    isMobile: boolean;\n    canvasRenderer: CanvasRenderer;\n    navigationLogic: NavigationLogic;\n    dataManager: DataManager;\n    uiCreator: UICreator;\n\n    constructor(starSystemGenerator: StarSystemGenerator | null | undefined, dockingSystem: DockingSystem | null, stargateInterface: StargateInterfaceRef | null) {\n        this.starSystemGenerator = starSystemGenerator;\n        this.dockingSystem = dockingSystem;\n        this.stargateInterface = stargateInterface;\n        this.isVisible = false;\n        this.isMobile = MobileDetector.isMobile();\n        \n        console.log(\"StarMap constructor - isMobile:\", this.isMobile);\n        \n        // Initialize component modules\n        this.canvasRenderer = new CanvasRenderer(this.isMobile);\n        this.navigationLogic = new NavigationLogic(starSystemGenerator as any, dockingSystem as any, stargateInterface as any);\n        this.dataManager = new DataManager(starSystemGenerator as any);\n        this.uiCreator = new UICreator(this.isMobile);\n        \n        // Create star map UI\n        this.uiCreator.setupStarMapUI();\n        \n        // Set event handlers\n        this.setupEventHandlers();\n    }\n    \n    \n    setupEventHandlers(): void {\n        // Close button\n        const closeButton = document.getElementById('close-star-map') as HTMLButtonElement | null;\n        if (closeButton) {\n            closeButton.addEventListener('click', () => {\n                if (window.game && window.game.audio) {\n                    window.game.audio.playSound('boink');\n                }\n                this.hide();\n            });\n            \n            // Add touch event for mobile\n            if (this.isMobile) {\n                closeButton.addEventListener('touchend', (e: TouchEvent) => {\n                    e.preventDefault();\n                    if (window.game && window.game.audio) {\n                        console.log(\"Mobile: Playing sound on star map close button\");\n                        window.game.audio.playSound('boink');\n                        // Give time for the sound to start before hiding\n                        setTimeout(() => this.hide(), 50);\n                    } else {\n                        this.hide();\n                    }\n                });\n            }\n        }\n        \n        // Canvas click/touch handler for selecting systems\n        const canvas = document.getElementById('star-map-canvas') as HTMLCanvasElement | null;\n        if (canvas) {\n            // Mouse events\n            canvas.addEventListener('click', (e: MouseEvent) => {\n                this.handleMapInteraction(e);\n            });\n            \n            // Touch events for mobile\n            if (this.isMobile) {\n                canvas.addEventListener('touchend', (e: TouchEvent) => {\n                    e.preventDefault();\n                    this.handleMapInteraction(e.changedTouches[0]);\n                });\n            }\n        }\n        \n        // Travel button\n        const travelButton = document.getElementById('travel-button') as HTMLButtonElement | null;\n        if (travelButton) {\n            const travelHandler = () => {\n                this.navigationLogic.handleTravel(() => this.hide());\n            };\n            \n            // Click event\n            travelButton.addEventListener('click', travelHandler);\n            \n            // Touch event for mobile\n            if (this.isMobile) {\n                travelButton.addEventListener('touchend', (e: TouchEvent) => {\n                    e.preventDefault();\n                    travelHandler();\n                });\n            }\n        }\n    }\n    \n    // Handler for map interactions (click or touch)\n    handleMapInteraction(event: MapInteractionEvent): void {\n        // Convert click/touch position to canvas coordinates\n        const canvas = document.getElementById('star-map-canvas') as HTMLCanvasElement | null;\n        if (!canvas) return;\n        const rect = canvas.getBoundingClientRect();\n        const x = (event.clientX - rect.left) * (canvas.width / rect.width);\n        const y = (event.clientY - rect.top) * (canvas.height / rect.height);\n        \n        // Check if a star system was clicked/tapped\n        const clickedSystem = this.canvasRenderer.findSystemAtPosition(x, y, this.starSystemGenerator);\n        if (clickedSystem) {\n            this.selectSystem(clickedSystem);\n            this.updateCanvas(); // Redraw to show selection\n        }\n    }\n    \n    // Select a system and update the UI\n    selectSystem(systemId: string | null): void {\n        this.navigationLogic.selectSystem(\n            systemId, \n            this.isMobile,\n            (system, isMobile) => this.dataManager.updateSelectedSystemInfo(system, isMobile),\n            (systemId, isCurrentSystem, isConnected) => this.dataManager.updateTravelButton(systemId, isCurrentSystem, isConnected)\n        );\n    }\n    \n    // Draw the star map on the canvas\n    updateCanvas(): void {\n        this.canvasRenderer.updateCanvas(this.starSystemGenerator);\n        // Update selected system drawing\n        const canvas = document.getElementById('star-map-canvas') as HTMLCanvasElement | null;\n        if (!canvas) return;\n        const context = canvas.getContext('2d');\n        if (!context) return;\n        this.canvasRenderer.drawSystems(\n            context,\n            250, 250, // center coordinates\n            this.dataManager.getAllSystems() as any,\n            this.dataManager.getCurrentSystem() as any,\n            this.navigationLogic.getSelectedSystem() as any\n        );\n    }\n    \n    // Update the current system information\n    updateCurrentSystemInfo(): void {\n        this.dataManager.updateCurrentSystemInfo(this.isMobile);\n    }\n    \n    // Show the star map\n    show(): void {\n        // Update the map with current data\n        this.updateCurrentSystemInfo();\n        this.updateCanvas();\n        \n        // Reset selection\n        this.selectSystem(null);\n        \n        // Force audio context resumption for mobile\n        if (this.isMobile && window.game && window.game.audio) {\n            // Play a sound to kickstart the audio context\n            setTimeout(() => {\n                console.log(\"Mobile: Attempting to play initial sound in StarMap\");\n                window.game.audio.playSound('boink');\n            }, 100);\n        }\n        \n        // Show the map\n        const starMap = document.getElementById('star-map') as HTMLDivElement | null;\n        if (starMap) {\n            starMap.style.display = 'block';\n            this.isVisible = true;\n        }\n    }\n    \n    // Hide the star map\n    hide(): void {\n        const starMap = document.getElementById('star-map') as HTMLDivElement | null;\n        if (starMap) {\n            starMap.style.display = 'none';\n            this.isVisible = false;\n            \n            // Show the stargate UI when returning from star map\n            if (this.stargateInterface?.showStargateUI) {\n                this.stargateInterface.showStargateUI();\n            } else if (window.game && window.game.ui && window.game.ui.stargateInterface) {\n                // Try to find stargate UI via game instance if direct reference fails\n                window.game.ui.stargateInterface.showStargateUI();\n            } else {\n                // Direct DOM access as last resort\n                const stargateUI = document.getElementById('stargate-ui') as HTMLDivElement | null;\n                if (stargateUI) {\n                    stargateUI.style.display = 'block';\n                }\n            }\n        }\n    }\n    \n    // Toggle map visibility\n    toggle(): void {\n        if (this.isVisible) {\n            this.hide();\n        } else {\n            this.show();\n        }\n    }\n} \n"],"names":["CanvasRenderer","isMobile","__publicField","starSystemGenerator","canvas","ctx","centerX","centerY","systems","currentSystem","connections","systemId","connectedSystems","system","x1","y1","connectedId","connectedSystem","x2","y2","currentSystemData","selectedSystem","x","y","isCurrent","isSelected","isConnected","radius","canvasX","canvasY","dx","dy","distance","NavigationLogic","_dockingSystem","_stargateInterface","updateSelectedSystemCallback","updateTravelButtonCallback","hideCallback","environment","success","systemName","notification","DataManager","_isMobile","systemNameEl","systemClassEl","ironIndicator","goldIndicator","platinumIndicator","descriptionEl","featuresEl","selectedCard","infoPanel","isCurrentSystem","travelButton","UICreator","starMap","title","content","mapContainer","closeButton","StarMap","dockingSystem","stargateInterface","MobileDetector","e","travelHandler","event","rect","clickedSystem","context","_a","stargateUI"],"mappings":"4OAeO,MAAMA,CAAe,CAGxB,YAAYC,EAAmB,CAFvBC,EAAA,iBAGJ,KAAK,SAAWD,CAAA,CAIpB,aAAaE,EAAgD,CACnD,MAAAC,EAAS,SAAS,eAAe,iBAAiB,EACxD,GAAI,CAACA,EAAQ,OAEP,MAAAC,EAAMD,EAAO,WAAW,IAAI,EAClC,GAAI,CAACC,EAAK,OAEVA,EAAI,UAAU,EAAG,EAAGD,EAAO,MAAOA,EAAO,MAAM,EAGzC,MAAAE,EAAUF,EAAO,MAAQ,EACzBG,EAAUH,EAAO,OAAS,EAG1BI,EAAUL,EAAoB,cAAc,EAC5CM,EAAgBN,EAAoB,cACpCO,EAAcP,EAAoB,UAGxC,KAAK,gBAAgBE,EAAKC,EAASC,EAASC,EAASE,CAAW,EAGhE,KAAK,6BAA6BL,EAAKC,EAASC,EAASC,EAASC,CAAa,EAG/E,KAAK,YAAYJ,EAAKC,EAASC,EAASC,EAASC,CAAa,CAAA,CAGlE,gBAAgBJ,EAA+BC,EAAiBC,EAAiBC,EAAqCE,EAA6C,CAC/JL,EAAI,UAAY,EAChBA,EAAI,YAAc,0BAElB,SAAW,CAACM,EAAUC,CAAgB,IAAK,OAAO,QAAQF,CAAW,EAAG,CAC9D,MAAAG,EAASL,EAAQG,CAAQ,EAC/B,GAAI,CAACE,EAAQ,SAGP,MAAAC,EAAKR,EAAUO,EAAO,SAAS,EAC/BE,EAAKR,EAAUM,EAAO,SAAS,EAErC,UAAWG,KAAeJ,EAAkB,CAClC,MAAAK,EAAkBT,EAAQQ,CAAW,EAC3C,GAAI,CAACC,EAAiB,SAGhB,MAAAC,EAAKZ,EAAUW,EAAgB,SAAS,EACxCE,EAAKZ,EAAUU,EAAgB,SAAS,EAG9CZ,EAAI,UAAU,EACVA,EAAA,OAAOS,EAAIC,CAAE,EACbV,EAAA,OAAOa,EAAIC,CAAE,EACjBd,EAAI,OAAO,CAAA,CACf,CACJ,CAGJ,6BAA6BA,EAA+BC,EAAiBC,EAAiBC,EAAqCC,EAA6B,CACxJ,GAAAA,GAAiBD,EAAQC,CAAa,EAAG,CACnC,MAAAW,EAAoBZ,EAAQC,CAAa,EACzCK,EAAKR,EAAUc,EAAkB,SAAS,EAC1CL,EAAKR,EAAUa,EAAkB,SAAS,EAE5Cf,EAAA,UAAY,KAAK,SAAW,EAAI,EACpCA,EAAI,YAAc,0BAEP,UAAAW,KAAeI,EAAkB,YAAa,CAC/C,MAAAH,EAAkBT,EAAQQ,CAAW,EAC3C,GAAI,CAACC,EAAiB,SAGhB,MAAAC,EAAKZ,EAAUW,EAAgB,SAAS,EACxCE,EAAKZ,EAAUU,EAAgB,SAAS,EAG9CZ,EAAI,UAAU,EACVA,EAAA,OAAOS,EAAIC,CAAE,EACbV,EAAA,OAAOa,EAAIC,CAAE,EACjBd,EAAI,OAAO,CAAA,CACf,CACJ,CAGJ,YAAYA,EAA+BC,EAAiBC,EAAiBC,EAAqCC,EAAuBY,EAAgC,KAAY,CAEjL,SAAW,CAACV,EAAUE,CAAM,IAAK,OAAO,QAAQL,CAAO,EAAG,CAEhD,MAAAc,EAAIhB,EAAUO,EAAO,SAAS,EAC9BU,EAAIhB,EAAUM,EAAO,SAAS,EAG9BW,EAAYb,IAAaF,EACzBgB,EAAad,IAAaU,EAC1BK,EAAcjB,GAAiBD,EAAQC,CAAa,GACtCD,EAAQC,CAAa,EAAE,YAAY,SAASE,CAAQ,EAGxEN,EAAI,UAAU,EAGV,IAAAsB,EACA,KAAK,SACIA,EAAAH,EAAY,GAAKC,EAAa,GAAK,GAEnCE,EAAAH,EAAY,GAAKC,EAAa,GAAK,EAIhDpB,EAAI,UAAYQ,EAAO,UAAY,IAAIA,EAAO,UAAU,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,CAAC,GAAK,UAGtFW,GAAaC,GACTpB,EAAA,WAAa,KAAK,SAAW,GAAK,GAClCA,EAAA,YAAcmB,EAAY,UAAY,WAE1CnB,EAAI,WAAa,EAIrBA,EAAI,IAAIiB,EAAGC,EAAGI,EAAQ,EAAG,KAAK,GAAK,CAAC,EACpCtB,EAAI,KAAK,EAGTA,EAAI,WAAa,EAGbqB,GAAe,CAACF,IAChBnB,EAAI,YAAc,UACdA,EAAA,UAAY,KAAK,SAAW,EAAI,EACpCA,EAAI,UAAU,EACVA,EAAA,IAAIiB,EAAGC,EAAGI,EAAS,EAAG,EAAG,KAAK,GAAK,CAAC,EACxCtB,EAAI,OAAO,GAIfA,EAAI,UAAYmB,EAAY,UAAYC,EAAa,UAAY,UAC7DpB,EAAA,KAAOmB,EACA,KAAK,SAAW,wBAA0B,wBAC1C,KAAK,SAAW,mBAAqB,mBAChDnB,EAAI,UAAY,SACZA,EAAA,SAASQ,EAAO,KAAMS,EAAGC,EAAII,GAAU,KAAK,SAAW,GAAK,GAAG,CAAA,CACvE,CAIJ,qBAAqBL,EAAWC,EAAWpB,EAAyD,CAC1F,MAAAK,EAAUL,EAAoB,cAAc,EAC5CM,EAAgBN,EAAoB,cAGpCG,EAAU,IACVC,EAAU,IAGhB,SAAW,CAACI,EAAUE,CAAM,IAAK,OAAO,QAAQL,CAAO,EAAG,CAEhD,MAAAoB,EAAUtB,EAAUO,EAAO,SAAS,EACpCgB,EAAUtB,EAAUM,EAAO,SAAS,EAGpCiB,EAAKR,EAAIM,EACTG,EAAKR,EAAIM,EACTG,EAAW,KAAK,KAAKF,EAAKA,EAAKC,EAAKA,CAAE,EAItCJ,EAAShB,IAAaF,EACb,KAAK,SAAW,GAAK,GACrB,KAAK,SAAW,GAAK,GACpC,GAAIuB,GAAYL,EACL,OAAAhB,CACX,CAGG,OAAA,IAAA,CAEf,CCpKO,MAAMsB,CAAgB,CAKzB,YAAY9B,EAA0C+B,EAA+BC,EAAuC,CAJpHjC,EAAA,4BACAA,EAAA,uBACAA,EAAA,oBAGJ,KAAK,oBAAsBC,EAC3B,KAAK,eAAiB,KACtB,KAAK,YAAc,EAAA,CAIvB,aACIQ,EACAV,EACAmC,EACAC,EACI,CAIJ,GAHQ,QAAA,IAAI,qBAAqB1B,CAAQ,EAAE,EAC3C,KAAK,eAAiBA,EAElB,CAACA,EAAU,CAEXyB,EAA6B,KAAMnC,CAAQ,EAChBoC,EAAA,KAAM,GAAO,EAAK,EAC7C,MAAA,CAIJ,MAAMxB,EAAS,KAAK,oBAAoB,cAAA,EAAgBF,CAAQ,EAC1DF,EAAgB,KAAK,oBAAoB,cAG/C2B,EAA6BvB,EAAQZ,CAAQ,EAG7C,MAAMyB,EAAc,KAAK,oBAAoB,4BAA4B,EAAE,SAASf,CAAQ,EAGjE0B,EAAA1B,EAFHA,IAAaF,EAEiBiB,CAAW,CAAA,CAIrE,aAAaY,EAAgC,CACzC,GAAI,KAAK,gBAAkB,KAAK,iBAAmB,KAAK,oBAAoB,cAAe,CACvF,QAAQ,IAAI,gCAAgC,KAAK,cAAc,EAAE,EAGjE,KAAK,YAAc,GAGNA,EAAA,EAGP,MAAAC,EAAe,OAAO,KAAa,YACrC,GAAAA,GAAeA,EAAY,eAAgB,CAC3C,MAAMC,EAAUD,EAAY,eAAe,KAAK,cAAc,EAC9D,QAAQ,IAAI,aAAa,KAAK,cAAc,eAAeC,CAAO,EAAE,EAGpE,WAAW,IAAM,CACb,KAAK,YAAc,IACpB,GAAI,CAAA,SAGS,KAAK,oBAAoB,eAAe,KAAK,cAAc,EAE9D,CAEJ,KAAA,aAAa,KAAM,GAAO,IAAM,CAAA,EAAI,IAAM,CAAA,CAAE,EAG3C,MAAApB,EAAoB,KAAK,oBAAoB,qBAAqB,EACpEA,GACK,KAAA,uBAAuBA,EAAkB,KAAM,EAAK,EAI7D,KAAK,YAAc,EAAA,CAE3B,CACJ,CAIJ,uBAAuBqB,EAAoBxC,EAAyB,CAE1D,MAAAyC,EAAe,SAAS,cAAc,KAAK,EACjDA,EAAa,MAAM,SAAW,QACjBA,EAAA,MAAM,IAAMzC,EAAW,MAAQ,MAC5CyC,EAAa,MAAM,KAAO,MAC1BA,EAAa,MAAM,UAAY,wBAC/BA,EAAa,MAAM,gBAAkB,qBACrCA,EAAa,MAAM,MAAQ,UACdA,EAAA,MAAM,QAAUzC,EAAW,YAAc,YACtDyC,EAAa,MAAM,aAAe,OAClCA,EAAa,MAAM,OAAS,oBAC5BA,EAAa,MAAM,UAAY,mBAC/BA,EAAa,MAAM,WAAa,yBACnBA,EAAA,MAAM,SAAWzC,EAAW,OAAS,OAClDyC,EAAa,MAAM,WAAa,OAChCA,EAAa,MAAM,OAAS,OAC5BA,EAAa,MAAM,UAAY,SAClBA,EAAA,YAAc,cAAcD,CAAU,GAG1C,SAAA,KAAK,YAAYC,CAAY,EAGtC,WAAW,IAAM,CACbA,EAAa,MAAM,QAAU,IAC7BA,EAAa,MAAM,WAAa,aAEhC,WAAW,IAAM,CACbA,EAAa,OAAO,GACrB,GAAI,GACR,GAAI,CAAA,CAGX,mBAAmC,CAC/B,OAAO,KAAK,cAAA,CAGhB,qBAA+B,CAC3B,OAAO,KAAK,WAAA,CAEpB,CC5IO,MAAMC,CAAY,CAGrB,YAAYxC,EAA0C,CAF9CD,EAAA,4BAGJ,KAAK,oBAAsBC,CAAA,CAI/B,wBAAwByC,EAA0B,CACxC,MAAA/B,EAAS,KAAK,oBAAoB,qBAAqB,EAC7D,GAAI,CAACA,EAAQ,OAGP,MAAAgC,EAAe,SAAS,eAAe,qBAAqB,EAC5DC,EAAgB,SAAS,eAAe,sBAAsB,EAChED,IAA2BA,EAAA,YAAchC,EAAO,MAChDiC,IACAA,EAAc,YAAc,SAASjC,EAAO,SAAS,MAAMA,EAAO,cAAc,IAI9E,MAAAkC,EAAgB,SAAS,eAAe,wBAAwB,EAChEC,EAAgB,SAAS,eAAe,wBAAwB,EAChEC,EAAoB,SAAS,eAAe,4BAA4B,EAE1EF,IACAA,EAAc,MAAM,MAAQ,GAAGlC,EAAO,oBAAoB,KAAO,EAAE,KAEnEmC,IACAA,EAAc,MAAM,MAAQ,GAAGnC,EAAO,oBAAoB,KAAO,EAAE,KAEnEoC,IACAA,EAAkB,MAAM,MAAQ,GAAGpC,EAAO,oBAAoB,SAAW,EAAE,KAIzE,MAAAqC,EAAgB,SAAS,eAAe,4BAA4B,EACpEC,EAAa,SAAS,eAAe,yBAAyB,EAChED,IAA6BA,EAAA,YAAcrC,EAAO,aAClDsC,IACAA,EAAW,YAAc,qBAAqBtC,EAAO,gBAAgB,KAAK,IAAI,CAAC,GACnF,CAIJ,yBAAyBA,EAA2BZ,EAAyB,CACnE,MAAAmD,EAAe,SAAS,eAAe,sBAAsB,EACnE,GAAKA,EAEL,IAAI,CAACvC,EAAQ,CAETuC,EAAa,UAAY;AAAA;AAAA,6CAEQnD,EAAW,MAAQ,OAAO;AAAA;AAAA,cAG3D,MAAA,CAmCJ,GAhCAmD,EAAa,UAAY;AAAA,+DAC8BnD,EAAW,OAAS,MAAM,0DAA0DY,EAAO,IAAI;AAAA,gEAC9FZ,EAAW,OAAS,MAAM,8CAA8CY,EAAO,SAAS,MAAMA,EAAO,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,2DAKxHA,EAAO,oBAAoB,KAAO,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2DAMpCA,EAAO,oBAAoB,KAAO,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2DAMpCA,EAAO,oBAAoB,SAAW,EAAE;AAAA;AAAA;AAAA;AAAA,qCAI9DZ,EAAW,OAAS,MAAM;AAAA,kBAC7CY,EAAO,WAAW;AAAA;AAAA,qCAECZ,EAAW,OAAS,MAAM;AAAA,oCAC3BY,EAAO,gBAAgB,KAAK,IAAI,CAAC;AAAA;AAAA,UAKzDZ,EAAU,CACJ,MAAAoD,EAAY,SAAS,eAAe,mBAAmB,EACzDA,GAAaD,IACHC,EAAA,UAAYD,EAAa,UAAYC,EAAU,UAC7D,EACJ,CAIJ,mBAAmB1C,EAAyB2C,EAA0B5B,EAA4B,CACxF,MAAA6B,EAAe,SAAS,eAAe,eAAe,EAC5D,GAAKA,EAEL,IAAI,CAAC5C,EAAU,CAEX4C,EAAa,SAAW,GACxBA,EAAa,MAAM,OAAS,cAC5BA,EAAa,MAAM,QAAU,MAC7BA,EAAa,YAAc,mBAC3B,MAAA,CAGSA,EAAA,SAAWD,GAAmB,CAAC5B,EAC5C6B,EAAa,MAAM,OAASD,GAAmB,CAAC5B,EAAc,cAAgB,UAC9E6B,EAAa,MAAM,QAAUD,GAAmB,CAAC5B,EAAc,MAAQ,IAGvE6B,EAAa,YAAcD,EAAkB,mBAClB5B,EAAkC,mBAApB,kBAAoB,CAGjE,sBAA0C,CAC/B,OAAA,KAAK,oBAAoB,qBAAqB,CAAA,CAGzD,eAA4C,CACjC,OAAA,KAAK,oBAAoB,cAAc,CAAA,CAGlD,kBAA2B,CACvB,OAAO,KAAK,oBAAoB,aAAA,CAExC,CCxJO,MAAM8B,CAAU,CAGnB,YAAYvD,EAAmB,CAFvBC,EAAA,iBAGJ,KAAK,SAAWD,CAAA,CAIpB,gBAAuB,CAEb,MAAAwD,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,GAAK,WACbA,EAAQ,MAAM,SAAW,WACzBA,EAAQ,MAAM,IAAM,MACpBA,EAAQ,MAAM,KAAO,MACrBA,EAAQ,MAAM,UAAY,wBAGtB,KAAK,UACLA,EAAQ,MAAM,MAAQ,MACtBA,EAAQ,MAAM,OAAS,OACvBA,EAAQ,MAAM,UAAY,UAE1BA,EAAQ,MAAM,MAAQ,QACtBA,EAAQ,MAAM,OAAS,SAG3BA,EAAQ,MAAM,gBAAkB,yBAChCA,EAAQ,MAAM,MAAQ,OACtBA,EAAQ,MAAM,QAAU,KAAK,SAAW,OAAS,OACjDA,EAAQ,MAAM,aAAe,OAC7BA,EAAQ,MAAM,OAAS,oBACvBA,EAAQ,MAAM,UAAY,mBAC1BA,EAAQ,MAAM,WAAa,yBAC3BA,EAAQ,MAAM,OAAS,OACvBA,EAAQ,MAAM,QAAU,OACxBA,EAAQ,MAAM,SAAW,SAGnB,MAAAC,EAAQ,SAAS,cAAc,IAAI,EACzCA,EAAM,YAAc,WACpBA,EAAM,MAAM,UAAY,SACxBA,EAAM,MAAM,MAAQ,UACpBA,EAAM,MAAM,OAAS,aACrBA,EAAM,MAAM,SAAW,KAAK,SAAW,OAAS,OAChDD,EAAQ,YAAYC,CAAK,EAGnB,MAAAC,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,MAAM,QAAU,OACxBA,EAAQ,MAAM,cAAgB,KAAK,SAAW,SAAW,MACzDA,EAAQ,MAAM,OAAS,KAAK,SAAW,qBAAuB,qBAC9DA,EAAQ,MAAM,IAAM,KAAK,SAAW,OAAS,IAGvC,MAAAC,EAAe,KAAK,mBAAmB,EAGvCP,EAAY,KAAK,gBAAgB,EAGvCM,EAAQ,YAAYC,CAAY,EAChCD,EAAQ,YAAYN,CAAS,EAC7BI,EAAQ,YAAYE,CAAO,EAGrB,MAAAE,EAAc,KAAK,kBAAkB,EAC3CJ,EAAQ,YAAYI,CAAW,EAGtB,SAAA,KAAK,YAAYJ,CAAO,CAAA,CAGrC,oBAAkC,CACxB,MAAAG,EAAe,SAAS,cAAc,KAAK,EACjDA,EAAa,GAAK,kBAClBA,EAAa,MAAM,KAAO,IAC1BA,EAAa,MAAM,WAAa,qBAChCA,EAAa,MAAM,aAAe,OAClCA,EAAa,MAAM,OAAS,oBAC5BA,EAAa,MAAM,SAAW,WAC9BA,EAAa,MAAM,SAAW,SAC9BA,EAAa,MAAM,OAAS,KAAK,SAAW,MAAQ,OACpDA,EAAa,MAAM,UAAY,KAAK,SAAW,QAAU,OAGnD,MAAAxD,EAAS,SAAS,cAAc,QAAQ,EAC9C,OAAAA,EAAO,GAAK,kBACZA,EAAO,MAAQ,IACfA,EAAO,OAAS,IAChBA,EAAO,MAAM,MAAQ,OACrBA,EAAO,MAAM,OAAS,OACtBwD,EAAa,YAAYxD,CAAM,EAExBwD,CAAA,CAGX,iBAA+B,CACrB,MAAAP,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,GAAK,oBACfA,EAAU,MAAM,MAAQ,KAAK,SAAW,OAAS,QACjDA,EAAU,MAAM,WAAa,KAAK,SAAW,IAAM,OACnDA,EAAU,MAAM,UAAY,OAC5BA,EAAU,MAAM,OAAS,KAAK,SAAW,MAAQ,OAChDA,EAAU,MAAc,wBAA0B,QAG7C,MAAA5C,EAAgB,KAAK,2BAA2B,EACtD4C,EAAU,YAAY5C,CAAa,EAG7B,MAAAY,EAAiB,KAAK,4BAA4B,EACxD,OAAAgC,EAAU,YAAYhC,CAAc,EAE7BgC,CAAA,CAGX,4BAA0C,CAChC,MAAA5C,EAAgB,SAAS,cAAc,KAAK,EAClD,OAAAA,EAAc,GAAK,sBACnBA,EAAc,UAAY;AAAA,mEACiC,KAAK,SAAW,OAAS,MAAM;AAAA;AAAA,kEAEhC,KAAK,SAAW,OAAS,MAAM;AAAA,mEAC9B,KAAK,SAAW,OAAS,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yEAqBzB,KAAK,SAAW,OAAS,MAAM;AAAA;AAAA;AAAA,sEAGlC,KAAK,SAAW,OAAS,MAAM;AAAA;AAAA;AAAA;AAAA,UAKtFA,CAAA,CAGX,6BAA2C,CACjC,MAAAY,EAAiB,SAAS,cAAc,KAAK,EACnD,OAAAA,EAAe,GAAK,uBACpBA,EAAe,UAAY;AAAA,oDACiB,KAAK,SAAW,OAAS,MAAM;AAAA;AAAA;AAAA;AAAA,sBAI7D,KAAK,SAAW,MAAQ,OAAO;AAAA;AAAA;AAAA,+EAG0B,KAAK,SAAW,OAAS,MAAM,yKAAyK,KAAK,SAAW,OAAS,MAAM;AAAA;AAAA;AAAA,UAIvSA,CAAA,CAGX,mBAAuC,CAC7B,MAAAwC,EAAc,SAAS,cAAc,QAAQ,EACnD,OAAAA,EAAY,GAAK,iBACjBA,EAAY,YAAc,qBAC1BA,EAAY,MAAM,MAAQ,OAC1BA,EAAY,MAAM,QAAU,KAAK,SAAW,OAAS,OACrDA,EAAY,MAAM,UAAY,OAC9BA,EAAY,MAAM,gBAAkB,OACpCA,EAAY,MAAM,MAAQ,OAC1BA,EAAY,MAAM,OAAS,OAC3BA,EAAY,MAAM,aAAe,MACjCA,EAAY,MAAM,OAAS,UAC3BA,EAAY,MAAM,WAAa,yBAC/BA,EAAY,MAAM,WAAa,OAC/BA,EAAY,MAAM,SAAW,KAAK,SAAW,OAAS,OAGlD,KAAK,WACLA,EAAY,MAAM,gBAAkB,UACpCA,EAAY,MAAM,MAAQ,OAC1BA,EAAY,MAAM,UAAY,oCAG3BA,CAAA,CAEf,CCtLO,MAAMC,CAAQ,CAWjB,YAAY3D,EAA6D4D,EAAqCC,EAAgD,CAV9J9D,EAAA,4BACAA,EAAA,sBACAA,EAAA,0BACAA,EAAA,kBACAA,EAAA,iBACAA,EAAA,uBACAA,EAAA,wBACAA,EAAA,oBACAA,EAAA,kBAGI,KAAK,oBAAsBC,EAC3B,KAAK,cAAgB4D,EACrB,KAAK,kBAAoBC,EACzB,KAAK,UAAY,GACZ,KAAA,SAAWC,EAAe,SAAS,EAEhC,QAAA,IAAI,kCAAmC,KAAK,QAAQ,EAG5D,KAAK,eAAiB,IAAIjE,EAAe,KAAK,QAAQ,EACtD,KAAK,gBAAkB,IAAIiC,EAAgB9B,EAA4B4D,EAAsBC,CAAwB,EAChH,KAAA,YAAc,IAAIrB,EAAYxC,CAA0B,EAC7D,KAAK,UAAY,IAAIqD,EAAU,KAAK,QAAQ,EAG5C,KAAK,UAAU,eAAe,EAG9B,KAAK,mBAAmB,CAAA,CAI5B,oBAA2B,CAEjB,MAAAK,EAAc,SAAS,eAAe,gBAAgB,EACxDA,IACYA,EAAA,iBAAiB,QAAS,IAAM,CACpC,OAAO,MAAQ,OAAO,KAAK,OACpB,OAAA,KAAK,MAAM,UAAU,OAAO,EAEvC,KAAK,KAAK,CAAA,CACb,EAGG,KAAK,UACOA,EAAA,iBAAiB,WAAaK,GAAkB,CACxDA,EAAE,eAAe,EACb,OAAO,MAAQ,OAAO,KAAK,OAC3B,QAAQ,IAAI,gDAAgD,EACrD,OAAA,KAAK,MAAM,UAAU,OAAO,EAEnC,WAAW,IAAM,KAAK,KAAK,EAAG,EAAE,GAEhC,KAAK,KAAK,CACd,CACH,GAKH,MAAA9D,EAAS,SAAS,eAAe,iBAAiB,EACpDA,IAEOA,EAAA,iBAAiB,QAAU8D,GAAkB,CAChD,KAAK,qBAAqBA,CAAC,CAAA,CAC9B,EAGG,KAAK,UACE9D,EAAA,iBAAiB,WAAa8D,GAAkB,CACnDA,EAAE,eAAe,EACjB,KAAK,qBAAqBA,EAAE,eAAe,CAAC,CAAC,CAAA,CAChD,GAKH,MAAAX,EAAe,SAAS,eAAe,eAAe,EAC5D,GAAIA,EAAc,CACd,MAAMY,EAAgB,IAAM,CACxB,KAAK,gBAAgB,aAAa,IAAM,KAAK,MAAM,CACvD,EAGaZ,EAAA,iBAAiB,QAASY,CAAa,EAGhD,KAAK,UACQZ,EAAA,iBAAiB,WAAaW,GAAkB,CACzDA,EAAE,eAAe,EACHC,EAAA,CAAA,CACjB,CACL,CACJ,CAIJ,qBAAqBC,EAAkC,CAE7C,MAAAhE,EAAS,SAAS,eAAe,iBAAiB,EACxD,GAAI,CAACA,EAAQ,OACP,MAAAiE,EAAOjE,EAAO,sBAAsB,EACpCkB,GAAK8C,EAAM,QAAUC,EAAK,OAASjE,EAAO,MAAQiE,EAAK,OACvD9C,GAAK6C,EAAM,QAAUC,EAAK,MAAQjE,EAAO,OAASiE,EAAK,QAGvDC,EAAgB,KAAK,eAAe,qBAAqBhD,EAAGC,EAAG,KAAK,mBAAmB,EACzF+C,IACA,KAAK,aAAaA,CAAa,EAC/B,KAAK,aAAa,EACtB,CAIJ,aAAa3D,EAA+B,CACxC,KAAK,gBAAgB,aACjBA,EACA,KAAK,SACL,CAACE,EAAQZ,IAAa,KAAK,YAAY,yBAAyBY,EAAQZ,CAAQ,EAChF,CAACU,EAAU2C,EAAiB5B,IAAgB,KAAK,YAAY,mBAAmBf,EAAU2C,EAAiB5B,CAAW,CAC1H,CAAA,CAIJ,cAAqB,CACZ,KAAA,eAAe,aAAa,KAAK,mBAAmB,EAEnD,MAAAtB,EAAS,SAAS,eAAe,iBAAiB,EACxD,GAAI,CAACA,EAAQ,OACP,MAAAmE,EAAUnE,EAAO,WAAW,IAAI,EACjCmE,GACL,KAAK,eAAe,YAChBA,EACA,IAAK,IACL,KAAK,YAAY,cAAc,EAC/B,KAAK,YAAY,iBAAiB,EAClC,KAAK,gBAAgB,kBAAkB,CAC3C,CAAA,CAIJ,yBAAgC,CACvB,KAAA,YAAY,wBAAwB,KAAK,QAAQ,CAAA,CAI1D,MAAa,CAET,KAAK,wBAAwB,EAC7B,KAAK,aAAa,EAGlB,KAAK,aAAa,IAAI,EAGlB,KAAK,UAAY,OAAO,MAAQ,OAAO,KAAK,OAE5C,WAAW,IAAM,CACb,QAAQ,IAAI,qDAAqD,EAC1D,OAAA,KAAK,MAAM,UAAU,OAAO,GACpC,GAAG,EAIJ,MAAAd,EAAU,SAAS,eAAe,UAAU,EAC9CA,IACAA,EAAQ,MAAM,QAAU,QACxB,KAAK,UAAY,GACrB,CAIJ,MAAa,OACH,MAAAA,EAAU,SAAS,eAAe,UAAU,EAClD,GAAIA,EAKI,GAJJA,EAAQ,MAAM,QAAU,OACxB,KAAK,UAAY,IAGbe,EAAA,KAAK,oBAAL,MAAAA,EAAwB,eACxB,KAAK,kBAAkB,eAAe,UAC/B,OAAO,MAAQ,OAAO,KAAK,IAAM,OAAO,KAAK,GAAG,kBAEhD,OAAA,KAAK,GAAG,kBAAkB,eAAe,MAC7C,CAEG,MAAAC,EAAa,SAAS,eAAe,aAAa,EACpDA,IACAA,EAAW,MAAM,QAAU,QAC/B,CAER,CAIJ,QAAe,CACP,KAAK,UACL,KAAK,KAAK,EAEV,KAAK,KAAK,CACd,CAER"}