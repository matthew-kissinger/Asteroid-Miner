var x=Object.defineProperty;var S=(c,e,s)=>e in c?x(c,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[e]=s;var l=(c,e,s)=>S(c,typeof e!="symbol"?e+"":e,s);import{aa as v,ab as T,ac as I,V as A,C as z,N as H,a as B}from"./three-DBvJLP14.js";class E{constructor(e){l(this,"scene");l(this,"asteroids");l(this,"innerRadius");l(this,"outerRadius");l(this,"width");l(this,"resourceMultipliers");this.scene=e,this.asteroids=[],this.innerRadius=2e4,this.outerRadius=28e3,this.width=1800,this.resourceMultipliers={iron:1,gold:1,platinum:1},this.createAsteroidBelt()}createAsteroidBelt(){for(let s=0;s<1e3;s++){const o=Math.random()*120+120;let i;const r=Math.floor(Math.random()*3);r===0?i=new v(o,0):r===1?i=new T(o,0):i=new I(o,0);const n=i.attributes.position;for(let b=0;b<n.count;b++){const u=new A;u.fromBufferAttribute(n,b),u.x+=(Math.random()-.5)*.4*o,u.y+=(Math.random()-.5)*.4*o,u.z+=(Math.random()-.5)*.4*o,n.setXYZ(b,u.x,u.y,u.z)}i.computeVertexNormals();const a=new z,p=Math.random();let t=null;p<.7?(a.setHSL(.02,.3,.35+Math.random()*.2),t="iron"):p<.93?(a.setHSL(.12,.7,.5+Math.random()*.2),t="gold"):(a.setHSL(.1,.3,.7+Math.random()*.15),t="platinum");const f=new H({color:a,roughness:.6+Math.random()*.2,metalness:.4+Math.random()*.4,flatShading:!0,emissive:a.clone().multiplyScalar(.3),emissiveIntensity:.2}),h=new B(i,f),m=Math.random()*Math.PI*2,d=this.innerRadius+Math.random()*(this.outerRadius-this.innerRadius),M=(Math.random()-.5)*this.width;h.position.set(Math.cos(m)*d,M,Math.sin(m)*d),h.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI);const R=5e-5+Math.random()*5e-5,y=d,w=Math.random()*Math.PI*.15;this.scene.add(h);const g=50+Math.random()*50;this.asteroids.push({mesh:h,size:o,orbitSpeed:R,orbitRadius:y,orbitAngle:m,orbitTilt:w,initialHeight:M,rotationSpeed:{x:(Math.random()-.5)*.005,y:(Math.random()-.5)*.005,z:(Math.random()-.5)*.005},resourceType:t,baseResourceAmount:g,resourceAmount:g,maxResourceAmount:g,minable:!0})}}getRegionInfo(){return{center:new A(0,0,0),innerRadius:this.innerRadius,outerRadius:this.outerRadius}}getAsteroids(){return this.asteroids}setResourceMultipliers(e){e&&(this.resourceMultipliers=e,this.updateAsteroidResources(),console.log("Updated asteroid belt with resource multipliers:",e))}updateAsteroidResources(){this.asteroids.forEach(e=>{if(e.resourceType)switch(e.resourceType){case"iron":e.resourceAmount=e.baseResourceAmount*this.resourceMultipliers.iron;break;case"gold":e.resourceAmount=e.baseResourceAmount*this.resourceMultipliers.gold;break;case"platinum":e.resourceAmount=e.baseResourceAmount*this.resourceMultipliers.platinum;break}})}updateForSystem(e){e&&(e.asteroidDensity&&this.updateDensity(e.asteroidDensity),e.resourceMultipliers&&this.setResourceMultipliers(e.resourceMultipliers))}updateDensity(e=1){e<.5&&(e=.5),e>3&&(e=3),this.asteroids.forEach((s,o)=>{const i=o%10<e*5;s.mesh.visible=i,s.minable=i})}findClosestAsteroid(e,s=1600){let o=null,i=s;return this.asteroids.forEach(r=>{if(!r.minable||!r.mesh.visible)return;const n=e.distanceTo(r.mesh.position);n<i&&(i=n,o=r)}),o}removeAsteroid(e){var i,r,n,a,p;this.scene.remove(e.mesh),e.mesh.geometry&&e.mesh.geometry.dispose();const s=e.mesh.material;if(s)if(Array.isArray(s))s.forEach(t=>{var f,h,m,d,M;t.map&&((f=t.map)==null||f.dispose()),t.emissiveMap&&((h=t.emissiveMap)==null||h.dispose()),t.normalMap&&((m=t.normalMap)==null||m.dispose()),t.roughnessMap&&((d=t.roughnessMap)==null||d.dispose()),t.metalnessMap&&((M=t.metalnessMap)==null||M.dispose()),t.dispose()});else{const t=s;(i=t.map)==null||i.dispose(),(r=t.emissiveMap)==null||r.dispose(),(n=t.normalMap)==null||n.dispose(),(a=t.roughnessMap)==null||a.dispose(),(p=t.metalnessMap)==null||p.dispose(),t.dispose()}const o=this.asteroids.findIndex(t=>t===e);o!==-1&&this.asteroids.splice(o,1)}update(e=.016){this.asteroids.forEach(s=>{s.mesh.rotation.x+=s.rotationSpeed.x,s.mesh.rotation.y+=s.rotationSpeed.y,s.mesh.rotation.z+=s.rotationSpeed.z,s.orbitAngle+=s.orbitSpeed;const o=Math.cos(s.orbitAngle)*s.orbitRadius,i=Math.sin(s.orbitAngle)*s.orbitRadius;if(s.orbitTilt){const r=i*Math.sin(s.orbitTilt),n=i*Math.cos(s.orbitTilt);s.mesh.position.x=o,s.mesh.position.z=n,s.mesh.position.y=r+s.initialHeight}else s.mesh.position.x=o,s.mesh.position.z=i,s.mesh.position.y=s.initialHeight})}dispose(){for(;this.asteroids.length>0;){const e=this.asteroids[0];this.removeAsteroid(e)}this.asteroids=[]}}export{E as AsteroidBelt};
//# sourceMappingURL=asteroidBelt-DcXBFntH.js.map
