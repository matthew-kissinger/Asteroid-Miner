{"version":3,"mappings":"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","names":["Skybox","scene","__publicField","THREE.TextureLoader","THREE.SRGBColorSpace","params","texturePath","adjustedTexturePath","location","starDensity","nebulaDensity","skyboxColor","brightness","size","skyboxTexture","skyMaterial","THREE.ShaderMaterial","THREE.Color","THREE.BackSide","skyboxGeometry","THREE.BoxGeometry","THREE.Mesh","deltaTime","camera","SunShaders","THREE.FrontSide","THREE.Vector3","THREE.AdditiveBlending","SunFlares","_scene","sunGroup","flareTextures","textureLoader","mainFlareTexture","mainFlare","THREE.Sprite","THREE.SpriteMaterial","flareCount","radius","i","textureIndex","flareTexture","flare","angle","x","y","smallFlareTexture","smallFlare","farRadius","farAngle","farX","farY","smallSize","color","index","flareColor","time","viewVector","pulseSpeed","pulseFactor","mainScale","originalSize","orbit","orbitSpeed","angleToCam","opacity","reducedOpacity","SunLighting","lightingManager","THREE.PointLight","_starType","temperature","lightIntensityMultiplier","baseIntensity","tempFactor","blendedColor","warmWhite","_deltaTime","sunType","intensityMultiplier","typeBonus","enabled","Sun","THREE.Group","sunGeometry","THREE.SphereGeometry","sunCoreMesh","coronaGeometry","coronaMesh","outerCoronaGeometry","outerCoronaMesh","type","activity","coronaColor","outerCoronaColor","PlanetGenerator","systemId","starSystemGenerator","customPlanets","planet","prefixes","suffixes","starClass","planetCount","planetData","sizeMultiplier","distanceMultiplier","colorPalette","prefix","suffix","name","sizeClass","baseDistance","distanceVariation","distance","speed","rings","axialTilt","orbitalTilt","planetTextures","proceduralTextures","texture","PlanetMaterials","adjustedTextureUrl","customTexture","THREE.MeshStandardMaterial","THREE.DoubleSide","PlanetFactory","planetGeometry","planetMaterial","planetMesh","ringMesh","ringGeometry","THREE.RingGeometry","ringMaterial","Planets","solarSystemPlanets","generatedPlanets","planetObj","region","Stargate","stargateGroup","THREE.TorusGeometry","ring","createAccentRing","tubeRadius","position","rotation","geometry","material","accentRing","outerRing1","outerRing2","innerRing","detailsGroup","parentGroup","innerStructure","thinRingGeometry","thinRingMaterial","portalShaderMaterial","THREE.Vector2","portalGeometry","THREE.CircleGeometry","portal","portalLight","createPortalWisps","wispGeometry","wispMaterial","wisp","createNeonAccent","accentGroup","beamGeometry","THREE.CylinderGeometry","beamMaterial","beam","light","lightMesh","flicker","particle","pulse","STAR_CLASSES","SYSTEM_CLASSIFICATIONS","SKYBOX_TEXTURES","RESOURCE_DISTRIBUTION","CLASSIFICATION_MULTIPLIERS","STAR_COLORS","SKYBOX_COLORS","SystemNames","number","classification","features","starDescriptions","classDescriptions","SystemUtils","weights","total","sum","weight","random","min","max","SystemFactory","id","starColor","resourceMult","baseDistribution","classMultiplier","systemData","_a","_b","_c","_d","StarSystemGenerator","count","systemIds","solarConnections","targetId","extraConnectionCount","sourceId","targetSystemId","game","currentParams","targetParams","exceptId","selected","customSystem","randomSystem","standardizedPlanets","dockingSystem","SceneInitializer","AsteroidBelt","__vitePreload","SpaceAnomalies","SystemTransition","CustomSystemCreator","spaceship","VibeVersePortals","RegionManager","sun","stargate","planets","error","stargateRegion","asteroidBelt","spaceAnomalies","asteroidBeltRegion","anomaliesRegion","playerPosition","asteroids","componentsLoaded","stargateCenter","distanceToStargate","closestAnomaly","anomalyType","orbStatus","regionCenter","nearbyAsteroids","asteroid","sunRegion","sunCenter","distanceToSun","SystemTransitionManager","resources","systemTransition","updateEnvironmentCallback","skybox","regionManager","solarSystemParams","system","notification","Environment","essentialComponents","remainingComponents","maxDistance","anomaly"],"ignoreList":[],"sources":["../../js/modules/environment/skybox.ts","../../js/modules/environment/sun/sunShaders.ts","../../js/modules/environment/sun/sunFlares.ts","../../js/modules/environment/sun/sunLighting.ts","../../js/modules/environment/sun.ts","../../js/modules/environment/planets/planetGenerator.ts","../../js/modules/environment/planets/planetTextures.ts","../../js/modules/environment/planets/planetMaterials.ts","../../js/modules/environment/planets/planetFactory.ts","../../js/modules/environment/planets.ts","../../js/modules/environment/stargate.ts","../../js/modules/environment/generator/systemConfig.ts","../../js/modules/environment/generator/systemNames.ts","../../js/modules/environment/generator/systemUtils.ts","../../js/modules/environment/generator/systemFactory.ts","../../js/modules/environment/starSystemGenerator.ts","../../js/modules/environment/core/sceneInitializer.ts","../../js/modules/environment/core/regionManager.ts","../../js/modules/environment/core/systemTransitionManager.ts","../../js/modules/environment.ts"],"sourcesContent":["// skybox.ts - Creates and manages advanced procedural skybox with volumetric effects\n\nimport * as THREE from 'three';\n\ninterface SkyboxParams {\n    starDensity?: number;\n    nebulaDensity?: number;\n    color?: number;\n    texturePath?: string;\n    brightness?: number;\n    resetTime?: boolean;\n    isSolarSystem?: boolean;\n}\n\nexport class Skybox {\n    scene: THREE.Scene;\n    skybox: THREE.Mesh<THREE.BoxGeometry, THREE.ShaderMaterial> | null;\n    time: number;\n    textureLoader: THREE.TextureLoader;\n    milkyWayTexture: THREE.Texture;\n    skyboxTextures: Record<string, THREE.Texture>;\n    solarSystemParams: Required<Pick<SkyboxParams, 'starDensity' | 'nebulaDensity' | 'color' | 'texturePath' | 'brightness'>>;\n    skyMaterial?: THREE.ShaderMaterial;\n\n    constructor(scene: THREE.Scene) {\n        this.scene = scene;\n        this.skybox = null;\n        this.time = 0;\n\n        // Create texture loader\n        this.textureLoader = new THREE.TextureLoader();\n\n        // Load the Milky Way texture\n        this.milkyWayTexture = this.textureLoader.load('./assets/2k_stars_milky_way.jpg');\n        this.milkyWayTexture.colorSpace = THREE.SRGBColorSpace;\n\n        // Store additional skybox textures\n        this.skyboxTextures = {};\n\n        // Store initial parameters for the Solar System\n        this.solarSystemParams = {\n            starDensity: 1.0,\n            nebulaDensity: 0.5,\n            color: 0xFFFFFF,\n            texturePath: './assets/2k_stars_milky_way.jpg',\n            brightness: 1.0 // Default brightness for Solar System\n        };\n\n        this.createProceduralSkybox(this.solarSystemParams);\n    }\n\n    // Update skybox based on star system parameters\n    updateForSystem(params?: SkyboxParams): void {\n        if (!params) return;\n\n        console.log(\"Updating skybox with parameters:\", params);\n\n        // Special case for Solar System - ensure consistent appearance\n        if (params.isSolarSystem ||\n            (params.color === 0xFFFFFF && params.starDensity === 1.0 && params.nebulaDensity === 0.5)) {\n            console.log(\"Detected Solar System skybox parameters, using stored solar system configuration\");\n            params = this.solarSystemParams;\n        }\n\n        // Remove existing skybox\n        if (this.skybox) {\n            console.log(\"Removing existing skybox\");\n            this.scene.remove(this.skybox);\n        }\n\n        // Reset time for consistent star pattern\n        if (params.resetTime) {\n            this.time = 0;\n        }\n\n        // Create new skybox with system parameters\n        this.createProceduralSkybox(params);\n    }\n\n    // Load texture if needed and return it\n    getTexture(texturePath?: string): THREE.Texture {\n        // Use default Milky Way texture if none specified\n        if (!texturePath) {\n            return this.milkyWayTexture;\n        }\n\n        // Return Milky Way texture for the default Solar System texture\n        if (texturePath === './assets/2k_stars_milky_way.jpg') {\n            return this.milkyWayTexture;\n        }\n\n        // Fix texture path for API server images\n        let adjustedTexturePath = texturePath;\n\n        // Check if this is an image from our API server\n        if (texturePath.startsWith('/images/')) {\n            const location = (window as any).location as Location | undefined;\n            if (location?.port === '8000') {\n                const serverHost = location.hostname;\n                adjustedTexturePath = `http://${serverHost}:8001${texturePath}`;\n                console.log(`Adjusted texture path to API server: ${adjustedTexturePath}`);\n            }\n        }\n\n        // Load the texture if not already loaded\n        if (!this.skyboxTextures[texturePath]) {\n            console.log(`Loading new skybox texture: ${adjustedTexturePath}`);\n            this.skyboxTextures[texturePath] = this.textureLoader.load(adjustedTexturePath);\n            this.skyboxTextures[texturePath].colorSpace = THREE.SRGBColorSpace;\n        }\n\n        return this.skyboxTextures[texturePath];\n    }\n\n    createProceduralSkybox(params: SkyboxParams = {}): void {\n        // Apply system parameters if provided\n        let starDensity = params?.starDensity || 1.0;\n        let nebulaDensity = params?.nebulaDensity || 0.5;\n        let skyboxColor = params?.color || 0x000000;\n        let brightness = params?.brightness !== undefined ? params.brightness : 1.0;\n        const size = 320000; // Very large size to contain entire game world (4x original)\n        const texturePath = params?.texturePath || './assets/2k_stars_milky_way.jpg';\n\n        console.log(`Creating enhanced skybox with star density: ${starDensity}, nebula density: ${nebulaDensity}, color: 0x${skyboxColor.toString(16)}, texture: ${texturePath}, brightness: ${brightness}`);\n\n        // Get the appropriate texture\n        const skyboxTexture = this.getTexture(texturePath);\n\n        // Create advanced shader material for skybox with texture\n        const skyMaterial = new THREE.ShaderMaterial({\n            uniforms: {\n                time: { value: this.time || 0 },\n                milkyWayTexture: { value: skyboxTexture },\n                starDensity: { value: starDensity },\n                nebulaDensity: { value: nebulaDensity },\n                skyColor: { value: new THREE.Color(skyboxColor) },\n                brightness: { value: brightness }\n            },\n            vertexShader: `\n                varying vec2 vUv;\n                varying vec3 vPosition;\n                \n                void main() {\n                    vUv = uv;\n                    vPosition = position;\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                }\n            `,\n            fragmentShader: `\n                uniform sampler2D milkyWayTexture;\n                uniform float time;\n                uniform float starDensity;\n                uniform float nebulaDensity;\n                uniform vec3 skyColor;\n                uniform float brightness;\n                \n                varying vec2 vUv;\n                varying vec3 vPosition;\n                \n                void main() {\n                    // Sample the Milky Way texture with adjusted brightness\n                    vec4 milkyWay = texture2D(milkyWayTexture, vUv);\n                    milkyWay.rgb *= 1.5 * brightness; // Apply brightness factor\n                    \n                    // Use only the Milky Way texture without procedural stars\n                    vec3 finalColor = milkyWay.rgb * nebulaDensity * 1.2 * brightness;\n                    \n                    // Reduced ambient light\n                    finalColor += vec3(0.05);\n                    \n                    // Subtle color tint\n                    finalColor = mix(finalColor, skyColor * 1.2 * brightness, 0.1);\n                    \n                    // Apply gamma correction for more natural brightness\n                    finalColor = pow(finalColor, vec3(0.9));\n                    \n                    gl_FragColor = vec4(finalColor, 1.0);\n                }\n            `,\n            side: THREE.BackSide\n        });\n\n        // Create the skybox mesh\n        const skyboxGeometry = new THREE.BoxGeometry(size, size, size);\n        this.skybox = new THREE.Mesh(skyboxGeometry, skyMaterial);\n\n        // Rotate the skybox to align the Milky Way with the galactic plane\n        this.skybox.rotation.x = Math.PI / 4;\n        this.skybox.rotation.y = Math.PI / 6;\n\n        this.scene.add(this.skybox);\n\n        // Store material for updates\n        this.skyMaterial = skyMaterial;\n\n        console.log(\"Enhanced skybox created with texture\");\n    }\n\n    update(deltaTime: number = 0.016, camera?: THREE.Camera): void {\n        // Update skybox animation\n        if (this.skyMaterial) {\n            this.time += deltaTime * 0.1; // Slower star movement\n            this.skyMaterial.uniforms.time.value = this.time;\n        }\n\n        // Keep skybox centered on camera if it exists\n        if (this.skybox && camera) {\n            this.skybox.position.copy(camera.position);\n        }\n    }\n\n    dispose(): void {\n        if (this.skybox) {\n            this.scene.remove(this.skybox);\n        }\n    }\n}\n","// sunShaders.ts - Sun shader materials and effects\n\nimport * as THREE from 'three';\n\nexport class SunShaders {\n    static createSunMaterial(): THREE.ShaderMaterial {\n        return new THREE.ShaderMaterial({\n            uniforms: {\n                time: { value: 0 },\n                sunColor: { value: new THREE.Color(0xff7700) },\n                surfaceDetail: { value: 1.2 },\n                surfaceDistortion: { value: 0.3 },\n                sunActivity: { value: 0.8 }\n            },\n            vertexShader: `\n                varying vec3 vNormal;\n                varying vec2 vUv;\n                varying vec3 vPosition;\n                \n                void main() {\n                    vUv = uv;\n                    vNormal = normalize(normalMatrix * normal);\n                    vPosition = position;\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                }\n            `,\n            fragmentShader: `\n                uniform float time;\n                uniform vec3 sunColor;\n                uniform float surfaceDetail;\n                uniform float surfaceDistortion;\n                uniform float sunActivity;\n                \n                varying vec3 vNormal;\n                varying vec2 vUv;\n                varying vec3 vPosition;\n                \n                float hash(float n) { return fract(sin(n) * 43758.5453123); }\n                float hash(vec2 p) { return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453); }\n                \n                float noise(vec3 x) {\n                    vec3 p = floor(x);\n                    vec3 f = fract(x);\n                    f = f * f * (3.0 - 2.0 * f);\n                    \n                    float n = p.x + p.y * 157.0 + 113.0 * p.z;\n                    return mix(\n                        mix(mix(hash(n + 0.0), hash(n + 1.0), f.x),\n                            mix(hash(n + 157.0), hash(n + 158.0), f.x), f.y),\n                        mix(mix(hash(n + 113.0), hash(n + 114.0), f.x),\n                            mix(hash(n + 270.0), hash(n + 271.0), f.x), f.y),\n                        f.z);\n                }\n                \n                float fbm(vec3 x) {\n                    float v = 0.0;\n                    float a = 0.5;\n                    vec3 shift = vec3(100);\n                    \n                    for (int i = 0; i < 7; ++i) {\n                        v += a * noise(x);\n                        x = x * 2.0 + shift;\n                        a *= 0.5;\n                    }\n                    \n                    return v;\n                }\n                \n                void main() {\n                    vec3 surfacePos = vPosition * surfaceDetail * 0.01;\n                    float granulation = fbm(surfacePos + time * 0.15);\n                    \n                    float flareBase = fbm(surfacePos * 2.5 + time * 0.3);\n                    float flares = pow(flareBase, 1.8) * sunActivity;\n                    flares = smoothstep(0.65, 0.9, flares);\n                    \n                    float hotspots = fbm(surfacePos * 3.0 + time * 0.2) * fbm(surfacePos * 1.5 - time * 0.1);\n                    hotspots = pow(hotspots, 3.0) * 1.5;\n                    \n                    vec3 distortedNormal = vNormal;\n                    distortedNormal.x += noise(surfacePos * 6.0 + time * 0.15) * surfaceDistortion;\n                    distortedNormal.y += noise(surfacePos * 6.0 + time * 0.2) * surfaceDistortion;\n                    distortedNormal.z += noise(surfacePos * 6.0 + time * 0.17) * surfaceDistortion;\n                    distortedNormal = normalize(distortedNormal);\n                    \n                    float edgeBrightness = 1.0 - dot(distortedNormal, vec3(0.0, 0.0, 1.0));\n                    edgeBrightness = pow(edgeBrightness, 2.5) * 0.4;\n                    \n                    vec3 baseColor = sunColor;\n                    vec3 hotColor = vec3(1.0, 0.8, 0.4);\n                    vec3 flareColor = vec3(1.0, 0.6, 0.3);\n                    \n                    vec3 finalColor = baseColor * (1.0 + granulation * 0.4);\n                    finalColor = mix(finalColor, hotColor, hotspots);\n                    finalColor += flareColor * flares;\n                    finalColor += vec3(1.0, 0.9, 0.7) * edgeBrightness;\n                    \n                    gl_FragColor = vec4(finalColor, 1.0);\n                }\n            `,\n            side: THREE.FrontSide\n        });\n    }\n\n    static createCoronaMaterial(): THREE.ShaderMaterial {\n        return new THREE.ShaderMaterial({\n            uniforms: {\n                time: { value: 0 },\n                coronaColor: { value: new THREE.Color(0xff9940) },\n                viewVector: { value: new THREE.Vector3(0, 0, 1) },\n                turbulence: { value: 0.6 }\n            },\n            vertexShader: `\n                uniform vec3 viewVector;\n                varying vec3 vNormal;\n                varying vec3 vPosition;\n                varying float vIntensity;\n                \n                void main() {\n                    vNormal = normalize(normalMatrix * normal);\n                    vPosition = position;\n                    \n                    vec3 viewDir = normalize(viewVector);\n                    vIntensity = pow(1.15 - dot(vNormal, viewDir), 1.5) * 0.8 + 0.2;\n                    \n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                }\n            `,\n            fragmentShader: `\n                uniform float time;\n                uniform vec3 coronaColor;\n                uniform float turbulence;\n                \n                varying vec3 vNormal;\n                varying vec3 vPosition;\n                varying float vIntensity;\n                \n                float hash(vec3 p) {\n                    p = fract(p * vec3(443.897, 441.423, 437.195));\n                    p += dot(p, p.yzx + 19.19);\n                    return fract((p.x + p.y) * p.z);\n                }\n                \n                float noise(vec3 p) {\n                    vec3 i = floor(p);\n                    vec3 f = fract(p);\n                    f = f*f*(3.0-2.0*f);\n                    \n                    return mix(\n                        mix(mix(hash(i), hash(i + vec3(1,0,0)), f.x),\n                            mix(hash(i + vec3(0,1,0)), hash(i + vec3(1,1,0)), f.x), f.y),\n                        mix(mix(hash(i + vec3(0,0,1)), hash(i + vec3(1,0,1)), f.x),\n                            mix(hash(i + vec3(0,1,1)), hash(i + vec3(1,1,1)), f.x), f.y), f.z);\n                }\n                \n                float fbm(vec3 p) {\n                    float f = 0.0;\n                    float weight = 0.5;\n                    for (int i = 0; i < 5; i++) {\n                        f += weight * noise(p);\n                        weight *= 0.5;\n                        p *= 2.0;\n                    }\n                    return f;\n                }\n                \n                void main() {\n                    float turbulenceFactor = fbm(vPosition * 0.005 + time * 0.15) * turbulence;\n                    float finalIntensity = vIntensity * (1.0 + turbulenceFactor);\n                    \n                    float wisps = fbm(vPosition * 0.01 - time * 0.05) * fbm(vPosition * 0.02 + time * 0.1);\n                    wisps = pow(wisps, 2.0) * 0.5;\n                    \n                    vec3 finalColor = coronaColor * (finalIntensity + wisps);\n                    \n                    if (finalIntensity > 0.7) {\n                        finalColor = mix(finalColor, vec3(1.0, 0.9, 0.7), (finalIntensity - 0.7) * 3.0);\n                    }\n                    \n                    float alpha = smoothstep(0.0, 0.15, finalIntensity + wisps * 0.5);\n                    \n                    gl_FragColor = vec4(finalColor, alpha * 0.9);\n                }\n            `,\n            transparent: true,\n            blending: THREE.AdditiveBlending,\n            depthWrite: false,\n            side: THREE.BackSide\n        });\n    }\n\n    static createOuterCoronaMaterial(): THREE.ShaderMaterial {\n        return new THREE.ShaderMaterial({\n            uniforms: {\n                time: { value: 0 },\n                coronaColor: { value: new THREE.Color(0xff8800) },\n                viewVector: { value: new THREE.Vector3(0, 0, 1) }\n            },\n            vertexShader: `\n                uniform vec3 viewVector;\n                varying float vIntensity;\n                varying vec3 vPosition;\n                \n                void main() {\n                    vec3 vNormal = normalize(normalMatrix * normal);\n                    vec3 vNormel = normalize(viewVector);\n                    vIntensity = pow(1.05 - dot(vNormal, vNormel), 2.0) * 0.7 + 0.3;\n                    vPosition = position;\n                    \n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                }\n            `,\n            fragmentShader: `\n                uniform float time;\n                uniform vec3 coronaColor;\n                varying float vIntensity;\n                varying vec3 vPosition;\n                \n                float hash(vec3 p) {\n                    p = fract(p * vec3(443.897, 441.423, 437.195));\n                    p += dot(p, p.yzx + 19.19);\n                    return fract((p.x + p.y) * p.z);\n                }\n                \n                float noise(vec3 p) {\n                    vec3 i = floor(p);\n                    vec3 f = fract(p);\n                    f = f*f*(3.0-2.0*f);\n                    \n                    return mix(\n                        mix(mix(hash(i), hash(i + vec3(1,0,0)), f.x),\n                            mix(hash(i + vec3(0,1,0)), hash(i + vec3(1,1,0)), f.x), f.y),\n                        mix(mix(hash(i + vec3(0,0,1)), hash(i + vec3(1,0,1)), f.x),\n                            mix(hash(i + vec3(0,1,1)), hash(i + vec3(1,1,1)), f.x), f.y), f.z);\n                }\n                \n                void main() {\n                    float noiseVal = noise(vPosition * 0.002 + time * 0.1);\n                    float pulseIntensity = vIntensity * (1.0 + 0.2 * sin(time + noiseVal * 5.0));\n                    \n                    pulseIntensity += noiseVal * 0.2;\n                    \n                    vec3 glow = coronaColor * pulseIntensity;\n                    gl_FragColor = vec4(glow, pulseIntensity * 0.4);\n                }\n            `,\n            transparent: true,\n            blending: THREE.AdditiveBlending,\n            depthWrite: false,\n            side: THREE.BackSide\n        });\n    }\n}","// sunFlares.ts - Sun lens flare and particle effects\n\nimport * as THREE from 'three';\n\nexport class SunFlares {\n    private sunGroup: THREE.Group;\n    private lensFlares: THREE.Sprite[] = [];\n\n    constructor(_scene: THREE.Scene, sunGroup: THREE.Group) {\n        this.sunGroup = sunGroup;\n        this.lensFlares = [];\n        this.createFireballFlares();\n    }\n\n    private createFireballFlares(): void {\n        const flareTextures = [\n            'https://cdn.jsdelivr.net/gh/mrdoob/three.js@r128/examples/textures/lensflare/lensflare0.png',\n            'https://cdn.jsdelivr.net/gh/mrdoob/three.js@r128/examples/textures/lensflare/lensflare2.png',\n            'https://cdn.jsdelivr.net/gh/mrdoob/three.js@r128/examples/textures/lensflare/lensflare3.png'\n        ];\n        \n        const textureLoader = new THREE.TextureLoader();\n        \n        this.clearFlares();\n        \n        // Create main central flare\n        const mainFlareTexture = textureLoader.load(flareTextures[0]);\n        mainFlareTexture.colorSpace = THREE.SRGBColorSpace;\n        const mainFlare = new THREE.Sprite(new THREE.SpriteMaterial({\n            map: mainFlareTexture,\n            color: 0xffaa55,\n            transparent: true,\n            blending: THREE.AdditiveBlending,\n            depthTest: false\n        }));\n        mainFlare.scale.set(700, 700, 1.0);\n        this.sunGroup.add(mainFlare);\n        this.lensFlares.push(mainFlare);\n        \n        // Create smaller surrounding flares\n        const flareCount = 8;\n        const radius = 300;\n        \n        for (let i = 0; i < flareCount; i++) {\n            const textureIndex = 1 + (i % 2);\n            const flareTexture = textureLoader.load(flareTextures[textureIndex]);\n            flareTexture.colorSpace = THREE.SRGBColorSpace;\n            \n            const flare = new THREE.Sprite(new THREE.SpriteMaterial({\n                map: flareTexture,\n                color: i % 3 === 0 ? 0xffcc77 : (i % 3 === 1 ? 0xff8855 : 0xff6622),\n                transparent: true,\n                blending: THREE.AdditiveBlending,\n                depthTest: false\n            }));\n            \n            const angle = (i / flareCount) * Math.PI * 2;\n            const x = Math.cos(angle) * radius;\n            const y = Math.sin(angle) * radius;\n            flare.position.set(x, y, 0);\n            \n            const size = 200 + Math.random() * 200;\n            flare.scale.set(size, size, 1.0);\n            \n            this.sunGroup.add(flare);\n            this.lensFlares.push(flare);\n            \n            if (i % 2 === 0) {\n                const smallFlareTexture = textureLoader.load(flareTextures[i % 3]);\n                smallFlareTexture.colorSpace = THREE.SRGBColorSpace;\n                \n                const smallFlare = new THREE.Sprite(new THREE.SpriteMaterial({\n                    map: smallFlareTexture,\n                    color: 0xffaa22,\n                    transparent: true,\n                    blending: THREE.AdditiveBlending,\n                    depthTest: false\n                }));\n                \n                const farRadius = radius * 2;\n                const farAngle = angle + (Math.random() * 0.2 - 0.1);\n                const farX = Math.cos(farAngle) * farRadius;\n                const farY = Math.sin(farAngle) * farRadius;\n                smallFlare.position.set(farX, farY, 0);\n                \n                const smallSize = 100 + Math.random() * 150;\n                smallFlare.scale.set(smallSize, smallSize, 1.0);\n                \n                this.sunGroup.add(smallFlare);\n                this.lensFlares.push(smallFlare);\n            }\n        }\n    }\n\n    private clearFlares(): void {\n        this.lensFlares.forEach(flare => {\n            if (flare.parent) flare.parent.remove(flare);\n        });\n        this.lensFlares = [];\n    }\n\n    public updateFlareColors(color: THREE.ColorRepresentation): void {\n        this.lensFlares.forEach((flare, index) => {\n            if (flare && flare.material) {\n                const flareColor = new THREE.Color(color);\n                if (index % 3 === 0) {\n                    flareColor.r = Math.min(1.0, flareColor.r * 1.2);\n                } else if (index % 3 === 1) {\n                    flareColor.g = Math.min(1.0, flareColor.g * 1.1);\n                }\n                flare.material.color = flareColor;\n            }\n        });\n    }\n\n    public update(time: number, camera: THREE.Camera): void {\n        if (!camera) return;\n\n        const viewVector = new THREE.Vector3().subVectors(\n            camera.position,\n            this.sunGroup.position\n        ).normalize();\n\n        this.lensFlares.forEach((flare, index) => {\n            if (!flare) return;\n            \n            const pulseSpeed = 0.5 + (index % 3) * 0.3;\n            const pulseFactor = 0.9 + Math.sin(time * pulseSpeed + index) * 0.1;\n            \n            if (index === 0) {\n                const mainScale = 700 * pulseFactor;\n                flare.scale.set(mainScale, mainScale, 1.0);\n            } else {\n                const originalSize = 200 + (index % 3) * 100;\n                const size = originalSize * pulseFactor;\n                flare.scale.set(size, size, 1.0);\n                \n                if (flare.userData.originalPos) {\n                    const orbit = 0.1 + (index % 5) * 0.05;\n                    const orbitSpeed = 0.3 + (index % 4) * 0.1;\n                    flare.position.x = flare.userData.originalPos.x + Math.sin(time * orbitSpeed) * orbit * originalSize;\n                    flare.position.y = flare.userData.originalPos.y + Math.cos(time * orbitSpeed) * orbit * originalSize;\n                } else {\n                    flare.userData.originalPos = flare.position.clone();\n                }\n            }\n            \n            const angleToCam = viewVector.dot(new THREE.Vector3(0, 0, -1).applyQuaternion(camera.quaternion));\n            \n            if (angleToCam > 0.5) {\n                const opacity = Math.min(1.0, (angleToCam - 0.5) / 0.3 + 0.3);\n                flare.material.opacity = opacity;\n                flare.visible = true;\n            } else {\n                const reducedOpacity = Math.max(0.1, (angleToCam + 0.5) / 1.0) * 0.5;\n                flare.material.opacity = reducedOpacity;\n                flare.visible = true;\n            }\n        });\n    }\n}","// sunLighting.ts - Sun lighting system and visual effects\n\nimport * as THREE from 'three';\n\ninterface PointLightConfig {\n    intensity: number;\n    distance: number;\n    decay: number;\n}\n\ninterface FlickerConfig {\n    intensity: number;\n    direction: number;\n    minIntensity: number;\n    maxIntensity: number;\n    speed: number;\n}\n\ninterface SunLightingConfig {\n    pointLight: PointLightConfig;\n    flicker: FlickerConfig;\n}\n\ninterface LightingManager {\n    sunLight?: THREE.Light;\n    config: { sun: { intensity: number } };\n    updateSunPosition(position: THREE.Vector3): void;\n    updateExposure(cameraPosition: THREE.Vector3): void;\n}\n\nexport class SunLighting {\n    private sunGroup: THREE.Group;\n    private lightingManager: LightingManager | undefined;\n    private config: SunLightingConfig;\n    private sunPointLight: THREE.PointLight | undefined;\n    private sunFlickerIntensity: number;\n    private sunFlickerDirection: number;\n\n    constructor(_scene: THREE.Scene, sunGroup: THREE.Group, lightingManager?: LightingManager) {\n        this.sunGroup = sunGroup;\n        this.lightingManager = lightingManager; // Reference to main lighting manager\n\n        // Light configuration for visual sun glow only\n        this.config = {\n            // Point light for actual sun illumination\n            pointLight: {\n                intensity: 3000,  // High intensity for space scene\n                distance: 100000,  // Very long range\n                decay: 2\n            },\n            // Flicker parameters for realism\n            flicker: {\n                intensity: 1.0,\n                direction: 0.01,\n                minIntensity: 0.95,\n                maxIntensity: 1.05,\n                speed: 0.015\n            }\n        };\n\n        this.sunFlickerIntensity = this.config.flicker.intensity;\n        this.sunFlickerDirection = this.config.flicker.direction;\n        this.createLights();\n    }\n\n    private createLights(): void {\n        // Add point light for close-range glow effect only\n        // This creates the visual glow around the sun mesh\n        this.sunPointLight = new THREE.PointLight(\n            0xFFFAF0,\n            this.config.pointLight.intensity,\n            this.config.pointLight.distance,\n            this.config.pointLight.decay\n        );\n        this.sunGroup.add(this.sunPointLight);\n\n        // We no longer create our own directional light\n        // The main LightingManager handles all scene lighting\n        // This prevents conflicting light sources\n    }\n\n    public updateForStarType(_starType: string, color: THREE.ColorRepresentation, temperature: number, lightIntensityMultiplier: number = 1.0): void {\n        // Update point light color for glow\n        if (this.sunPointLight) {\n            this.sunPointLight.color.copy(new THREE.Color(color));\n            \n            // Subtle intensity variation based on star type\n            const baseIntensity = this.config.pointLight.intensity;\n            const tempFactor = temperature / 30000; // Normalized temperature factor\n            this.sunPointLight.intensity = baseIntensity * (0.8 + tempFactor * 0.4) * lightIntensityMultiplier;\n            (this.sunPointLight as any)._intensityMultiplier = lightIntensityMultiplier;\n        }\n        \n        // Update main scene lighting color through lighting manager\n        if (this.lightingManager && this.lightingManager.sunLight) {\n            // Blend the star color with warm white for realistic sun lighting\n            const blendedColor = new THREE.Color(color);\n            const warmWhite = new THREE.Color(0xFFF5F0);\n            blendedColor.lerp(warmWhite, 0.5); // 50% blend for natural look\n            \n            this.lightingManager.sunLight.color.copy(blendedColor);\n        }\n    }\n\n    public update(_deltaTime: number, camera: THREE.Camera, sunType: string): void {\n        // Update subtle flickering effect for realism\n        this.sunFlickerIntensity += this.sunFlickerDirection * this.config.flicker.speed;\n\n        if (this.sunFlickerIntensity > this.config.flicker.maxIntensity) {\n            this.sunFlickerIntensity = this.config.flicker.maxIntensity;\n            this.sunFlickerDirection = -Math.random() * this.config.flicker.speed;\n        } else if (this.sunFlickerIntensity < this.config.flicker.minIntensity) {\n            this.sunFlickerIntensity = this.config.flicker.minIntensity;\n            this.sunFlickerDirection = Math.random() * this.config.flicker.speed;\n        }\n\n        // Apply flickering to point light (glow effect)\n        if (this.sunPointLight) {\n            const intensityMultiplier = ((this.sunPointLight as any)._intensityMultiplier as number) || 1.0;\n            const baseIntensity = this.config.pointLight.intensity;\n\n            // Subtle variation based on star type\n            const typeBonus = sunType === 'G' ? 1.1 :\n                             (sunType === 'O' || sunType === 'B') ? 1.3 :\n                             (sunType === 'M') ? 0.9 : 1.0;\n\n            this.sunPointLight.intensity = baseIntensity * this.sunFlickerIntensity * intensityMultiplier * typeBonus;\n        }\n\n        // Update main scene sun light position through lighting manager\n        if (this.lightingManager) {\n            this.lightingManager.updateSunPosition(this.sunGroup.position);\n\n            // Apply subtle flicker to main sun light\n            if (this.lightingManager.sunLight) {\n                const baseIntensity = this.lightingManager.config.sun.intensity;\n                this.lightingManager.sunLight.intensity = baseIntensity * this.sunFlickerIntensity;\n            }\n\n            // Update exposure based on camera distance\n            if (camera) {\n                this.lightingManager.updateExposure(camera.position);\n            }\n        }\n    }\n\n    public toggleShadowHelper(enabled: boolean): void {\n        // Shadow helper is now managed by the main LightingManager\n        // This method is kept for backward compatibility\n        if (enabled && this.lightingManager && this.lightingManager.sunLight) {\n            console.log(\"Shadow debugging should be enabled through the main LightingManager\");\n        }\n    }\n\n    public dispose(): void {\n        if (this.sunPointLight) {\n            this.sunGroup.remove(this.sunPointLight);\n            this.sunPointLight.dispose();\n        }\n    }\n}","// sun.ts - Creates and manages the sun object (central star) with volumetric rendering\n\nimport * as THREE from 'three';\nimport { SunShaders } from './sun/sunShaders';\nimport { SunFlares } from './sun/sunFlares';\nimport { SunLighting } from './sun/sunLighting';\n\ntype SunType = 'O' | 'B' | 'A' | 'F' | 'G' | 'K' | 'M';\n\ninterface SceneWithLighting extends THREE.Scene {\n    camera?: THREE.Camera;\n    lightingManager?: unknown;\n}\n\nexport class Sun {\n    scene: SceneWithLighting;\n    sun: THREE.Group | null;\n    time: number;\n    sunType: SunType;\n    sunMaterial?: THREE.ShaderMaterial;\n    coronaMaterial?: THREE.ShaderMaterial;\n    outerCoronaMaterial?: THREE.ShaderMaterial;\n    lighting!: SunLighting;\n    flares!: SunFlares;\n\n    constructor(scene: SceneWithLighting) {\n        this.scene = scene;\n        this.sun = null;\n        this.time = 0;\n        this.sunType = 'G'; // Default sun type (G-type like our Sun)\n        this.createSun();\n    }\n\n    createSun(): void {\n        // Create a group to hold all sun-related elements\n        this.sun = new THREE.Group();\n        this.sun.name = 'sun';\n        this.scene.add(this.sun);\n\n        // Create the core sun sphere with shader material\n        const sunGeometry = new THREE.SphereGeometry(1000, 64, 64);\n        this.sunMaterial = SunShaders.createSunMaterial();\n        const sunCoreMesh = new THREE.Mesh(sunGeometry, this.sunMaterial);\n        this.sun.add(sunCoreMesh);\n\n        // Add corona layers\n        const coronaGeometry = new THREE.SphereGeometry(2000, 64, 64);\n        this.coronaMaterial = SunShaders.createCoronaMaterial();\n        const coronaMesh = new THREE.Mesh(coronaGeometry, this.coronaMaterial);\n        this.sun.add(coronaMesh);\n\n        const outerCoronaGeometry = new THREE.SphereGeometry(3000, 32, 32);\n        this.outerCoronaMaterial = SunShaders.createOuterCoronaMaterial();\n        const outerCoronaMesh = new THREE.Mesh(outerCoronaGeometry, this.outerCoronaMaterial);\n        this.sun.add(outerCoronaMesh);\n\n        // Initialize subsystems\n        // Get lighting manager from scene if available\n        const lightingManager = (this.scene as SceneWithLighting).lightingManager || null;\n        this.lighting = new SunLighting(this.scene, this.sun, lightingManager as any);\n        this.flares = new SunFlares(this.scene, this.sun);\n    }\n\n    // Update sun based on star type (O, B, A, F, G, K, M)\n    updateSunType(type: SunType, lightIntensityMultiplier: number = 1.0): void {\n        this.sunType = type || 'G';\n        let color: number, temperature: number, activity: number;\n\n        // Set sun properties based on star classification\n        switch (this.sunType) {\n            case 'O': color = 0x9db4ff; temperature = 30000; activity = 0.8; break;\n            case 'B': color = 0xaabfff; temperature = 20000; activity = 0.75; break;\n            case 'A': color = 0xcad7ff; temperature = 10000; activity = 0.7; break;\n            case 'F': color = 0xf8f7ff; temperature = 7000; activity = 0.65; break;\n            case 'G': color = 0xfff4ea; temperature = 5500; activity = 0.6; break;\n            case 'K': color = 0xffd2a1; temperature = 4000; activity = 0.5; break;\n            case 'M': color = 0xffcc6f; temperature = 3000; activity = 0.4; break;\n            default: color = 0xfff4ea; temperature = 5500; activity = 0.6;\n        }\n\n        // Update material colors and parameters\n        if (this.sunMaterial) {\n            this.sunMaterial.uniforms.sunColor.value.setHex(color);\n            this.sunMaterial.uniforms.sunActivity.value = activity;\n        }\n\n        if (this.coronaMaterial) {\n            const coronaColor = new THREE.Color(color);\n            coronaColor.r = Math.min(1.0, coronaColor.r * 1.2);\n            coronaColor.g = Math.min(1.0, coronaColor.g * 1.1);\n            this.coronaMaterial.uniforms.coronaColor.value = coronaColor;\n        }\n\n        if (this.outerCoronaMaterial) {\n            const outerCoronaColor = new THREE.Color(color);\n            outerCoronaColor.r = Math.min(1.0, outerCoronaColor.r * 1.3);\n            outerCoronaColor.g = Math.min(1.0, outerCoronaColor.g * 1.2);\n            outerCoronaColor.b = Math.min(1.0, outerCoronaColor.b * 1.1);\n            this.outerCoronaMaterial.uniforms.coronaColor.value = outerCoronaColor;\n        }\n\n        // Update lighting and flares\n        this.lighting.updateForStarType(this.sunType, color, temperature, lightIntensityMultiplier);\n        this.flares.updateFlareColors(color);\n\n        console.log(`Updated sun to type ${this.sunType}, color: ${color.toString(16)}, intensity multiplier: ${lightIntensityMultiplier}`);\n    }\n\n    getRadius(): number {\n        return 3000;\n    }\n\n    getPosition(): THREE.Vector3 {\n        return new THREE.Vector3(0, 0, 0);\n    }\n\n    update(deltaTime: number = 0.016): void {\n        if (!this.sun) return;\n\n        // Update time for all shaders\n        this.time += deltaTime * 0.4;\n\n        if (this.sunMaterial && this.sunMaterial.uniforms.time) {\n            this.sunMaterial.uniforms.time.value = this.time;\n        }\n\n        if (this.coronaMaterial && this.coronaMaterial.uniforms.time) {\n            this.coronaMaterial.uniforms.time.value = this.time;\n        }\n\n        if (this.outerCoronaMaterial && this.outerCoronaMaterial.uniforms.time) {\n            this.outerCoronaMaterial.uniforms.time.value = this.time;\n        }\n\n        // Update camera-relative uniforms\n        if (this.scene && this.scene.camera) {\n            const viewVector = new THREE.Vector3().subVectors(\n                this.scene.camera.position,\n                this.sun.position\n            ).normalize();\n\n            if (this.coronaMaterial && this.coronaMaterial.uniforms.viewVector) {\n                this.coronaMaterial.uniforms.viewVector.value = viewVector;\n            }\n\n            if (this.outerCoronaMaterial && this.outerCoronaMaterial.uniforms.viewVector) {\n                this.outerCoronaMaterial.uniforms.viewVector.value = viewVector;\n            }\n        }\n\n        // Update subsystems\n        if (this.scene.camera) {\n            this.lighting.update(deltaTime, this.scene.camera, this.sunType);\n            this.flares.update(this.time, this.scene.camera);\n        }\n    }\n\n    // Toggle shadow camera helper for debugging\n    toggleShadowHelper(enabled: boolean): void {\n        this.lighting.toggleShadowHelper(enabled);\n    }\n\n    dispose(): void {\n        if (this.sun) {\n            this.scene.remove(this.sun);\n        }\n    }\n}\n","// planetGenerator.ts - Procedural planet generation logic\n\nimport { PlanetData } from './planetFactory.js';\n\n// Type definition for star system generator\ninterface StarSystemGenerator {\n    customPlanetData?: {\n        [systemId: string]: PlanetData[];\n    };\n}\n\nexport class PlanetGenerator {\n    static generatePlanetsForSystem(systemId: string, starSystemGenerator?: StarSystemGenerator): PlanetData[] {\n        console.log(`Generating new planets for system: ${systemId}`);\n\n        // Check if this is a custom system with predefined planets\n        if (starSystemGenerator && starSystemGenerator.customPlanetData && starSystemGenerator.customPlanetData[systemId]) {\n            const customPlanets = starSystemGenerator.customPlanetData[systemId];\n            console.log(`Using ${customPlanets.length} custom planets for system: ${systemId}`);\n\n            customPlanets.forEach((planet: PlanetData) => {\n                if (planet.textureUrl) {\n                    console.log(`Custom planet ${planet.name} has texture URL: ${planet.textureUrl}`);\n                } else {\n                    console.log(`Custom planet ${planet.name} does not have a texture URL`);\n                }\n            });\n\n            return starSystemGenerator.customPlanetData[systemId];\n        }\n\n        // Planet name word banks for procedural generation\n        const prefixes = [\n            'New', 'Alpha', 'Beta', 'Gamma', 'Delta', 'Nova', 'Proxima', 'Ultima',\n            'Astro', 'Cosmo', 'Stella', 'Terra', 'Astra', 'Prime', 'Orb'\n        ];\n\n        const suffixes = [\n            'sphere', 'world', 'orb', 'terra', 'oid', 'globus', 'ium', 'ian',\n            'aria', 'anth', 'urus', 'alos', 'onos', 'era', 'ax', 'is', 'os'\n        ];\n\n        const starClass = systemId.includes('System-') ? systemId.split('-')[1][0] : 'M';\n        const planetCount = 2 + Math.floor(Math.random() * 7); // 2-8 planets\n        const planetData: PlanetData[] = [];\n\n        // Determine system characteristics based on star class\n        let sizeMultiplier = 1.0;\n        let distanceMultiplier = 1.0;\n        let colorPalette: number[] = [];\n\n        switch (starClass) {\n            case 'O':\n                sizeMultiplier = 1.8;\n                distanceMultiplier = 1.6;\n                colorPalette = [0x6666ff, 0x9999ff, 0xccccff, 0xaaaaff, 0x8888dd];\n                break;\n            case 'B':\n                sizeMultiplier = 1.5;\n                distanceMultiplier = 1.3;\n                colorPalette = [0x99aaff, 0xaabbff, 0xccccff, 0xddddff, 0xbbaacc];\n                break;\n            case 'A':\n                sizeMultiplier = 1.3;\n                distanceMultiplier = 1.1;\n                colorPalette = [0xccccff, 0xddddff, 0xeeeeff, 0xffffff, 0xddccdd];\n                break;\n            case 'F':\n                sizeMultiplier = 1.1;\n                distanceMultiplier = 1.0;\n                colorPalette = [0x99aaff, 0xaaccaa, 0xccddcc, 0xffccaa, 0xeeeecc];\n                break;\n            case 'G':\n                sizeMultiplier = 1.0;\n                distanceMultiplier = 1.0;\n                colorPalette = [0xaaaaaa, 0x4169e1, 0xc65d45, 0xd6b27e, 0xf0e5c9];\n                break;\n            case 'K':\n                sizeMultiplier = 0.8;\n                distanceMultiplier = 0.9;\n                colorPalette = [0xe6cc9c, 0xccaa88, 0xddbb99, 0xbb9977, 0xcc8866];\n                break;\n            case 'M':\n                sizeMultiplier = 0.6;\n                distanceMultiplier = 0.7;\n                colorPalette = [0xcc6644, 0xdd7755, 0xee8866, 0xff9977, 0xbb5533];\n                break;\n            default:\n                colorPalette = [0xaaaaaa, 0x4169e1, 0xc65d45, 0xd6b27e, 0xf0e5c9];\n        }\n\n        // Generate each planet\n        for (let i = 0; i < planetCount; i++) {\n            const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];\n            const suffix = suffixes[Math.floor(Math.random() * suffixes.length)];\n            const name = `${prefix}${suffix}`;\n\n            const sizeClass = Math.random();\n            let size: number;\n            if (sizeClass < 0.5) {\n                size = (240 + Math.random() * 200) * sizeMultiplier;\n            } else if (sizeClass < 0.8) {\n                size = (440 + Math.random() * 280) * sizeMultiplier;\n            } else {\n                size = (720 + Math.random() * 360) * sizeMultiplier;\n            }\n\n            const baseDistance = 4800 + (i * 8000);\n            const distanceVariation = baseDistance * 0.2;\n            const distance = (baseDistance + (Math.random() * distanceVariation - distanceVariation / 2)) * distanceMultiplier;\n\n            const speed = 0.002 / (distance / 1000);\n            const color = colorPalette[Math.floor(Math.random() * colorPalette.length)];\n            const rings = size > 600 ? Math.random() < 0.4 : false;\n            const axialTilt = Math.random() * Math.PI * 0.5;\n            const orbitalTilt = Math.random() * Math.PI * 0.2;\n\n            planetData.push({\n                name,\n                size: Math.floor(size),\n                distance: Math.floor(distance),\n                speed,\n                color,\n                rings,\n                axialTilt,\n                orbitalTilt\n            });\n        }\n\n        return planetData;\n    }\n\n    static createHomeSolarSystemPlanets(): PlanetData[] {\n        return [\n            { name: \"Mercury\", size: 220, distance: 4800, speed: 0.0016, color: 0xaaaaaa, rings: false },\n            { name: \"Venus\", size: 400, distance: 8000, speed: 0.0013, color: 0xe6cc9c, rings: false },\n            { name: \"Earth\", size: 420, distance: 12000, speed: 0.0010, color: 0x4169e1, rings: false },\n            { name: \"Mars\", size: 320, distance: 16800, speed: 0.0008, color: 0xc65d45, rings: false },\n            { name: \"Jupiter\", size: 1000, distance: 30000, speed: 0.0004, color: 0xd6b27e, rings: true },\n            { name: \"Saturn\", size: 880, distance: 40000, speed: 0.0003, color: 0xf0e5c9, rings: true },\n            { name: \"Uranus\", size: 720, distance: 56000, speed: 0.0002, color: 0xcaecf1, rings: true },\n            { name: \"Neptune\", size: 700, distance: 72000, speed: 0.00016, color: 0x5fa3db, rings: false }\n        ];\n    }\n}","// planetTextures.ts - Planet texture loading and management\n\nimport * as THREE from 'three';\n\nconst textureLoader = new THREE.TextureLoader();\n\n// Type definitions for planet textures\ninterface PlanetTextureMap {\n    mercury: THREE.Texture;\n    venus: {\n        surface: THREE.Texture;\n        atmosphere: THREE.Texture;\n    };\n    earth: THREE.Texture;\n    mars: THREE.Texture;\n    jupiter: THREE.Texture;\n    saturn: {\n        surface: THREE.Texture;\n        rings: THREE.Texture;\n    };\n    uranus: THREE.Texture;\n    neptune: THREE.Texture;\n}\n\n// Load all planet textures\nexport const planetTextures: PlanetTextureMap = {\n    mercury: textureLoader.load('./assets/2k_mercury.jpg'),\n    venus: {\n        surface: textureLoader.load('./assets/2k_venus_surface.jpg'),\n        atmosphere: textureLoader.load('./assets/2k_venus_atmosphere.jpg')\n    },\n    earth: textureLoader.load('./assets/2k_earth_daymap.jpg'),\n    mars: textureLoader.load('./assets/2k_mars.jpg'),\n    jupiter: textureLoader.load('./assets/2k_jupiter.jpg'),\n    saturn: {\n        surface: textureLoader.load('./assets/2k_saturn.jpg'),\n        rings: textureLoader.load('./assets/2k_saturn_ring_alpha.png')\n    },\n    uranus: textureLoader.load('./assets/2k_uranus.jpg'),\n    neptune: textureLoader.load('./assets/2k_neptune.jpg')\n};\n\n// Set the correct color space for all planet textures\nplanetTextures.mercury.colorSpace = THREE.SRGBColorSpace;\nplanetTextures.venus.surface.colorSpace = THREE.SRGBColorSpace;\nplanetTextures.venus.atmosphere.colorSpace = THREE.SRGBColorSpace;\nplanetTextures.earth.colorSpace = THREE.SRGBColorSpace;\nplanetTextures.mars.colorSpace = THREE.SRGBColorSpace;\nplanetTextures.jupiter.colorSpace = THREE.SRGBColorSpace;\nplanetTextures.saturn.surface.colorSpace = THREE.SRGBColorSpace;\nplanetTextures.saturn.rings.colorSpace = THREE.SRGBColorSpace;\nplanetTextures.uranus.colorSpace = THREE.SRGBColorSpace;\nplanetTextures.neptune.colorSpace = THREE.SRGBColorSpace;\n\n// Load the custom procedural textures (p1-p22)\nexport const proceduralTextures: THREE.Texture[] = [];\nfor (let i = 1; i <= 22; i++) {\n    const texture = textureLoader.load(`./assets/p${i}.jpeg`);\n    texture.colorSpace = THREE.SRGBColorSpace;\n    proceduralTextures.push(texture);\n}","// planetMaterials.ts - Planet material creation and management\n\nimport * as THREE from 'three';\nimport { planetTextures, proceduralTextures } from './planetTextures.js';\nimport type { PlanetData } from './planetFactory.js';\n\nconst textureLoader = new THREE.TextureLoader();\n\nexport class PlanetMaterials {\n    static createMaterialForPlanet(planet: PlanetData): THREE.MeshStandardMaterial {\n        // Check if this is a custom planet with its own texture\n        if (planet.textureUrl) {\n            console.log(`Creating planet ${planet.name} with custom texture: ${planet.textureUrl}`);\n\n            // Fix texture path for API server images\n            let adjustedTextureUrl = planet.textureUrl;\n\n            if (planet.textureUrl.startsWith('/images/')) {\n                if ((window as any).location.port === '8000') {\n                    const serverHost = (window as any).location.hostname;\n                    adjustedTextureUrl = `http://${serverHost}:8001${planet.textureUrl}`;\n                    console.log(`Adjusted planet texture path to API server: ${adjustedTextureUrl}`);\n                }\n            }\n\n            const customTexture = textureLoader.load(adjustedTextureUrl);\n            customTexture.colorSpace = THREE.SRGBColorSpace;\n\n            return new THREE.MeshStandardMaterial({\n                map: customTexture,\n                roughness: 0.5,\n                metalness: 0.0,\n                flatShading: false,\n                emissive: new THREE.Color(planet.color || 0x222222),\n                emissiveIntensity: 0.3\n            });\n        }\n\n        // Use standard planet textures based on planet name\n        switch (planet.name) {\n            case \"Mercury\":\n                return new THREE.MeshStandardMaterial({\n                    map: planetTextures.mercury,\n                    roughness: 0.95,\n                    metalness: 0.0,\n                    flatShading: false,\n                    emissive: new THREE.Color(0x2a2a2a),\n                    emissiveIntensity: 0.15\n                });\n\n            case \"Venus\":\n                return new THREE.MeshStandardMaterial({\n                    map: planetTextures.venus.surface,\n                    roughness: 0.85,\n                    metalness: 0.0,\n                    flatShading: false,\n                    emissive: new THREE.Color(0x443322),\n                    emissiveIntensity: 0.2\n                });\n\n            case \"Earth\":\n                return new THREE.MeshStandardMaterial({\n                    map: planetTextures.earth,\n                    roughness: 0.75,\n                    metalness: 0.0,\n                    flatShading: false,\n                    emissive: new THREE.Color(0x112233),\n                    emissiveIntensity: 0.18\n                });\n\n            case \"Mars\":\n                return new THREE.MeshStandardMaterial({\n                    map: planetTextures.mars,\n                    roughness: 0.9,\n                    metalness: 0.0,\n                    flatShading: false,\n                    emissive: new THREE.Color(0x442211),\n                    emissiveIntensity: 0.18\n                });\n\n            case \"Jupiter\":\n                return new THREE.MeshStandardMaterial({\n                    map: planetTextures.jupiter,\n                    roughness: 0.8,\n                    metalness: 0.0,\n                    flatShading: false,\n                    emissive: new THREE.Color(0x332211),\n                    emissiveIntensity: 0.15\n                });\n\n            case \"Saturn\":\n                return new THREE.MeshStandardMaterial({\n                    map: planetTextures.saturn.surface,\n                    roughness: 0.85,\n                    metalness: 0.0,\n                    flatShading: false,\n                    emissive: new THREE.Color(0x332211),\n                    emissiveIntensity: 0.15\n                });\n\n            case \"Uranus\":\n                return new THREE.MeshStandardMaterial({\n                    map: planetTextures.uranus,\n                    roughness: 0.85,\n                    metalness: 0.0,\n                    flatShading: false,\n                    emissive: new THREE.Color(0x112233),\n                    emissiveIntensity: 0.14\n                });\n\n            case \"Neptune\":\n                return new THREE.MeshStandardMaterial({\n                    map: planetTextures.neptune,\n                    roughness: 0.85,\n                    metalness: 0.0,\n                    flatShading: false,\n                    emissive: new THREE.Color(0x112244),\n                    emissiveIntensity: 0.14\n                });\n\n            default:\n                // For other planets, use a procedural texture from the collection\n                const textureIndex = Math.floor(Math.random() * proceduralTextures.length);\n                return new THREE.MeshStandardMaterial({\n                    map: proceduralTextures[textureIndex],\n                    roughness: 0.85,\n                    metalness: 0.0,\n                    color: new THREE.Color(planet.color),\n                    flatShading: false,\n                    emissive: new THREE.Color(0x222222),\n                    emissiveIntensity: 0.15\n                });\n        }\n    }\n\n    static createRingMaterial(planet: PlanetData): THREE.MeshStandardMaterial {\n        if (planet.name === \"Saturn\") {\n            return new THREE.MeshStandardMaterial({\n                map: planetTextures.saturn.rings,\n                side: THREE.DoubleSide,\n                transparent: true,\n                opacity: 0.8,\n                roughness: 0.8,\n                metalness: 0.1,\n                emissive: new THREE.Color(0xf0e5c9),\n                emissiveIntensity: 0.2,\n                emissiveMap: planetTextures.saturn.rings\n            });\n        } else {\n            return new THREE.MeshStandardMaterial({\n                color: planet.color,\n                side: THREE.DoubleSide,\n                transparent: true,\n                opacity: 0.4,\n                roughness: 0.7,\n                metalness: 0.2,\n                emissive: new THREE.Color(planet.color),\n                emissiveIntensity: 0.3\n            });\n        }\n    }\n}","// planetFactory.ts - Planet mesh creation and ring generation\n\nimport * as THREE from 'three';\nimport { PlanetMaterials } from './planetMaterials.js';\n\n// Type definitions for planet objects\nexport interface PlanetData {\n    name: string;\n    size: number;\n    distance: number;\n    speed: number;\n    color?: number;\n    rings?: boolean;\n    axialTilt?: number;\n    orbitalTilt?: number;\n    textureUrl?: string;\n}\n\nexport interface PlanetMeshData {\n    mesh: THREE.Mesh;\n    distance: number;\n    speed: number;\n    angle: number;\n    orbitalTilt: number;\n}\n\nexport class PlanetFactory {\n    static createPlanetMesh(planet: PlanetData): PlanetMeshData {\n        const planetGeometry = new THREE.SphereGeometry(planet.size, 32, 32);\n        const planetMaterial = PlanetMaterials.createMaterialForPlanet(planet);\n        const planetMesh = new THREE.Mesh(planetGeometry, planetMaterial);\n\n        // Position the planet at its orbital distance\n        const angle = Math.random() * Math.PI * 2;\n        const orbitalTilt = planet.orbitalTilt || 0;\n        const axialTilt = planet.axialTilt || 0;\n\n        // Position planet with orbital tilt\n        planetMesh.position.x = Math.cos(angle) * planet.distance;\n        planetMesh.position.y = Math.sin(orbitalTilt) * planet.distance;\n        planetMesh.position.z = Math.sin(angle) * Math.cos(orbitalTilt) * planet.distance;\n\n        // Apply axial tilt to planet rotation\n        planetMesh.rotation.x = axialTilt;\n\n        // Enable shadows for eclipse effects\n        planetMesh.castShadow = true;\n        planetMesh.receiveShadow = true;\n\n        // Create planet rings if specified\n        if (planet.rings) {\n            const ringMesh = PlanetFactory.createRingMesh(planet);\n            planetMesh.add(ringMesh);\n        }\n\n        return {\n            mesh: planetMesh,\n            distance: planet.distance,\n            speed: planet.speed,\n            angle: angle,\n            orbitalTilt: orbitalTilt\n        };\n    }\n\n    static createRingMesh(planet: PlanetData): THREE.Mesh {\n        let ringGeometry: THREE.RingGeometry;\n\n        if (planet.name === \"Saturn\") {\n            ringGeometry = new THREE.RingGeometry(planet.size * 1.4, planet.size * 2.0, 32);\n        } else {\n            ringGeometry = new THREE.RingGeometry(planet.size * 1.3, planet.size * 1.8, 32);\n        }\n\n        const ringMaterial = PlanetMaterials.createRingMaterial(planet);\n        const ringMesh = new THREE.Mesh(ringGeometry, ringMaterial);\n\n        // Rotate rings to be flat (perpendicular to y-axis)\n        ringMesh.rotation.x = Math.PI / 2;\n\n        // Enable shadows for rings\n        ringMesh.castShadow = true;\n        ringMesh.receiveShadow = true;\n\n        return ringMesh;\n    }\n}","// planets.ts - Creates and manages the planets in the solar system\n\nimport * as THREE from 'three';\nimport { PlanetGenerator } from './planets/planetGenerator';\nimport { PlanetFactory, PlanetData, PlanetMeshData } from './planets/planetFactory';\n\ninterface StarSystemGenerator {\n    customPlanetData?: Record<string, PlanetData[]>;\n}\n\ninterface PlanetRegion {\n    name: string;\n    position: THREE.Vector3;\n    radius: number;\n}\n\nexport class Planets {\n    scene: THREE.Scene;\n    starSystemGenerator: StarSystemGenerator;\n    planets: PlanetMeshData[];\n    planetRegions: Record<string, PlanetRegion>;\n    currentSystemId: string;\n    systemPlanets: Record<string, PlanetData[]>;\n\n    constructor(scene: THREE.Scene, starSystemGenerator: StarSystemGenerator) {\n        this.scene = scene;\n        this.starSystemGenerator = starSystemGenerator;\n        this.planets = [];\n        this.planetRegions = {};\n        this.currentSystemId = 'Solar System'; // Default to our Solar System\n        this.systemPlanets = {};\n\n        // Initialize our solar system planets\n        this.createHomeSolarSystem();\n    }\n\n    // Create our home solar system (the only non-procedural system)\n    createHomeSolarSystem(): void {\n        const solarSystemPlanets = PlanetGenerator.createHomeSolarSystemPlanets();\n        this.systemPlanets['Solar System'] = solarSystemPlanets;\n        this.createPlanetsForSystem('Solar System');\n    }\n\n    // Create planet objects for the current system\n    createPlanetsForSystem(systemId: string): void {\n        // Clear existing planets\n        this.clearPlanets();\n\n        // Update current system\n        this.currentSystemId = systemId;\n\n        // If we already have planet data for this system, use it\n        if (this.systemPlanets[systemId]) {\n            this.createPlanetsFromData(this.systemPlanets[systemId]);\n            return;\n        }\n\n        // Otherwise, we need to generate planets for this system\n        const generatedPlanets = this.generatePlanetsForSystem(systemId);\n        this.systemPlanets[systemId] = generatedPlanets;\n        this.createPlanetsFromData(generatedPlanets);\n    }\n\n    // Generate procedural planets for a new star system\n    generatePlanetsForSystem(systemId: string): PlanetData[] {\n        return PlanetGenerator.generatePlanetsForSystem(systemId, this.starSystemGenerator);\n    }\n\n    // Create planet objects from data array\n    createPlanetsFromData(planetData: PlanetData[]): void {\n        this.clearPlanets();\n\n        planetData.forEach(planet => {\n            const planetObj = PlanetFactory.createPlanetMesh(planet);\n\n            // Add the planet to the scene\n            this.scene.add(planetObj.mesh);\n\n            // Store planet data for orbiting\n            this.planets.push(planetObj);\n\n            // Store planet regions for game mechanics\n            this.planetRegions[planet.name] = {\n                name: planet.name,\n                position: planetObj.mesh.position.clone(),\n                radius: planet.size * 2\n            };\n        });\n    }\n\n    // Clear all existing planets\n    clearPlanets(): void {\n        // Remove planets from scene and clear arrays\n        this.planets.forEach(planet => {\n            this.scene.remove(planet.mesh);\n        });\n\n        this.planets = [];\n        this.planetRegions = {};\n    }\n\n    // Set up planet system for specified star system\n    updateForSystem(systemId: string): boolean {\n        console.log(`Updating planets for system: ${systemId}`);\n\n        // Generate and create planets for this system if we haven't already\n        this.createPlanetsForSystem(systemId);\n\n        // Return true to indicate success\n        return true;\n    }\n\n    getPlanetRegions(): Record<string, PlanetRegion> {\n        return this.planetRegions;\n    }\n\n    getPlanets(): PlanetMeshData[] {\n        return this.planets;\n    }\n\n    update(deltaTime: number): void {\n        this.planets.forEach(planet => {\n            planet.angle += planet.speed * deltaTime;\n\n            planet.mesh.position.x = Math.cos(planet.angle) * planet.distance;\n            planet.mesh.position.z = Math.sin(planet.angle) * Math.cos(planet.orbitalTilt) * planet.distance;\n            planet.mesh.position.y = Math.sin(planet.angle) * Math.sin(planet.orbitalTilt) * planet.distance;\n\n            planet.mesh.rotation.y += deltaTime * 0.1;\n\n            // Update planet regions for location tracking\n            if (planet.mesh) {\n                Object.values(this.planetRegions).forEach(region => {\n                    if (region && region.position) {\n                        const distance = region.position.distanceTo(planet.mesh.position);\n                        if (distance < 5000) {\n                            region.position.copy(planet.mesh.position);\n                        }\n                    }\n                });\n            }\n        });\n    }\n\n    dispose(): void {\n        this.clearPlanets();\n    }\n}\n","// stargate.ts - Creates and manages the stargate\n\nimport * as THREE from 'three';\n\ninterface NavLightEntry {\n    light: THREE.PointLight;\n    lightMesh: THREE.Mesh;\n}\n\nexport class Stargate {\n    scene: THREE.Scene;\n    stargate: THREE.Group | null;\n    navLights: NavLightEntry[];\n    portalParticles: THREE.Mesh[];\n    portalShaderMaterial?: THREE.ShaderMaterial;\n    portalLight?: THREE.PointLight;\n    counterRotatingRing?: THREE.Group;\n\n    constructor(scene: THREE.Scene) {\n        this.scene = scene;\n        this.stargate = null;\n        this.navLights = [];\n        this.portalParticles = [];\n        this.createStargate();\n    }\n\n    createStargate(): void {\n        // Create a stargate group\n        const stargateGroup = new THREE.Group();\n        stargateGroup.name = 'stargate';\n\n        // Main ring - matte black\n        const ringGeometry = new THREE.TorusGeometry(1000, 200, 32, 100);\n        const ringMaterial = new THREE.MeshStandardMaterial({\n            color: 0x111111,\n            roughness: 0.9,\n            metalness: 0.1,\n            emissive: 0x000000\n        });\n        const ring = new THREE.Mesh(ringGeometry, ringMaterial);\n        stargateGroup.add(ring);\n\n        // Neon turquoise accent rings\n        const createAccentRing = (\n            radius: number,\n            tubeRadius: number,\n            position: { x: number; y: number; z: number } = { x: 0, y: 0, z: 0 },\n            rotation: { x: number; y: number; z: number } = { x: 0, y: 0, z: 0 }\n        ): THREE.Mesh => {\n            const geometry = new THREE.TorusGeometry(radius, tubeRadius, 16, 100);\n            const material = new THREE.MeshStandardMaterial({\n                color: 0x00ffff,\n                emissive: 0x00ffff,\n                emissiveIntensity: 1.5,\n                roughness: 0.2,\n                metalness: 0.8\n            });\n            const accentRing = new THREE.Mesh(geometry, material);\n            accentRing.position.set(position.x, position.y, position.z);\n            accentRing.rotation.set(rotation.x, rotation.y, rotation.z);\n            return accentRing;\n        };\n\n        // Add accent rings on outer edges - make them brighter\n        const outerRing1 = createAccentRing(1060, 10);\n        const outerRing2 = createAccentRing(940, 10);\n        // Add an inner ring to enhance portal effect\n        const innerRing = createAccentRing(850, 5);\n        stargateGroup.add(outerRing1);\n        stargateGroup.add(outerRing2);\n        stargateGroup.add(innerRing);\n\n        // Create enhanced turquoise portal in the center\n        this.createPortalEffect(stargateGroup);\n\n        // Add neon accent details\n        const detailsGroup = this.createNeonDetails();\n        stargateGroup.add(detailsGroup);\n\n        // Position the stargate at 2x height from the original position\n        stargateGroup.position.set(0, 10000, 0);\n        stargateGroup.rotation.x = Math.PI / 2; // Horizontal orientation\n\n        // Add to scene\n        this.scene.add(stargateGroup);\n        this.stargate = stargateGroup;\n\n        // Create a counter-rotating inner ring for additional portal effect\n        this.createCounterRotatingRing(stargateGroup);\n    }\n\n    createCounterRotatingRing(parentGroup: THREE.Group): void {\n        // Create a separate rotating group for the inner portal structure\n        const innerStructure = new THREE.Group();\n\n        // Add a thin ring that rotates opposite to the main stargate\n        const thinRingGeometry = new THREE.TorusGeometry(820, 3, 16, 100);\n        const thinRingMaterial = new THREE.MeshStandardMaterial({\n            color: 0x00ffff,\n            emissive: 0x00ffff,\n            emissiveIntensity: 2,\n            roughness: 0.1,\n            metalness: 0.9,\n            transparent: true,\n            opacity: 0.7\n        });\n\n        // Create 3 counter-rotating rings\n        for (let i = 0; i < 3; i++) {\n            const ring = new THREE.Mesh(thinRingGeometry, thinRingMaterial.clone());\n            ring.rotation.x = Math.PI * i / 3;\n            ring.rotation.y = Math.PI * i / 3;\n            innerStructure.add(ring);\n        }\n\n        parentGroup.add(innerStructure);\n        this.counterRotatingRing = innerStructure;\n    }\n\n    createPortalEffect(parentGroup: THREE.Group): void {\n        // Enhanced custom shader material for the portal\n        const portalShaderMaterial = new THREE.ShaderMaterial({\n            uniforms: {\n                time: { value: 0 },\n                resolution: { value: new THREE.Vector2(1024, 1024) },\n                baseColor: { value: new THREE.Color(0x00ffff) }\n            },\n            vertexShader: `\n            varying vec2 vUv;\n            \n            void main() {\n              vUv = uv;\n              gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n            }\n          `,\n            fragmentShader: `\n            uniform float time;\n            uniform vec2 resolution;\n            uniform vec3 baseColor;\n            varying vec2 vUv;\n            \n            // Simple noise function\n            float noise(vec2 p) {\n              return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);\n            }\n            \n            // Smoothed noise\n            float smoothNoise(vec2 p) {\n              vec2 ip = floor(p);\n              vec2 fp = fract(p);\n              \n              vec2 u = fp * fp * (3.0 - 2.0 * fp);\n              \n              float a = noise(ip);\n              float b = noise(ip + vec2(1.0, 0.0));\n              float c = noise(ip + vec2(0.0, 1.0));\n              float d = noise(ip + vec2(1.0, 1.0));\n              \n              return mix(mix(a, b, u.x), mix(c, d, u.x), u.y);\n            }\n            \n            // Fractal Brownian Motion\n            float fbm(vec2 p) {\n              float value = 0.0;\n              float amplitude = 0.5;\n              float frequency = 3.0;\n              \n              for (int i = 0; i < 6; i++) {\n                value += amplitude * smoothNoise(p * frequency);\n                amplitude *= 0.5;\n                frequency *= 2.0;\n              }\n              \n              return value;\n            }\n            \n            void main() {\n              // Convert uv to be centered at (0.5, 0.5) with range -1 to 1\n              vec2 centeredUV = (vUv - 0.5) * 2.0;\n              float dist = length(centeredUV);\n              \n              // Create angle for rotation\n              float angle = atan(centeredUV.y, centeredUV.x);\n              \n              // Enhanced swirling effect parameters - more aggressive\n              float swirl = sin(angle * 6.0 + time * 2.0) * 0.5 + 0.5;\n              float pulse = sin(time * 0.8) * 0.5 + 0.5;\n              \n              // Create more distorted coordinates for noise - enhances warp feel\n              vec2 distortedUV = vec2(\n                centeredUV.x + sin(time * 0.7 + centeredUV.y * 5.0) * 0.2,\n                centeredUV.y + cos(time * 0.6 + centeredUV.x * 5.0) * 0.2\n              );\n              \n              // Create noise patterns - more contrast\n              float noiseValue = fbm(distortedUV * 3.0 + time * 0.3);\n              float ripple = sin(dist * 20.0 - time * 3.0) * 0.5 + 0.5;\n              \n              // Combine effects with more intensity\n              float alpha = smoothstep(0.9, 0.0, dist);\n              float intensity = mix(noiseValue, ripple, 0.7) * swirl * pulse;\n              \n              // Enhanced portal colors - bright cyan to deep blue\n              vec3 darkColor = vec3(0.0, 0.1, 0.3);\n              vec3 brightColor = vec3(0.0, 1.0, 1.0) * 2.0;\n              vec3 accentColor = vec3(0.3, 0.8, 1.0);\n              \n              // More complex color mixing\n              vec3 finalColor = mix(darkColor, brightColor, intensity);\n              finalColor = mix(finalColor, accentColor, ripple * swirl);\n              \n              // Enhanced edge glow for portal effect\n              float edgeGlow = smoothstep(0.8, 0.4, dist) * smoothstep(0.0, 0.6, dist);\n              finalColor = mix(finalColor, brightColor, edgeGlow * pulse);\n              \n              // Add portal event horizon effect\n              float eventHorizon = smoothstep(0.8, 0.78, dist) * 2.0;\n              finalColor += vec3(0.0, 1.0, 1.0) * eventHorizon;\n              \n              gl_FragColor = vec4(finalColor, alpha);\n            }\n          `,\n            transparent: true,\n            side: THREE.DoubleSide\n        });\n\n        // Create portal disc using the shader material\n        const portalGeometry = new THREE.CircleGeometry(800, 128);\n        const portal = new THREE.Mesh(portalGeometry, portalShaderMaterial);\n        parentGroup.add(portal);\n\n        // Enhanced portal glow light\n        const portalLight = new THREE.PointLight(0x00ffff, 400, 2000, 2);\n        portalLight.position.set(0, 0, 0);\n        parentGroup.add(portalLight);\n\n        // Add some more volumetric effects around the portal\n        const createPortalWisps = (): THREE.Mesh => {\n            const wispGeometry = new THREE.TorusGeometry(650, 10, 8, 100);\n            const wispMaterial = new THREE.MeshStandardMaterial({\n                color: 0x00ffff,\n                emissive: 0x00ffff,\n                emissiveIntensity: 2,\n                transparent: true,\n                opacity: 0.3,\n                side: THREE.DoubleSide\n            });\n\n            const wisp = new THREE.Mesh(wispGeometry, wispMaterial);\n            wisp.rotation.x = Math.random() * Math.PI;\n            wisp.rotation.y = Math.random() * Math.PI;\n\n            // Store animation parameters - more dramatic for enhanced effect\n            wisp.userData = {\n                rotationSpeed: {\n                    x: (Math.random() - 0.5) * 0.02,  // 10x faster rotation\n                    y: (Math.random() - 0.5) * 0.02,\n                    z: (Math.random() - 0.5) * 0.02\n                },\n                pulseSpeed: 0.5 + Math.random() * 0.3\n            };\n\n            this.portalParticles.push(wisp);\n            return wisp;\n        };\n\n        // Add more wisps for enhanced effect\n        for (let i = 0; i < 8; i++) {\n            parentGroup.add(createPortalWisps());\n        }\n\n        // Store the shader material for animation updates\n        this.portalShaderMaterial = portalShaderMaterial;\n        this.portalLight = portalLight;\n    }\n\n    createNeonDetails(): THREE.Group {\n        const detailsGroup = new THREE.Group();\n\n        // Create evenly spaced neon accents around the ring\n        const createNeonAccent = (angle: number): THREE.Group => {\n            const accentGroup = new THREE.Group();\n\n            // Neon light beam\n            const beamGeometry = new THREE.CylinderGeometry(10, 10, 300, 8);\n            const beamMaterial = new THREE.MeshStandardMaterial({\n                color: 0x00ffff,\n                emissive: 0x00ffff,\n                emissiveIntensity: 1,\n                transparent: true,\n                opacity: 0.8\n            });\n            const beam = new THREE.Mesh(beamGeometry, beamMaterial);\n            beam.rotation.x = Math.PI / 2; // Align with ring\n\n            // Light source for glow\n            const light = new THREE.PointLight(0x00ffff, 100, 400, 2);\n            light.position.set(0, 0, 0);\n\n            accentGroup.add(beam);\n            accentGroup.add(light);\n\n            // Position on the ring\n            accentGroup.position.x = Math.cos(angle) * 1000;\n            accentGroup.position.y = Math.sin(angle) * 1000;\n            accentGroup.rotation.z = angle - Math.PI / 2; // Orient toward center\n\n            // Store for animation\n            light.userData = {\n                originalIntensity: light.intensity,\n                phase: Math.random() * Math.PI * 2\n            };\n\n            this.navLights.push({ light, lightMesh: beam });\n\n            return accentGroup;\n        };\n\n        // Add 8 neon accents evenly around the ring\n        for (let i = 0; i < 8; i++) {\n            const angle = (i / 8) * Math.PI * 2;\n            detailsGroup.add(createNeonAccent(angle));\n        }\n\n        return detailsGroup;\n    }\n\n    getPosition(): THREE.Vector3 {\n        // Updated to 2x height from the sun\n        return new THREE.Vector3(0, 10000, 0);\n    }\n\n    getRegionInfo(): { center: THREE.Vector3; radius: number } {\n        // Updated center position to match new height\n        return {\n            center: new THREE.Vector3(0, 10000, 0),\n            radius: 2000\n        };\n    }\n\n    update(): void {\n        // Animate navigation lights with pulsing effect\n        if (this.navLights) {\n            this.navLights.forEach(({ light, lightMesh }) => {\n                const time = Date.now() * 0.001;\n                const flicker = 0.7 + 0.3 * Math.sin(time * 2 + (light.userData as { phase?: number }).phase!);\n\n                light.intensity = (light.userData as { originalIntensity: number }).originalIntensity * flicker;\n\n                // Also update the light beam material\n                if (lightMesh.material) {\n                    const material = lightMesh.material as THREE.MeshStandardMaterial;\n                    material.emissiveIntensity = flicker;\n                    material.opacity = 0.5 + (flicker * 0.5);\n                }\n            });\n        }\n\n        // Update shader time for the portal effect\n        if (this.portalShaderMaterial) {\n            this.portalShaderMaterial.uniforms.time.value = Date.now() * 0.001;\n\n            // Make portal light pulse with time\n            if (this.portalLight) {\n                const time = Date.now() * 0.001;\n                this.portalLight.intensity = 400 + Math.sin(time * 2.0) * 150;\n            }\n        }\n\n        // Animate the portal wisp effects\n        if (this.portalParticles) {\n            this.portalParticles.forEach(particle => {\n                const time = Date.now() * 0.001;\n\n                // Apply rotation based on stored rotation speeds\n                if (particle.userData.rotationSpeed) {\n                    particle.rotation.x += particle.userData.rotationSpeed.x;\n                    particle.rotation.y += particle.userData.rotationSpeed.y;\n                    particle.rotation.z += particle.userData.rotationSpeed.z;\n                }\n\n                // Apply subtle scale pulsing if present\n                if (particle.userData.pulseSpeed) {\n                    const pulse = 0.9 + 0.2 * Math.sin(time * particle.userData.pulseSpeed);\n                    particle.scale.set(pulse, pulse, pulse);\n                }\n            });\n        }\n\n        // Update counter-rotating ring\n        if (this.counterRotatingRing) {\n            this.counterRotatingRing.rotation.x += 0.006; // Counter rotate\n            this.counterRotatingRing.rotation.y += 0.009;\n            this.counterRotatingRing.rotation.z -= 0.003;\n        }\n\n        // Rotate the stargate on all three axes for a more dynamic spinning effect (30x faster)\n        if (this.stargate) {\n            this.stargate.rotation.x += 0.003;   // 30x faster rotation on X axis (was 0.0001)\n            this.stargate.rotation.y += 0.0045;  // 30x faster rotation on Y axis (was 0.00015)\n            this.stargate.rotation.z += 0.006;   // 30x faster rotation on Z axis (was 0.0002)\n        }\n    }\n\n    dispose(): void {\n        if (this.stargate) {\n            this.scene.remove(this.stargate);\n        }\n        this.stargate = null;\n        this.navLights = [];\n        this.portalParticles = [];\n        this.portalShaderMaterial = undefined;\n        this.portalLight = undefined;\n        this.counterRotatingRing = undefined;\n    }\n}\n","// systemConfig.ts - Star system configuration and constants\n\nexport const STAR_CLASSES = ['O', 'B', 'A', 'F', 'G', 'K', 'M'] as const;\nexport type StarClass = typeof STAR_CLASSES[number];\n\nexport const SYSTEM_CLASSIFICATIONS = [\n    'Resource-Rich',\n    'Ancient',\n    'Unstable',\n    'Barren',\n    'Hazardous',\n    'Peaceful'\n] as const;\nexport type SystemClassification = typeof SYSTEM_CLASSIFICATIONS[number] | 'Home System' | 'Custom';\n\nexport const SKYBOX_TEXTURES = [\n    './assets/s1.jpg',\n    './assets/s2.jpg',\n    './assets/s3.jpg',\n    './assets/s4.jpg',\n    './assets/s5.jpg',\n    './assets/s6.jpg',\n    './assets/s7.jpg',\n    './assets/s8.jpg',\n    './assets/s9.jpg'\n] as const;\n\nexport const RESOURCE_DISTRIBUTION: Record<StarClass, { iron: number; gold: number; platinum: number }> = {\n    'O': { iron: 0.3, gold: 0.4, platinum: 0.3 },\n    'B': { iron: 0.2, gold: 0.3, platinum: 0.5 },\n    'A': { iron: 0.2, gold: 0.5, platinum: 0.3 },\n    'F': { iron: 0.3, gold: 0.4, platinum: 0.3 },\n    'G': { iron: 0.4, gold: 0.3, platinum: 0.3 },\n    'K': { iron: 0.5, gold: 0.3, platinum: 0.2 },\n    'M': { iron: 0.6, gold: 0.2, platinum: 0.2 }\n};\n\nexport const CLASSIFICATION_MULTIPLIERS: Record<string, { iron: number; gold: number; platinum: number }> = {\n    'Resource-Rich': { iron: 2.0, gold: 2.0, platinum: 2.0 },\n    'Ancient': { iron: 1.0, gold: 1.5, platinum: 2.5 },\n    'Unstable': { iron: 1.0, gold: 1.0, platinum: 3.0 },\n    'Barren': { iron: 0.5, gold: 0.5, platinum: 0.5 },\n    'Hazardous': { iron: 1.5, gold: 1.5, platinum: 1.5 },\n    'Peaceful': { iron: 1.0, gold: 1.0, platinum: 1.0 },\n    'Home System': { iron: 1.0, gold: 1.0, platinum: 1.0 }\n};\n\nexport const STAR_COLORS: Record<StarClass, number> = {\n    'O': 0x9bb0ff, // Blue\n    'B': 0xaabfff, // Blue-white\n    'A': 0xcad7ff, // White\n    'F': 0xf8f7ff, // Yellow-white\n    'G': 0xfff4ea, // Yellow (like our sun)\n    'K': 0xffd2a1, // Orange\n    'M': 0xffcc6f  // Red\n};\n\nexport const SKYBOX_COLORS: Record<StarClass, number> = {\n    'O': 0x0000ff, // Blue tint\n    'B': 0x4444ff, // Blue-white tint\n    'A': 0x8888ff, // White-blue tint\n    'F': 0xddddff, // Yellow-white tint\n    'G': 0xffffdd, // Yellow tint\n    'K': 0xffddaa, // Orange tint\n    'M': 0xff8866  // Red tint\n};\n","// systemNames.ts - System name generation and descriptions\n\nimport type { StarClass, SystemClassification } from './systemConfig.js';\n\nexport class SystemNames {\n    static generateSystemName(starClass: StarClass | string): string {\n        const prefixes = [\n            'Alpha', 'Beta', 'Gamma', 'Delta', 'Epsilon', 'Zeta', 'Eta', 'Theta',\n            'Proxima', 'Nova', 'Sirius', 'Vega', 'Rigel', 'Antares', 'Arcturus'\n        ];\n\n        const suffixes = [\n            'Prime', 'Major', 'Minor', 'A', 'B', 'I', 'II', 'III', 'IV', 'V'\n        ];\n\n        const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];\n        const suffix = Math.random() > 0.7 ? ` ${suffixes[Math.floor(Math.random() * suffixes.length)]}` : '';\n        const number = Math.floor(Math.random() * 999) + 1;\n\n        return `${prefix} ${starClass}${number}${suffix}`;\n    }\n\n    static generateSpecialFeatures(classification: SystemClassification | string): string[] {\n        const features: string[] = [];\n\n        switch (classification) {\n            case 'Resource-Rich':\n                features.push('Dense Asteroid Fields', 'Rich Mineral Veins');\n                break;\n            case 'Ancient':\n                features.push('Abandoned Structures', 'Ancient Artifacts');\n                break;\n            case 'Unstable':\n                features.push('Solar Flares', 'Radiation Bursts');\n                break;\n            case 'Barren':\n                features.push('Minimal Resources', 'Few Planets');\n                break;\n            case 'Hazardous':\n                features.push('Asteroid Storms', 'Energy Anomalies');\n                break;\n            case 'Peaceful':\n                features.push('Stable Environment', 'Optimal Mining Conditions');\n                break;\n        }\n\n        return features;\n    }\n\n    static generateDescription(starClass: StarClass | string, classification: SystemClassification | string): string {\n        const starDescriptions: Record<string, string> = {\n            'O': \"A rare, hot blue star system with intense radiation.\",\n            'B': \"A blue-white star system with high energy output.\",\n            'A': \"A white star system with moderate radiation levels.\",\n            'F': \"A yellow-white star system with mild conditions.\",\n            'G': \"A yellow star system similar to our Solar System.\",\n            'K': \"An orange star system with reduced energy output.\",\n            'M': \"A common red dwarf system with low energy output.\"\n        };\n\n        const classDescriptions: Record<string, string> = {\n            'Resource-Rich': \"The system is known for its abundant resources and dense asteroid fields.\",\n            'Ancient': \"This ancient system contains remnants of long-lost civilizations.\",\n            'Unstable': \"Be cautious as unpredictable stellar activity occurs in this system.\",\n            'Barren': \"Resources are scarce in this mostly empty star system.\",\n            'Hazardous': \"Environmental hazards make mining operations difficult but rewarding.\",\n            'Peaceful': \"This system offers stable and optimal conditions for mining operations.\",\n            'Home System': \"Our home system, containing Earth and the origin of humanity.\"\n        };\n\n        return `${starDescriptions[starClass]} ${classDescriptions[classification]}`;\n    }\n}\n","// systemUtils.ts - Utility functions for star system generation\n\nimport * as THREE from 'three';\nimport { STAR_CLASSES, SYSTEM_CLASSIFICATIONS, SKYBOX_TEXTURES, StarClass, SystemClassification } from './systemConfig.js';\n\nexport class SystemUtils {\n    static getRandomStarClass(): StarClass {\n        const weights = [1, 2, 5, 10, 15, 20, 50]; // More M class stars, fewer O class\n        const total = weights.reduce((sum, weight) => sum + weight, 0);\n        let random = Math.random() * total;\n\n        for (let i = 0; i < weights.length; i++) {\n            if (random < weights[i]) {\n                return STAR_CLASSES[i];\n            }\n            random -= weights[i];\n        }\n\n        return STAR_CLASSES[SystemUtils.getRandomInt(0, STAR_CLASSES.length - 1)];\n    }\n\n    static getRandomClassification(): SystemClassification {\n        return SYSTEM_CLASSIFICATIONS[SystemUtils.getRandomInt(0, SYSTEM_CLASSIFICATIONS.length - 1)];\n    }\n\n    static getRandomSkyboxTexture(): string {\n        return SKYBOX_TEXTURES[SystemUtils.getRandomInt(0, SKYBOX_TEXTURES.length - 1)];\n    }\n\n    static generateMapPosition(): THREE.Vector3 {\n        const radius = 150 + Math.random() * 100;\n        const angle = Math.random() * Math.PI * 2;\n\n        const x = Math.cos(angle) * radius;\n        const y = Math.sin(angle) * radius;\n\n        return new THREE.Vector3(x, y, 0);\n    }\n\n    static getRandomInt(min: number, max: number): number {\n        return Math.floor(Math.random() * (max - min + 1)) + min;\n    }\n\n    static getRandomFloat(min: number, max: number): number {\n        return Math.random() * (max - min) + min;\n    }\n\n    static getRandomColor(): number {\n        return Math.floor(Math.random() * 0xFFFFFF);\n    }\n}\n","// systemFactory.ts - Star system creation and configuration\n\nimport * as THREE from 'three';\nimport {\n    RESOURCE_DISTRIBUTION,\n    CLASSIFICATION_MULTIPLIERS,\n    STAR_COLORS,\n    SKYBOX_COLORS,\n    StarClass,\n    SystemClassification\n} from './systemConfig.js';\nimport { SystemNames } from './systemNames.js';\nimport { SystemUtils } from './systemUtils.js';\nimport type { PlanetData } from '../planets/planetFactory.js';\n\ninterface ResourceMultipliers {\n    iron: number;\n    gold: number;\n    platinum: number;\n}\n\nexport interface StarSystemData {\n    id: string;\n    name: string;\n    starClass: StarClass | string;\n    classification: SystemClassification | string;\n    starColor: number;\n    planetCount: number;\n    asteroidDensity: number;\n    specialFeatures: string[];\n    description: string;\n    connections: string[];\n    position: THREE.Vector3;\n    skyboxParams: {\n        starDensity: number;\n        nebulaDensity: number;\n        color: number;\n        texturePath: string;\n        brightness?: number;\n        isCustomTexture?: boolean;\n    };\n    resourceMultipliers: ResourceMultipliers;\n    isCustomSystem?: boolean;\n}\n\nexport interface CustomSystemData {\n    id: string;\n    name: string;\n    starClass?: StarClass | string;\n    classification?: SystemClassification | string;\n    starColor?: number;\n    planetData?: PlanetData[];\n    asteroidDensity?: number;\n    specialFeatures?: string[];\n    description?: string;\n    position?: THREE.Vector3;\n    skyboxParams?: {\n        starDensity?: number;\n        nebulaDensity?: number;\n        color?: number;\n        brightness?: number;\n    };\n    skyboxUrl?: string;\n    resourceMultipliers?: ResourceMultipliers;\n}\n\nexport class SystemFactory {\n    static createSolarSystem(): StarSystemData {\n        return {\n            id: 'Solar System',\n            name: 'Solar System',\n            starClass: 'G',\n            classification: 'Home System',\n            starColor: 0xFFFF00,\n            planetCount: 8,\n            asteroidDensity: 1.0,\n            specialFeatures: ['Earth'],\n            description: 'Our home system, with Earth as the starting location.',\n            connections: [],\n            position: new THREE.Vector3(0, 0, 0),\n            skyboxParams: {\n                starDensity: 1.0,\n                nebulaDensity: 0.5,\n                color: 0xFFFFFF,\n                texturePath: './assets/2k_stars_milky_way.jpg',\n                brightness: 1.0\n            },\n            resourceMultipliers: {\n                iron: 1.0,\n                gold: 1.0,\n                platinum: 1.0\n            }\n        };\n    }\n\n    static createRandomSystem(id: string): StarSystemData {\n        const starClass = SystemUtils.getRandomStarClass();\n        const classification = SystemUtils.getRandomClassification();\n        const starColor = STAR_COLORS[starClass] || 0xffffff;\n        const resourceMult = SystemFactory.calculateResourceMultipliers(starClass, classification);\n        const skyboxTexture = SystemUtils.getRandomSkyboxTexture();\n\n        return {\n            id: id,\n            name: SystemNames.generateSystemName(starClass),\n            starClass: starClass,\n            classification: classification,\n            starColor: starColor,\n            planetCount: SystemUtils.getRandomInt(2, 10),\n            asteroidDensity: SystemUtils.getRandomFloat(0.5, 2.5),\n            specialFeatures: SystemNames.generateSpecialFeatures(classification),\n            description: SystemNames.generateDescription(starClass, classification),\n            connections: [],\n            position: SystemUtils.generateMapPosition(),\n            skyboxParams: {\n                starDensity: SystemUtils.getRandomFloat(0.7, 1.5),\n                nebulaDensity: SystemUtils.getRandomFloat(0.3, 1.2),\n                color: SKYBOX_COLORS[starClass] || 0xffffff,\n                texturePath: skyboxTexture,\n                brightness: 0.8\n            },\n            resourceMultipliers: resourceMult\n        };\n    }\n\n    static calculateResourceMultipliers(starClass: StarClass, classification: SystemClassification | string): ResourceMultipliers {\n        const baseDistribution = RESOURCE_DISTRIBUTION[starClass];\n        const classMultiplier = CLASSIFICATION_MULTIPLIERS[classification];\n\n        return {\n            iron: baseDistribution.iron * classMultiplier.iron,\n            gold: baseDistribution.gold * classMultiplier.gold,\n            platinum: baseDistribution.platinum * classMultiplier.platinum\n        };\n    }\n\n    static createCustomSystem(systemData: CustomSystemData): StarSystemData | null {\n        if (!systemData || !systemData.id || !systemData.name) {\n            console.error('Invalid system data', systemData);\n            return null;\n        }\n\n        return {\n            id: systemData.id,\n            name: systemData.name,\n            starClass: systemData.starClass || SystemUtils.getRandomStarClass(),\n            classification: systemData.classification || 'Custom',\n            starColor: systemData.starColor || STAR_COLORS[(systemData.starClass as StarClass) || 'G'],\n            planetCount: systemData.planetData ? systemData.planetData.length : 0,\n            asteroidDensity: systemData.asteroidDensity || 1.0,\n            specialFeatures: systemData.specialFeatures || ['User Created'],\n            description: systemData.description || 'A custom star system created by the user',\n            connections: [],\n            position: systemData.position || SystemUtils.generateMapPosition(),\n            skyboxParams: {\n                starDensity: systemData.skyboxParams?.starDensity || 1.0,\n                nebulaDensity: systemData.skyboxParams?.nebulaDensity || 0.8,\n                color: systemData.skyboxParams?.color || SKYBOX_COLORS[(systemData.starClass as StarClass) || 'G'],\n                texturePath: systemData.skyboxUrl || SystemUtils.getRandomSkyboxTexture(),\n                brightness: systemData.skyboxParams?.brightness || 0.8,\n                isCustomTexture: !!systemData.skyboxUrl\n            },\n            resourceMultipliers: systemData.resourceMultipliers || {\n                iron: 1.0,\n                gold: 1.0,\n                platinum: 1.0\n            },\n            isCustomSystem: true\n        };\n    }\n}\n","// starSystemGenerator.ts - Procedural generation of star systems\n\nimport * as THREE from 'three';\nimport { SystemFactory } from './generator/systemFactory';\nimport { SystemUtils } from './generator/systemUtils';\nimport type { PlanetData } from './planets/planetFactory';\n\ninterface ResourceMultipliers {\n    iron: number;\n    gold: number;\n    platinum: number;\n}\n\ninterface SkyboxParams {\n    starDensity: number;\n    nebulaDensity: number;\n    color: number;\n    texturePath: string;\n    brightness?: number;\n    isCustomTexture?: boolean;\n}\n\ninterface StarSystemData {\n    id: string;\n    name: string;\n    starClass: string;\n    classification: string;\n    starColor: number;\n    planetCount: number;\n    asteroidDensity: number;\n    specialFeatures: string[];\n    description: string;\n    connections: string[];\n    position: THREE.Vector3;\n    skyboxParams: SkyboxParams;\n    resourceMultipliers: ResourceMultipliers;\n    lightIntensityMultiplier?: number;\n    isCustomSystem?: boolean;\n}\n\ninterface CustomSystemData {\n    id: string;\n    name: string;\n    starClass?: string;\n    classification?: string;\n    starColor?: number;\n    planetData?: PlanetData[];\n    asteroidDensity?: number;\n    specialFeatures?: string[];\n    description?: string;\n    position?: THREE.Vector3;\n    skyboxParams?: Partial<SkyboxParams>;\n    skyboxUrl?: string;\n    resourceMultipliers?: ResourceMultipliers;\n    lightIntensityMultiplier?: number;\n}\n\ninterface GameGlobal {\n    spaceship?: { isDocked?: boolean; dock?: () => void };\n    controls?: { dockingSystem?: { positionNearStargate?: () => void; showStargateUI?: () => void } };\n    ui?: { stargateInterface?: { showStargateUI?: () => void } };\n}\n\nexport class StarSystemGenerator {\n    scene: THREE.Scene;\n    systems: Record<string, StarSystemData>;\n    currentSystem: string | null;\n    warpGates: Record<string, string[]>;\n    customPlanetData?: Record<string, PlanetData[]>;\n\n    constructor(scene: THREE.Scene) {\n        this.scene = scene;\n        this.systems = {};\n        this.currentSystem = null;\n        this.warpGates = {};\n        this.initializeSystems();\n    }\n\n    // Initialize star systems with Solar System as default\n    initializeSystems(): void {\n        console.log(\"Initializing star systems...\");\n\n        this.systems['Solar System'] = SystemFactory.createSolarSystem();\n        this.generateRandomSystems(5);\n        this.createSystemConnections();\n        this.setCurrentSystem('Solar System');\n\n        console.log(\"Star systems initialized\");\n    }\n\n    // Generate random star systems\n    generateRandomSystems(count: number): void {\n        for (let i = 0; i < count; i++) {\n            const id = `System-${i + 1}`;\n            this.systems[id] = SystemFactory.createRandomSystem(id);\n        }\n    }\n\n    // Create connections between systems\n    createSystemConnections(): void {\n        const systemIds = Object.keys(this.systems);\n\n        // Connect Solar System to at least two random systems\n        const solarConnections = this.getRandomSystemsExcept('Solar System', 2);\n        for (const targetId of solarConnections) {\n            this.createConnection('Solar System', targetId);\n        }\n\n        // Ensure each system has at least one connection\n        for (const systemId of systemIds) {\n            const system = this.systems[systemId];\n            if (system.connections.length === 0) {\n                const targetId = this.getRandomSystemExcept(systemId);\n                this.createConnection(systemId, targetId);\n            }\n        }\n\n        // Add additional random connections\n        const extraConnectionCount = Math.floor(systemIds.length / 2);\n        for (let i = 0; i < extraConnectionCount; i++) {\n            const sourceId = systemIds[SystemUtils.getRandomInt(0, systemIds.length - 1)];\n            const targetId = this.getRandomSystemExcept(sourceId);\n\n            if (!this.systems[sourceId].connections.includes(targetId)) {\n                this.createConnection(sourceId, targetId);\n            }\n        }\n    }\n\n    // Create a connection between two systems\n    createConnection(sourceId: string, targetId: string): void {\n        this.systems[sourceId].connections.push(targetId);\n        this.systems[targetId].connections.push(sourceId);\n\n        if (!this.warpGates[sourceId]) {\n            this.warpGates[sourceId] = [];\n        }\n        if (!this.warpGates[targetId]) {\n            this.warpGates[targetId] = [];\n        }\n\n        this.warpGates[sourceId].push(targetId);\n        this.warpGates[targetId].push(sourceId);\n\n        console.log(`Created connection between ${sourceId} and ${targetId}`);\n    }\n\n    // Get list of connections for current system\n    getCurrentSystemConnections(): string[] {\n        if (!this.currentSystem) return [];\n        return this.systems[this.currentSystem].connections;\n    }\n\n    // Get resource distribution for current system\n    getCurrentSystemResources(): ResourceMultipliers {\n        if (!this.currentSystem) return { iron: 1, gold: 1, platinum: 1 };\n\n        const system = this.systems[this.currentSystem];\n        return system.resourceMultipliers;\n    }\n\n    // Set the current active system\n    setCurrentSystem(systemId: string): boolean {\n        if (this.systems[systemId]) {\n            this.currentSystem = systemId;\n            console.log(`Traveled to system: ${systemId}`);\n            return true;\n        }\n        return false;\n    }\n\n    // Travel to a connected system\n    travelToSystem(targetSystemId: string): boolean {\n        // Verify the target system exists\n        if (!this.systems[targetSystemId]) {\n            console.error(`System ${targetSystemId} does not exist`);\n            return false;\n        }\n\n        // Verify there is a connection from current to target\n        const connections = this.getCurrentSystemConnections();\n        if (!connections.includes(targetSystemId)) {\n            console.error(`No connection from ${this.currentSystem} to ${targetSystemId}`);\n            return false;\n        }\n\n        // Check if the ship is docked\n        const game = (window as any).game as GameGlobal | undefined;\n        if (game?.spaceship && game.spaceship.isDocked) {\n            console.log(\"Player is docked during interstellar travel\");\n        }\n\n        // Log current system params\n        if (this.currentSystem && this.systems[this.currentSystem]) {\n            const currentParams = this.systems[this.currentSystem].skyboxParams;\n            console.log(`${this.currentSystem} skybox params before travel: \n                         color=${currentParams.color.toString(16)}, \n                         starDensity=${currentParams.starDensity}, \n                         nebulaDensity=${currentParams.nebulaDensity}, \n                         texture=${currentParams.texturePath}`);\n        }\n\n        // Log target system params\n        if (this.systems[targetSystemId]) {\n            const targetParams = this.systems[targetSystemId].skyboxParams;\n            console.log(`Traveling to ${targetSystemId} with skybox params: \n                         color=${targetParams.color.toString(16)}, \n                         starDensity=${targetParams.starDensity}, \n                         nebulaDensity=${targetParams.nebulaDensity}, \n                         texture=${targetParams.texturePath}`);\n        }\n\n        // Set the new current system\n        this.setCurrentSystem(targetSystemId);\n        return true;\n    }\n\n    // Get all star systems for the map\n    getAllSystems(): Record<string, StarSystemData> {\n        return this.systems;\n    }\n\n    // Get current system data\n    getCurrentSystemData(): StarSystemData | null {\n        if (!this.currentSystem) return null;\n        return this.systems[this.currentSystem];\n    }\n\n    // Helper methods\n\n    getRandomSystemsExcept(exceptId: string, count: number): string[] {\n        const systemIds = Object.keys(this.systems).filter(id => id !== exceptId);\n        const selected: string[] = [];\n\n        for (let i = 0; i < Math.min(count, systemIds.length); i++) {\n            const index = SystemUtils.getRandomInt(0, systemIds.length - 1);\n            selected.push(systemIds[index]);\n            systemIds.splice(index, 1);\n        }\n\n        return selected;\n    }\n\n    getRandomSystemExcept(exceptId: string): string {\n        const systemIds = Object.keys(this.systems).filter(id => id !== exceptId);\n        const index = SystemUtils.getRandomInt(0, systemIds.length - 1);\n        return systemIds[index];\n    }\n\n    // Add custom system\n    addCustomSystem(systemData: CustomSystemData): boolean {\n        const customSystem = SystemFactory.createCustomSystem(systemData);\n        if (!customSystem) {\n            return false;\n        }\n\n        if (this.systems[systemData.id]) {\n            console.warn(`System with ID ${systemData.id} already exists, overwriting`);\n        }\n\n        console.log(`Adding custom system: ${systemData.name} (${systemData.id})`);\n\n        // Store custom planet data if provided\n        if (systemData.planetData && Array.isArray(systemData.planetData)) {\n            this.storePlanetData(systemData.id, systemData.planetData);\n        }\n\n        this.systems[systemData.id] = customSystem;\n\n        // Create connections\n        this.createConnection('Solar System', systemData.id);\n\n        const randomSystem = this.getRandomSystemExcept(systemData.id);\n        if (randomSystem) {\n            this.createConnection(systemData.id, randomSystem);\n        }\n\n        console.log(`Custom system ${systemData.name} added successfully with connections to Solar System and ${randomSystem || 'no other system'}`);\n\n        return true;\n    }\n\n    // Store custom planet data\n    storePlanetData(systemId: string, planetData: PlanetData[]): void {\n        if (!Array.isArray(planetData)) {\n            console.error('Planet data must be an array');\n            return;\n        }\n\n        const standardizedPlanets: PlanetData[] = [];\n\n        for (let i = 0; i < planetData.length; i++) {\n            const planet = planetData[i];\n\n            standardizedPlanets.push({\n                name: planet.name || `Planet-${i + 1}`,\n                size: planet.size || (300 + Math.random() * 500),\n                distance: planet.distance || (4800 + (i * 8000) + (Math.random() * 2000)),\n                speed: planet.speed || (0.001 + (Math.random() * 0.001)),\n                color: planet.color || SystemUtils.getRandomColor(),\n                rings: planet.rings !== undefined ? planet.rings : Math.random() > 0.7,\n                textureUrl: planet.textureUrl || undefined,\n                axialTilt: planet.axialTilt || (Math.random() * Math.PI * 0.5),\n                orbitalTilt: planet.orbitalTilt || (Math.random() * Math.PI * 0.2)\n            });\n        }\n\n        if (!this.customPlanetData) {\n            this.customPlanetData = {};\n        }\n\n        this.customPlanetData[systemId] = standardizedPlanets;\n        console.log(`Stored ${standardizedPlanets.length} planets for system ${systemId}`);\n    }\n\n    /**\n     * Returns player to stargate after interstellar travel\n     * Should be called after travel to ensure proper docking state\n     */\n    returnFromTravel(): boolean {\n        console.log(\"StarSystemGenerator: Handling return from interstellar travel\");\n\n        // Check if game and spaceship are available\n        const game = (window as any).game as GameGlobal | undefined;\n        if (!game || !game.spaceship) {\n            console.error(\"StarSystemGenerator: Cannot return from travel - game or spaceship not found\");\n            return false;\n        }\n\n        // Ensure the player is docked after travel\n        if (!game.spaceship.isDocked) {\n            console.log(\"StarSystemGenerator: Setting ship to docked state after travel\");\n            game.spaceship.dock && game.spaceship.dock();\n        }\n\n        // Reposition ship near stargate\n        const dockingSystem = game.controls?.dockingSystem;\n        if (dockingSystem) {\n            console.log(\"StarSystemGenerator: Repositioning ship near stargate\");\n            dockingSystem.positionNearStargate && dockingSystem.positionNearStargate();\n\n            // Show stargate UI\n            if (typeof dockingSystem.showStargateUI === 'function') {\n                console.log(\"StarSystemGenerator: Showing stargate UI via docking system\");\n                dockingSystem.showStargateUI();\n                return true;\n            }\n        }\n\n        // Fallback - try to find UI or stargate interface directly\n        if (game.ui?.stargateInterface?.showStargateUI) {\n            console.log(\"StarSystemGenerator: Showing stargate UI via game.ui.stargateInterface\");\n            game.ui.stargateInterface.showStargateUI();\n            return true;\n        }\n\n        console.warn(\"StarSystemGenerator: Could not fully complete return from travel\");\n        return false;\n    }\n}\n","// sceneInitializer.ts - Handles scene setup and initialization logic\n\nimport { Skybox } from '../skybox.js';\nimport { Sun } from '../sun.js';\nimport { Planets } from '../planets.js';\nimport { Stargate } from '../stargate.js';\nimport { StarSystemGenerator } from '../starSystemGenerator.js';\nimport type { AsteroidBelt } from '../asteroidBelt.js';\nimport type { SpaceAnomalies } from '../spaceAnomalies.js';\nimport type { SystemTransition } from '../systemTransition.js';\nimport type { VibeVersePortals } from '../vibeVersePortals.js';\n\ninterface EnvironmentComponents {\n    skybox: Skybox;\n    sun: Sun;\n    starSystemGenerator: StarSystemGenerator;\n    planets: Planets;\n    stargate: Stargate;\n}\n\ninterface RemainingComponents {\n    asteroidBelt: AsteroidBelt;\n    spaceAnomalies: SpaceAnomalies;\n    systemTransition: SystemTransition;\n    customSystemCreator: unknown;\n}\n\nexport class SceneInitializer {\n    scene: any;\n    componentsLoaded: boolean;\n    skybox?: Skybox;\n    sun?: Sun;\n    starSystemGenerator?: StarSystemGenerator;\n    planets?: Planets;\n    stargate?: Stargate;\n    asteroidBelt?: AsteroidBelt;\n    spaceAnomalies?: SpaceAnomalies;\n    systemTransition?: SystemTransition;\n    customSystemCreator?: unknown;\n    vibeVersePortals?: VibeVersePortals;\n\n    constructor(scene: any) {\n        this.scene = scene;\n        this.componentsLoaded = false;\n    }\n\n    // Initialize essential components first\n    initializeEssentialComponents(): EnvironmentComponents {\n        console.log(\"Initializing essential environment components...\");\n\n        // Initialize only essential components first\n        this.skybox = new Skybox(this.scene);\n        this.sun = new Sun(this.scene);\n\n        // Initialize star system generator\n        this.starSystemGenerator = new StarSystemGenerator(this.scene);\n\n        // Initialize planets with reference to starSystemGenerator - needed for basic gameplay\n        this.planets = new Planets(this.scene, this.starSystemGenerator);\n\n        // Initialize stargate - needed for docking UI\n        this.stargate = new Stargate(this.scene);\n\n        console.log(\"Essential environment components initialized\");\n\n        return {\n            skybox: this.skybox,\n            sun: this.sun,\n            starSystemGenerator: this.starSystemGenerator,\n            planets: this.planets,\n            stargate: this.stargate\n        };\n    }\n\n    // Load remaining non-essential components asynchronously\n    async loadRemainingComponents(): Promise<RemainingComponents> {\n        console.log(\"Loading remaining environment components...\");\n\n        // Initialize asteroid belt - slightly defer to prioritize UI loading\n        const { AsteroidBelt } = await import('../asteroidBelt.js');\n        this.asteroidBelt = new AsteroidBelt(this.scene);\n\n        // Initialize space anomalies\n        const { SpaceAnomalies } = await import('../spaceAnomalies.js');\n        this.spaceAnomalies = new SpaceAnomalies(this.scene);\n\n        // Initialize system transition effects\n        const { SystemTransition } = await import('../systemTransition.js');\n        this.systemTransition = new SystemTransition(this.scene, this.scene.camera);\n\n        // Initialize the custom system creator\n        const { CustomSystemCreator } = await import('../../ui/customSystemCreator.ts');\n        this.customSystemCreator = new CustomSystemCreator(this.starSystemGenerator ?? null, this as any);\n        console.log(\"Custom system creator initialized:\", this.customSystemCreator);\n\n        this.componentsLoaded = true;\n        console.log(\"All environment components initialized\");\n\n        return {\n            asteroidBelt: this.asteroidBelt,\n            spaceAnomalies: this.spaceAnomalies,\n            systemTransition: this.systemTransition,\n            customSystemCreator: this.customSystemCreator\n        };\n    }\n\n    // Initialize VibeVerse portals - requires spaceship reference\n    async initializePortals(spaceship: unknown): Promise<VibeVersePortals> {\n        const { VibeVersePortals } = await import('../vibeVersePortals.js');\n        this.vibeVersePortals = new VibeVersePortals(this.scene, spaceship as any);\n        console.log(\"VibeVerse portals initialized\");\n        return this.vibeVersePortals;\n    }\n\n    dispose(): void {\n        // Dispose all components\n        if (this.skybox) this.skybox.dispose();\n        if (this.sun) this.sun.dispose();\n        if (this.planets) this.planets.dispose();\n        if (this.asteroidBelt) this.asteroidBelt.dispose();\n        if (this.stargate) this.stargate.dispose();\n        if (this.spaceAnomalies) this.spaceAnomalies.clearAllAnomalies();\n        if (this.vibeVersePortals) this.vibeVersePortals.dispose();\n    }\n}\n","// regionManager.ts - Handles celestial object regions and location tracking\n\nimport * as THREE from 'three';\n\ninterface RegionInfo {\n    center?: THREE.Vector3;\n    position?: THREE.Vector3;\n    radius?: number;\n    minRadius?: number;\n    maxRadius?: number;\n}\n\ninterface PlanetRegion {\n    name?: string;\n    position?: THREE.Vector3;\n    radius?: number;\n}\n\ninterface PlanetLike {\n    getPlanetRegions?: () => Record<string, PlanetRegion>;\n}\n\ninterface SunLike {\n    getPosition: () => THREE.Vector3;\n    getRadius: () => number;\n}\n\ninterface StargateLike {\n    getRegionInfo: () => { center: THREE.Vector3; radius: number };\n}\n\ninterface AsteroidBeltLike {\n    getRegionInfo: () => { center: THREE.Vector3; innerRadius: number; outerRadius: number };\n}\n\ninterface SpaceAnomaliesLike {\n    getRegionInfo: () => { center: THREE.Vector3; innerRadius: number; outerRadius: number };\n    findClosestAnomaly?: (position: THREE.Vector3, maxDistance?: number) => { position: THREE.Vector3; type: string; orbCollected: boolean } | null;\n}\n\ninterface AsteroidLike {\n    mesh: THREE.Object3D;\n}\n\nexport class RegionManager {\n    planetRegions: Record<string, RegionInfo>;\n\n    constructor() {\n        this.planetRegions = {};\n    }\n\n    // Basic region setup for essential components only\n    setupInitialRegions(sun: SunLike, stargate: StargateLike, planets: PlanetLike): void {\n        console.log(\"Setting up essential environment regions\");\n\n        // Initialize the planetRegions object\n        this.planetRegions = {};\n\n        // Safely get planet regions if the method exists\n        if (planets && typeof planets.getPlanetRegions === 'function') {\n            try {\n                this.planetRegions = planets.getPlanetRegions();\n            } catch (error) {\n                console.warn(\"Error getting planet regions:\", error);\n            }\n        } else {\n            console.warn(\"planets.getPlanetRegions is not available, using empty object instead\");\n        }\n\n        // Add sun region\n        this.planetRegions[\"Sun\"] = {\n            center: sun.getPosition(),\n            radius: sun.getRadius()\n        };\n\n        // Add stargate region\n        const stargateRegion = stargate.getRegionInfo();\n        this.planetRegions[\"Stargate\"] = {\n            center: stargateRegion.center,\n            radius: stargateRegion.radius\n        };\n    }\n\n    // Complete region setup with all components\n    setupRegions(\n        sun: SunLike,\n        stargate: StargateLike,\n        planets: PlanetLike,\n        asteroidBelt: AsteroidBeltLike,\n        spaceAnomalies: SpaceAnomaliesLike\n    ): void {\n        console.log(\"Setting up environment regions\");\n\n        // Initialize or reset the planetRegions object\n        this.planetRegions = {};\n\n        // Safely get planet regions if the method exists\n        if (planets && typeof planets.getPlanetRegions === 'function') {\n            try {\n                this.planetRegions = planets.getPlanetRegions();\n            } catch (error) {\n                console.warn(\"Error getting planet regions in setupRegions:\", error);\n            }\n        } else {\n            console.warn(\"planets.getPlanetRegions is not available in setupRegions, using empty object\");\n        }\n\n        // Add sun region\n        this.planetRegions[\"Sun\"] = {\n            center: sun.getPosition(),\n            radius: sun.getRadius()\n        };\n\n        // Add asteroid belt region\n        const asteroidBeltRegion = asteroidBelt.getRegionInfo();\n        this.planetRegions[\"Asteroid Belt\"] = {\n            center: asteroidBeltRegion.center,\n            minRadius: asteroidBeltRegion.innerRadius,\n            maxRadius: asteroidBeltRegion.outerRadius\n        };\n\n        // Add stargate region\n        const stargateRegion = stargate.getRegionInfo();\n        this.planetRegions[\"Stargate\"] = {\n            center: stargateRegion.center,\n            radius: stargateRegion.radius\n        };\n\n        // Add space anomalies region\n        const anomaliesRegion = spaceAnomalies.getRegionInfo();\n        this.planetRegions[\"Space Anomalies\"] = {\n            center: anomaliesRegion.center,\n            minRadius: anomaliesRegion.innerRadius,\n            maxRadius: anomaliesRegion.outerRadius\n        };\n    }\n\n    // Get the player's current location based on position\n    getPlayerLocation(\n        playerPosition: THREE.Vector3 | null,\n        spaceAnomalies: SpaceAnomaliesLike | null,\n        asteroids: AsteroidLike[] | null,\n        componentsLoaded: boolean\n    ): string {\n        if (!playerPosition) {\n            return \"Unknown Location\";\n        }\n\n        // Check if near stargate\n        const stargateRegion = this.planetRegions[\"Stargate\"];\n        const stargateCenter = stargateRegion?.center ?? stargateRegion?.position;\n        if (stargateRegion && stargateCenter) {\n            const distanceToStargate = playerPosition.distanceTo(stargateCenter);\n            if (stargateRegion.radius && distanceToStargate <= stargateRegion.radius) {\n                return \"Stargate\";\n            }\n        }\n\n        // Check if near an anomaly - only if spaceAnomalies is loaded\n        if (componentsLoaded && spaceAnomalies && typeof spaceAnomalies.findClosestAnomaly === 'function') {\n            const closestAnomaly = spaceAnomalies.findClosestAnomaly(playerPosition, 2000);\n            if (closestAnomaly) {\n                const distance = playerPosition.distanceTo(closestAnomaly.position);\n                if (distance < 800) {\n                    let anomalyType = '';\n                    switch (closestAnomaly.type) {\n                        case 'vortex':\n                            anomalyType = 'Vortex';\n                            break;\n                        case 'crystalCluster':\n                            anomalyType = 'Crystal Cluster';\n                            break;\n                        case 'nebulaNexus':\n                            anomalyType = 'Nebula Nexus';\n                            break;\n                        case 'quantumFlux':\n                            anomalyType = 'Quantum Flux';\n                            break;\n                        case 'darkMatter':\n                            anomalyType = 'Dark Matter';\n                            break;\n                    }\n\n                    // Indicate if orb is still available\n                    const orbStatus = closestAnomaly.orbCollected ? 'Depleted' : 'Active';\n                    return `${anomalyType} Anomaly (${orbStatus})`;\n                }\n            }\n        }\n\n        // Check planets\n        for (const [name, region] of Object.entries(this.planetRegions)) {\n            if (name === \"Asteroid Belt\" && componentsLoaded && asteroids) {\n                // Special case for asteroid belt - only if loaded\n                const regionCenter = region.center ?? region.position;\n                if (!regionCenter) continue;\n                const distance = playerPosition.distanceTo(regionCenter);\n                if (region.minRadius && region.maxRadius &&\n                    distance >= region.minRadius &&\n                    distance <= region.maxRadius) {\n                    // Count nearby asteroids (useful for mining)\n                    const nearbyAsteroids = asteroids.filter(asteroid => {\n                        return playerPosition.distanceTo(asteroid.mesh.position) < 500;\n                    });\n\n                    if (nearbyAsteroids.length > 0) {\n                        return `Asteroid Field (${nearbyAsteroids.length} nearby)`;\n                    }\n                    return \"Asteroid Belt\";\n                }\n            } else if (name === \"Space Anomalies\" && componentsLoaded) {\n                // Special case for space anomalies region - only if loaded\n                const regionCenter = region.center ?? region.position;\n                if (!regionCenter) continue;\n                const distance = playerPosition.distanceTo(regionCenter);\n                if (region.minRadius && region.maxRadius &&\n                    distance >= region.minRadius &&\n                    distance <= region.maxRadius) {\n                    return \"Space Anomaly Field\";\n                }\n            } else if (name !== \"Sun\" && name !== \"Stargate\" && (region.center || region.position) && region.radius) {\n                const regionCenter = region.center ?? region.position;\n                if (!regionCenter) continue;\n                const distance = playerPosition.distanceTo(regionCenter);\n                if (distance <= region.radius) {\n                    return `Near ${name}`;\n                }\n            }\n        }\n\n        // Check sun\n        const sunRegion = this.planetRegions[\"Sun\"];\n        const sunCenter = sunRegion?.center ?? sunRegion?.position;\n        if (sunRegion && sunCenter) {\n            const distanceToSun = playerPosition.distanceTo(sunCenter);\n            if (sunRegion.radius && distanceToSun <= sunRegion.radius) {\n                return \"Near Sun\";\n            }\n        }\n\n        // Deep space\n        return \"Deep Space\";\n    }\n\n    getPlanetRegions(): Record<string, RegionInfo> {\n        return this.planetRegions;\n    }\n}\n","// systemTransitionManager.ts - Handles system transitions and travel logic\n\ninterface ResourceMultipliers {\n    iron: number;\n    gold: number;\n    platinum: number;\n}\n\ninterface SkyboxParams {\n    starDensity: number;\n    nebulaDensity: number;\n    color: number;\n    texturePath?: string;\n    brightness?: number;\n    isSolarSystem?: boolean;\n    resetTime?: boolean;\n}\n\ninterface StarSystemData {\n    name: string;\n    description: string;\n    classification: string;\n    starClass: string;\n    starColor: number;\n    skyboxParams: SkyboxParams;\n    resourceMultipliers: ResourceMultipliers;\n    asteroidDensity?: number;\n    lightIntensityMultiplier?: number;\n}\n\ninterface StarSystemGeneratorLike {\n    getCurrentSystemResources: () => ResourceMultipliers;\n    travelToSystem: (systemId: string) => boolean;\n    getAllSystems: () => Record<string, StarSystemData>;\n}\n\ninterface AsteroidBeltLike {\n    setResourceMultipliers: (resources: ResourceMultipliers) => void;\n    dispose?: () => void;\n    createAsteroidBelt?: () => void;\n    updateDensity?: (density?: number) => void;\n}\n\ninterface SystemTransitionLike {\n    startTransition: (onComplete?: () => void) => void;\n}\n\ninterface SkyboxLike {\n    updateForSystem?: (params: SkyboxParams) => void;\n}\n\ninterface SunLike {\n    updateSunType?: (starClass: string, lightIntensityMultiplier?: number) => void;\n    updateColor?: (color: number) => void;\n    sunLight?: { _intensityMultiplier?: number };\n}\n\ninterface PlanetsLike {\n    updateForSystem?: (systemId: string) => void;\n    getPlanetRegions?: () => Record<string, unknown>;\n}\n\ninterface SpaceAnomaliesLike {\n    updateForSystem?: (systemData: StarSystemData) => void;\n}\n\ninterface RegionManagerLike {\n    planetRegions: Record<string, unknown>;\n}\n\ninterface GameGlobal {\n    spaceship?: { isDocked?: boolean };\n    controls?: { dockingSystem?: { dockWithStargate?: () => void } };\n}\n\nexport class SystemTransitionManager {\n    currentSystemId: string;\n\n    constructor() {\n        this.currentSystemId = 'Solar System'; // Default starting system\n    }\n\n    // Set up handlers for star system transitions\n    setupSystemTransitionHandlers(starSystemGenerator: StarSystemGeneratorLike, asteroidBelt: AsteroidBeltLike): void {\n        // Apply resource multipliers from current system to asteroid belt\n        if (starSystemGenerator && asteroidBelt) {\n            const resources = starSystemGenerator.getCurrentSystemResources();\n            asteroidBelt.setResourceMultipliers(resources);\n        }\n    }\n\n    // Travel to a new star system\n    travelToSystem(\n        systemId: string,\n        starSystemGenerator: StarSystemGeneratorLike,\n        systemTransition: SystemTransitionLike,\n        updateEnvironmentCallback: (systemId: string) => void\n    ): boolean {\n        if (!starSystemGenerator || !systemTransition) return false;\n\n        // Check if the system exists and is connected to the current one\n        if (!starSystemGenerator.travelToSystem(systemId)) {\n            console.error(`Cannot travel to system ${systemId}`);\n            return false;\n        }\n\n        console.log(`Starting transition to system: ${systemId}`);\n\n        // Start the transition effect\n        systemTransition.startTransition(() => {\n            // This callback is called when transition is complete\n            console.log(`Transition complete, updating environment for: ${systemId}`);\n\n            // Update the environment based on the new system\n            updateEnvironmentCallback(systemId);\n\n            // Display welcome notification\n            this.showSystemWelcomeNotification(systemId, starSystemGenerator);\n\n            // If player is docked, make sure the stargate interface is correctly displayed\n            const game = (window as any).game as GameGlobal | undefined;\n            if (game?.spaceship && game.spaceship.isDocked) {\n                console.log(\"Player is docked after arriving in new system, showing interface\");\n\n                // Handle docking system to enforce proper dock state\n                if (game.controls && game.controls.dockingSystem) {\n                    setTimeout(() => {\n                        // Trigger the docking system's docking method directly\n                        game.controls?.dockingSystem?.dockWithStargate && game.controls.dockingSystem.dockWithStargate();\n                    }, 500); // Small delay to ensure everything is ready\n                }\n            }\n        });\n\n        return true;\n    }\n\n    // Update environment visuals and properties for the new system\n    updateEnvironmentForSystem(\n        systemId: string,\n        starSystemGenerator: StarSystemGeneratorLike,\n        skybox: SkyboxLike,\n        sun: SunLike,\n        planets: PlanetsLike,\n        asteroidBelt: AsteroidBeltLike,\n        spaceAnomalies: SpaceAnomaliesLike,\n        regionManager: RegionManagerLike\n    ): void {\n        const systemData = starSystemGenerator.getAllSystems()[systemId];\n        if (!systemData) {\n            console.error(`No system data found for ${systemId}`);\n            return;\n        }\n\n        console.log(`Updating environment for system: ${systemId}`, systemData);\n\n        // Update current system ID\n        this.currentSystemId = systemId;\n\n        // Update skybox based on system properties\n        if (skybox && skybox.updateForSystem) {\n            // Special case for Solar System - always enforce white skybox\n            if (systemId === 'Solar System') {\n                const solarSystemParams: SkyboxParams = {\n                    starDensity: 1.0,\n                    nebulaDensity: 0.5,\n                    color: 0xFFFFFF,  // Ensure white color for Solar System\n                    isSolarSystem: true,  // Flag this as Solar System\n                    resetTime: true  // Reset the time for consistent appearance\n                };\n                console.log(`Updating skybox for Solar System with enforced white color`);\n                skybox.updateForSystem(solarSystemParams);\n            } else {\n                console.log(`Updating skybox for ${systemId} with params:`, systemData.skyboxParams);\n                skybox.updateForSystem(systemData.skyboxParams);\n            }\n        } else {\n            console.warn(\"Skybox or updateForSystem method not available\");\n        }\n\n        // Update star (sun) color and properties\n        if (sun) {\n            // First check if it's a custom system with an intensity multiplier\n            const lightIntensityMultiplier = systemData.lightIntensityMultiplier || 1.0;\n\n            // Check which update method to use\n            if (sun.updateSunType && systemData.starClass) {\n                console.log(`Updating sun type for ${systemId} to ${systemData.starClass} with intensity multiplier: ${lightIntensityMultiplier}`);\n                sun.updateSunType(systemData.starClass, lightIntensityMultiplier);\n            } else if (sun.updateColor) {\n                console.log(`Updating sun color for ${systemId} to:`, systemData.starColor.toString(16));\n                sun.updateColor(systemData.starColor);\n\n                // Store the multiplier for use in the update method\n                if (sun.sunLight) {\n                    sun.sunLight._intensityMultiplier = lightIntensityMultiplier;\n                }\n            } else {\n                console.warn(\"Sun update methods not available\");\n            }\n        } else {\n            console.warn(\"Sun not available\");\n        }\n\n        // Update planets for this system\n        if (planets && planets.updateForSystem) {\n            console.log(`Updating planets for ${systemId}`);\n            planets.updateForSystem(systemId);\n\n            // Safely update planet regions if the method exists\n            if (typeof planets.getPlanetRegions === 'function') {\n                try {\n                    regionManager.planetRegions = planets.getPlanetRegions();\n                } catch (error) {\n                    console.warn(`Error getting planet regions for system ${systemId}:`, error);\n                }\n            } else {\n                console.warn(`planets.getPlanetRegions is not available for system ${systemId}`);\n            }\n        } else {\n            console.warn(\"Planets or updateForSystem method not available\");\n        }\n\n        // Update asteroid belt based on system properties\n        if (asteroidBelt) {\n            // Dispose of old asteroids before creating new ones\n            if (asteroidBelt.dispose) {\n                console.log(`Disposing old asteroids before updating for ${systemId}`);\n                asteroidBelt.dispose();\n            }\n\n            // Recreate asteroid belt for new system\n            if (asteroidBelt.createAsteroidBelt) {\n                console.log(`Creating new asteroids for ${systemId}`);\n                asteroidBelt.createAsteroidBelt();\n            }\n\n            // Apply resource multipliers from system\n            if (asteroidBelt.setResourceMultipliers) {\n                console.log(`Updating asteroid resources for ${systemId}:`, systemData.resourceMultipliers);\n                asteroidBelt.setResourceMultipliers(systemData.resourceMultipliers);\n            }\n\n            // Update asteroid density if the method exists\n            if (asteroidBelt.updateDensity) {\n                console.log(`Updating asteroid density for ${systemId}:`, systemData.asteroidDensity);\n                asteroidBelt.updateDensity(systemData.asteroidDensity);\n            }\n        } else {\n            console.warn(\"AsteroidBelt not available\");\n        }\n\n        // Update space anomalies for this system\n        if (spaceAnomalies && spaceAnomalies.updateForSystem) {\n            console.log(`Updating space anomalies for ${systemId}`);\n            spaceAnomalies.updateForSystem(systemData);\n        } else {\n            console.warn(\"SpaceAnomalies or updateForSystem method not available\");\n        }\n\n        console.log(`Environment updated for ${systemId}`);\n    }\n\n    // Show welcome notification when arriving at a new system\n    showSystemWelcomeNotification(systemId: string, starSystemGenerator: StarSystemGeneratorLike): void {\n        const system = starSystemGenerator.getAllSystems()[systemId];\n        if (!system) return;\n\n        // Create welcome notification\n        const notification = document.createElement('div');\n        notification.style.position = 'fixed';\n        notification.style.top = '25%';\n        notification.style.left = '50%';\n        notification.style.transform = 'translate(-50%, -50%)';\n        notification.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';\n        notification.style.color = '#fff';\n        notification.style.padding = '20px 40px';\n        notification.style.borderRadius = '10px';\n        notification.style.border = `2px solid #${system.starColor.toString(16).padStart(6, '0')}`;\n        notification.style.boxShadow = `0 0 30px #${system.starColor.toString(16).padStart(6, '0')}`;\n        notification.style.fontFamily = 'Courier New, monospace';\n        notification.style.fontSize = '18px';\n        notification.style.zIndex = '9999';\n        notification.style.textAlign = 'center';\n\n        // Special welcome for Earth/Solar System\n        if (systemId === 'Solar System') {\n            notification.innerHTML = `\n                <h2 style=\"color: #30cfd0; margin-top: 0;\">Welcome to the Solar System</h2>\n                <p>Your home system, with Earth as your starting location.</p>\n                <p style=\"font-size: 14px; margin-bottom: 0; color: #aaa;\">Safe travels, commander.</p>\n            `;\n        } else {\n            notification.innerHTML = `\n                <h2 style=\"color: #${system.starColor.toString(16).padStart(6, '0')}; margin-top: 0;\">Welcome to ${system.name}</h2>\n                <p>${system.description}</p>\n                <p style=\"font-size: 14px; margin-bottom: 0; color: #aaa;\">Classification: ${system.classification} - Star Class: ${system.starClass}</p>\n            `;\n        }\n\n        // Add to DOM\n        document.body.appendChild(notification);\n\n        // Remove after a few seconds\n        setTimeout(() => {\n            notification.style.opacity = '0';\n            notification.style.transition = 'opacity 1s';\n\n            setTimeout(() => {\n                notification.remove();\n            }, 1000);\n        }, 5000);\n    }\n\n    getCurrentSystemId(): string {\n        return this.currentSystemId;\n    }\n}\n","// environment.ts - Main environment class that integrates all environment components\n\nimport * as THREE from 'three';\nimport { SceneInitializer } from './environment/core/sceneInitializer.js';\nimport { RegionManager } from './environment/core/regionManager.js';\nimport { SystemTransitionManager } from './environment/core/systemTransitionManager.js';\n\ninterface EnvironmentComponents {\n    skybox?: any;\n    sun?: any;\n    starSystemGenerator?: any;\n    planets?: any;\n    stargate?: any;\n    asteroidBelt?: any;\n    spaceAnomalies?: any;\n    systemTransition?: any;\n    customSystemCreator?: any;\n}\n\nexport class Environment {\n    scene: THREE.Scene;\n    componentsLoaded: boolean;\n    sceneInitializer: any;\n    regionManager: any;\n    transitionManager: any;\n    \n    // Components assigned from sceneInitializer\n    skybox: any;\n    sun: any;\n    starSystemGenerator: any;\n    planets: any;\n    stargate: any;\n    asteroidBelt: any;\n    spaceAnomalies: any;\n    systemTransition: any;\n    customSystemCreator: any;\n    \n    asteroids: any[];\n    currentSystemId: string;\n    spaceship: any;\n    vibeVersePortals: any;\n\n    constructor(scene: THREE.Scene) {\n        this.scene = scene;\n        this.componentsLoaded = false;\n        \n        // Initialize core managers\n        this.sceneInitializer = new SceneInitializer(scene);\n        this.regionManager = new RegionManager();\n        this.transitionManager = new SystemTransitionManager();\n        \n        // Initialize essential components\n        const essentialComponents = this.sceneInitializer.initializeEssentialComponents() as EnvironmentComponents;\n        Object.assign(this, essentialComponents);\n        \n        // Store references for easier access\n        this.asteroids = [];\n        this.currentSystemId = this.transitionManager.getCurrentSystemId();\n        \n        // Setup initial regions for location tracking (minimal setup)\n        this.regionManager.setupInitialRegions(this.sun, this.stargate, this.planets);\n        \n        // Schedule loading of remaining components after a short delay to not block startup\n        setTimeout(async () => {\n            const remainingComponents = await this.sceneInitializer.loadRemainingComponents() as EnvironmentComponents;\n            Object.assign(this, remainingComponents);\n            \n            // Connect asteroids from asteroidBelt to environment\n            if (this.asteroidBelt) {\n                this.asteroids = this.asteroidBelt.getAsteroids();\n            }\n            \n            this.componentsLoaded = true;\n        }, 500);\n    }\n    \n    \n    // Called after spaceship is created - we need this to initialize portals\n    async setSpaceship(spaceship: any): Promise<void> {\n        this.spaceship = spaceship;\n        this.vibeVersePortals = await this.sceneInitializer.initializePortals(spaceship);\n    }\n    \n    // Travel to a new star system\n    travelToSystem(systemId: string): any {\n        return this.transitionManager.travelToSystem(\n            systemId, \n            this.starSystemGenerator, \n            this.systemTransition, \n            (id: string) => this.updateEnvironmentForSystem(id)\n        );\n    }\n    \n    // Update environment visuals and properties for the new system\n    updateEnvironmentForSystem(systemId: string): void {\n        this.transitionManager.updateEnvironmentForSystem(\n            systemId, \n            this.starSystemGenerator, \n            this.skybox, \n            this.sun, \n            this.planets, \n            this.asteroidBelt, \n            this.spaceAnomalies, \n            this.regionManager\n        );\n        this.currentSystemId = this.transitionManager.getCurrentSystemId();\n    }\n    \n    // Get the player's current location based on position\n    getPlayerLocation(playerPosition: THREE.Vector3): any {\n        return this.regionManager.getPlayerLocation(\n            playerPosition, \n            this.spaceAnomalies, \n            this.asteroids, \n            this.componentsLoaded\n        );\n    }\n\n    // Get planet regions for external access\n    getPlanetRegions(): any {\n        return this.regionManager.getPlanetRegions();\n    }\n    \n    // Find the closest asteroid to a position\n    findClosestAsteroid(position: THREE.Vector3, maxDistance: number): any {\n        if (this.componentsLoaded && this.asteroidBelt && typeof this.asteroidBelt.findClosestAsteroid === 'function') {\n            return this.asteroidBelt.findClosestAsteroid(position, maxDistance);\n        }\n        return null;\n    }\n    \n    // Find the closest space anomaly\n    findClosestAnomaly(position: THREE.Vector3, maxDistance: number): any {\n        if (this.componentsLoaded && this.spaceAnomalies && typeof this.spaceAnomalies.findClosestAnomaly === 'function') {\n            return this.spaceAnomalies.findClosestAnomaly(position, maxDistance);\n        }\n        return null;\n    }\n    \n    // Check if position collides with any anomaly\n    checkAnomalyCollision(position: THREE.Vector3): any {\n        if (!this.componentsLoaded || !this.spaceAnomalies) return null;\n        \n        const closestAnomaly = this.spaceAnomalies.findClosestAnomaly(position, 8000);\n        if (closestAnomaly && this.spaceAnomalies.checkCollision(position, closestAnomaly)) {\n            return closestAnomaly;\n        }\n        \n        return null;\n    }\n    \n    // Collect energy orb from anomaly\n    collectAnomalyOrb(anomaly: any): any {\n        if (this.componentsLoaded && this.spaceAnomalies && typeof this.spaceAnomalies.collectOrb === 'function') {\n            return this.spaceAnomalies.collectOrb(anomaly);\n        }\n    }\n    \n    update(deltaTime: number = 0.016, camera: THREE.Camera): void {\n        // Update skybox if it has an update method\n        if (this.skybox && typeof this.skybox.update === 'function') {\n            this.skybox.update(deltaTime);\n        }\n        \n        // Update sun if it has an update method\n        if (this.sun && typeof this.sun.update === 'function') {\n            this.sun.update(deltaTime);\n        }\n        \n        // Update planets if they have an update method\n        if (this.planets && typeof this.planets.update === 'function') {\n            this.planets.update(deltaTime);\n        }\n        \n        // Update system transition effects if active - this needs to run regardless of componentsLoaded\n        if (this.systemTransition && typeof this.systemTransition.update === 'function') {\n            this.systemTransition.update(deltaTime);\n        }\n        \n        // Only update non-essential components if they're loaded\n        if (this.componentsLoaded) {\n            // Update asteroids\n            if (this.asteroidBelt && typeof this.asteroidBelt.update === 'function') {\n                this.asteroidBelt.update(deltaTime);\n            }\n            \n            // Update stargate\n            if (this.stargate && typeof this.stargate.update === 'function') {\n                this.stargate.update(deltaTime);\n            }\n            \n            // Update space anomalies\n            if (this.spaceAnomalies && typeof this.spaceAnomalies.update === 'function') {\n                this.spaceAnomalies.update(deltaTime, camera);\n            }\n            \n            // Update vibe verse portals\n            if (this.vibeVersePortals && typeof this.vibeVersePortals.update === 'function') {\n                this.vibeVersePortals.update(deltaTime);\n            }\n        }\n    }\n    \n    dispose(): void {\n        // Delegate disposal to scene initializer\n        if (this.sceneInitializer) {\n            this.sceneInitializer.dispose();\n        }\n    }\n}\n"],"file":"assets/environment-C9XE_r0p.js"}